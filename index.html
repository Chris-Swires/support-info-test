<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atlassian Cloud Migration Project</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Use Inter font family */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom styles for the timeline grid */
        .timeline-grid {
            display: grid;
            grid-template-columns: 180px 1fr; /* Wider labels */
            grid-auto-flow: dense;
        }
        .timeline-header, .timeline-body {
            display: grid;
            grid-column: 2 / -1;
        }
        .task-bar {
            grid-column-start: var(--start-day);
            grid-column-end: span var(--duration);
            grid-row: var(--row);
            align-self: center;
        }
        /* Simple animation for modal */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slideIn {
            from { transform: translateY(-30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .modal-fade-in {
            animation: fadeIn 0.3s ease-out;
        }
        .modal-slide-in {
            animation: slideIn 0.3s ease-out;
        }
        /* Styles for active toggle button */
        .toggle-btn-active {
            background-color: #3b82f6; /* bg-blue-500 */
            color: white;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <!-- Header Section -->
    <header class="bg-blue-800 text-white p-8 text-center shadow-lg">
        <h1 class="text-3xl md:text-4xl font-bold mb-2">Atlassian Cloud Migration Project</h1>
        <p class="text-lg text-blue-200">An interactive overview of the project timeline, dependencies, and action items.</p>
    </header>

    <!-- Main Content -->
    <main class="max-w-screen-2xl mx-auto p-4 md:p-8">

        <!-- Key Info Cards Section -->
        <section class="mb-12">
            <h2 class="text-2xl font-bold mb-4 pb-2 border-b-2 border-gray-200">Key Milestones</h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="bg-white p-5 rounded-lg shadow-md border-l-4 border-red-500">
                    <h3 class="font-bold text-lg mb-1">Account Freeze</h3>
                    <p class="text-gray-600">No new accounts or permissions from <strong class="text-gray-900">4:00 PM, Fri 29 Aug</strong>.</p>
                </div>
                <div class="bg-white p-5 rounded-lg shadow-md border-l-4 border-yellow-500">
                    <h3 class="font-bold text-lg mb-1">Content Freeze</h3>
                    <p class="text-gray-600">Confluence/Jira read-only from <strong class="text-gray-900">Wed 3 Sep</strong> (TBC).</p>
                </div>
                <div class="bg-white p-5 rounded-lg shadow-md border-l-4 border-blue-500">
                    <h3 class="font-bold text-lg mb-1">Migration Weekend</h3>
                    <p class="text-gray-600">Core migration on <strong class="text-gray-900">Sat 6 Sep - Sun 7 Sep</strong>.</p>
                </div>
                <div class="bg-white p-5 rounded-lg shadow-md border-l-4 border-green-500">
                    <h3 class="font-bold text-lg mb-1">Go-Live</h3>
                    <p class="text-gray-600">New Cloud environment & IMS live on <strong class="text-gray-900">Mon 8 Sep</strong>.</p>
                </div>
            </div>
        </section>

        <!-- Interactive Timeline Section -->
        <section class="bg-white p-6 rounded-lg shadow-lg mb-12">
            <div class="flex justify-between items-center mb-6 pb-2 border-b-2 border-gray-200">
                <h2 class="text-2xl font-bold">Interactive Project Plan</h2>
                <div class="flex rounded-lg p-1 bg-gray-200">
                    <button id="timeline-view-btn" class="toggle-btn-active px-4 py-1.5 text-sm font-semibold rounded-md transition-colors">Timeline View</button>
                    <button id="board-view-btn" class="px-4 py-1.5 text-sm font-semibold rounded-md transition-colors">Board View</button>
                </div>
            </div>
            
            <div id="timeline-container" class="timeline-grid overflow-x-auto">
                <!-- Timeline will be dynamically generated here -->
            </div>
            
            <div id="kanban-container" class="hidden">
                <!-- Kanban board will be dynamically generated here -->
            </div>
        </section>

        <!-- Details Accordion Section -->
        <section>
            <h2 class="text-2xl font-bold mb-4 pb-2 border-b-2 border-gray-200">Project Details & Actions</h2>
            <div id="accordion-container" class="space-y-4">
                <div class="bg-white rounded-lg shadow-md overflow-hidden">
                    <button class="accordion-button w-full p-5 text-left font-semibold text-lg flex justify-between items-center hover:bg-gray-50 transition">
                        <span>Confluence Migration Details</span>
                        <svg class="w-6 h-6 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="accordion-content max-h-0 overflow-hidden transition-all duration-500 ease-in-out">
                        <div class="p-5 border-t border-gray-200 text-gray-700">
                            <ul class="list-disc pl-5 space-y-2">
                                <li><strong>Target Migration Date:</strong> 3rd September (subject to change).</li>
                                <li><strong>Naming:</strong> A new name for the Confluence instance is required.</li>
                                <li><strong>Gliffy Diagrams:</strong> Terance & Chris Morris are exploring automated conversion. Manual options are a fallback.</li>
                                <li><strong>Discussions:</strong> Existing discussions will be made read-only. New/ongoing discussions must move to the Forums.</li>
                                <li><strong>Briefing Notes:</strong> Process needs to be clearly explained.</li>
                                <li><strong>Testing:</strong> A timeline is needed for when internal users can test the new environment.</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-md overflow-hidden">
                    <button class="accordion-button w-full p-5 text-left font-semibold text-lg flex justify-between items-center hover:bg-gray-50 transition">
                        <span>JIRA Migration Details</span>
                        <svg class="w-6 h-6 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="accordion-content max-h-0 overflow-hidden transition-all duration-500 ease-in-out">
                        <div class="p-5 border-t border-gray-200 text-gray-700">
                           <ul class="list-disc pl-5 space-y-2">
                                <li><strong>Target Migration Date:</strong> 3rd September (subject to change).</li>
                                <li><strong>Naming:</strong> A new name is suggested for the JIRA instance.</li>
                                <li><strong>Workflows:</strong> Cross-tech team agreement on support workflows is necessary.</li>
                                <li><strong>Testing:</strong> Internal users, especially from content teams for trackers, will be needed for testing.</li>
                           </ul>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-md overflow-hidden">
                    <button class="accordion-button w-full p-5 text-left font-semibold text-lg flex justify-between items-center hover:bg-gray-50 transition">
                        <span>User Accounts & Login (Keycloak)</span>
                        <svg class="w-6 h-6 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="accordion-content max-h-0 overflow-hidden transition-all duration-500 ease-in-out">
                        <div class="p-5 border-t border-gray-200 text-gray-700">
                            <ul class="list-disc pl-5 space-y-2">
                                <li><strong>Password Reset:</strong> An automated email will be sent to users with instructions on how to set their new password.</li>
                                <li><strong>Landing Page:</strong> A new "SNOMED International Account" landing page should be available in time for the migration.</li>
                                <li><strong>Dual Accounts:</strong> For a short period (max 1 month), tooling users may have two accounts: one for Atlassian (Jira/Confluence) and one for other SNOMED tools.</li>
                                <li><strong>Forums:</strong> Users will need to create an account on the Forums. This may later be integrated with Keycloak OIDC to remove the need for a separate signup. User groups on Forums are manually maintained for now.</li>
                            </ul>
                        </div>
                    </div>
                </div>
                 <div class="bg-white rounded-lg shadow-md overflow-hidden">
                    <button class="accordion-button w-full p-5 text-left font-semibold text-lg flex justify-between items-center hover:bg-gray-50 transition">
                        <span>Communications Plan</span>
                        <svg class="w-6 h-6 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="accordion-content max-h-0 overflow-hidden transition-all duration-500 ease-in-out">
                        <div class="p-5 border-t border-gray-200 text-gray-700">
                            <ul class="list-disc pl-5 space-y-2">
                                <li><strong>Aug 6:</strong> Agenda item at SMT meeting.</li>
                                <li><strong>Aug 7:</strong> Internal Webinar.</li>
                                <li><strong>w/c Aug 4:</strong> First external comms ("exciting changes incoming...").</li>
                                <li><strong>Mid-August:</strong> Second, more detailed comms to be sent.</li>
                                <li><strong>Aug 27:</strong> Presentation at MF meeting.</li>
                                <li><strong>Target Audiences:</strong> Separate messaging for MB/GA, MF, and AGs/UGs/PGs.</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Modal -->
    <div id="taskModal" class="fixed inset-0 bg-black bg-opacity-60 z-50 flex items-center justify-center p-4 hidden modal-fade-in">
      <div class="bg-white rounded-xl shadow-2xl w-full max-w-2xl mx-auto p-8 modal-slide-in">
        <div class="flex justify-between items-center mb-4">
            <h2 id="modal-title" class="text-2xl font-bold text-gray-800">Task Details</h2>
            <button id="close-modal-button" class="text-gray-500 hover:text-gray-800 transition-colors text-3xl leading-none">&times;</button>
        </div>
        <div id="modal-body" class="text-gray-700">
          <!-- Modal content will be injected here -->
        </div>
      </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- DATA SOURCE ---
            const timelineData = `
                2025-07-30 / 2025-09-15: Full Migration #project
                2025-07-30 / 2025-09-05: Document migration to GitBook #documents
                2025-08-01 / 2025-08-27: New RMP #software
                2025-07-30 / 2025-08-04: Trial migration to Atlassian Cloud #atlassian
                2025-08-05 / 2025-09-04: Fixing Confluence source #atlassian
                2025-08-05 / 2025-08-12: Agree on support JIRA workflow with JSM #atlassian
                2025-08-01 / 2025-09-01: IMS conversion to Keycloak #software
                2025-07-30 / 2025-08-05: Set up dev, uat, prod keycloak boxes #devops
                2025-08-01 / 2025-08-05: Groups setup #devops
                2025-08-01: First comms messages #comms
                2025-08-06: SMT walkthrough #comms
                2025-08-13: Screenshots for comms message #comms
                2025-08-14: Second comms messages #comms
                2025-08-28 / 2025-08-29: EPS guide migration #devops
                2025-08-27: Q3 Software Release #software
                2025-08-27: MF Meeting demo #comms
                2025-08-05 / 2025-08-28: Prod-workflow migration #software
                2025-08-29: Prod-workflow switch off #software
                2025-09-01 / 2025-09-03: Account migration to keycloak #devops
                2025-09-06 / 2025-09-07: Migration to Atlassian cloud #devops
                2025-09-07: Go Live comms message #comms
                2025-09-08: Deploy IMS #software
                2025-09-08: Go Live #project
                2025-09-05 / 2025-09-15: Current RMP Closed #software
                2025-09-08 / 2025-09-11: RMP data migration #software
                2025-09-15: New RMP Go Live #software
            `;

            // --- PARSING AND SETUP ---
            const tasks = timelineData.trim().split('\n').map((line, index) => {
                const trimmedLine = line.trim();
                if (!trimmedLine) return null;
                const [datePart, rest] = trimmedLine.split(': ');
                const [name, category] = rest.split(' #');
                const dates = datePart.split(' / ');
                const startDate = new Date(dates[0] + 'T00:00:00Z');
                const endDate = dates.length > 1 ? new Date(dates[1] + 'T00:00:00Z') : startDate;
                return { id: index, name, category: category || 'general', startDate, endDate };
            }).filter(Boolean);

            const colorMap = {
                project: 'blue-600',
                software: 'orange-500',
                comms: 'green-500',
                devops: 'red-600',
                documents: 'purple-600',
                atlassian: 'yellow-500',
                general: 'gray-500'
            };
            const borderMap = {
                project: 'border-blue-600',
                software: 'border-orange-500',
                comms: 'border-green-500',
                devops: 'border-red-600',
                documents: 'border-purple-600',
                atlassian: 'border-yellow-500',
                general: 'border-gray-500'
            };

            const timelineStartDate = new Date('2025-07-30T00:00:00Z');
            const timelineEndDate = new Date('2025-09-15T00:00:00Z');

            // --- DYNAMIC TIMELINE GENERATION ---
            const timelineContainer = document.getElementById('timeline-container');
            
            function generateTimeline() {
                timelineContainer.innerHTML = ''; // Clear previous content
                const days = [];
                let currentDate = new Date(timelineStartDate);
                while (currentDate <= timelineEndDate) {
                    days.push(new Date(currentDate));
                    currentDate.setUTCDate(currentDate.getUTCDate() + 1);
                }

                const headerContainer = document.createElement('div');
                headerContainer.className = 'timeline-header';
                headerContainer.style.gridTemplateColumns = `repeat(${days.length}, minmax(45px, 1fr))`;
                
                let monthHeaders = {};
                days.forEach((day, index) => {
                    const month = day.toLocaleString('default', { month: 'short', year: '2-digit', timeZone: 'UTC' });
                    if (!monthHeaders[month]) {
                        monthHeaders[month] = { start: index + 1, count: 0 };
                    }
                    monthHeaders[month].count++;
                    
                    const dateCell = document.createElement('div');
                    dateCell.className = 'text-center text-xs p-1 border-r';
                    const dayOfWeek = day.toLocaleDateString('en-US', { weekday: 'short', timeZone: 'UTC' });
                    if (['Sat', 'Sun'].includes(dayOfWeek)) dateCell.classList.add('bg-gray-100');
                    dateCell.innerHTML = `<div class="text-gray-500">${dayOfWeek}</div><div class="font-medium mt-1">${day.getUTCDate()}</div>`;
                    headerContainer.appendChild(dateCell);
                });

                const monthHeaderRow = document.createElement('div');
                monthHeaderRow.className = 'col-start-2 col-span-1 grid';
                monthHeaderRow.style.gridTemplateColumns = `repeat(${days.length}, minmax(45px, 1fr))`;
                Object.keys(monthHeaders).forEach(month => {
                    const monthCell = document.createElement('div');
                    monthCell.className = 'text-base font-bold text-center py-2 border-r';
                    monthCell.style.gridColumn = `${monthHeaders[month].start} / span ${monthHeaders[month].count}`;
                    monthCell.textContent = month.toUpperCase();
                    monthHeaderRow.appendChild(monthCell);
                });
                
                timelineContainer.appendChild(monthHeaderRow);
                timelineContainer.appendChild(headerContainer);

                const diffTime = (date2, date1) => Math.ceil(Math.abs(date2 - date1) / (1000 * 60 * 60 * 24));
                
                tasks.forEach((task, index) => {
                    const taskLabel = document.createElement('div');
                    taskLabel.className = 'text-sm font-medium text-right pr-4 py-3 border-b';
                    taskLabel.textContent = task.name;
                    taskLabel.style.gridRow = index + 3;

                    const taskRow = document.createElement('div');
                    taskRow.className = 'col-start-2 col-span-full py-2 border-b grid';
                    taskRow.style.gridTemplateColumns = `repeat(${days.length}, minmax(45px, 1fr))`;
                    taskRow.style.gridRow = index + 3;

                    const startDay = diffTime(task.startDate, timelineStartDate) + 1;
                    const duration = diffTime(task.endDate, task.startDate) + 1;

                    const taskBar = document.createElement('div');
                    taskBar.className = `task-bar text-white text-xs p-1 rounded-md shadow cursor-pointer hover:opacity-80 transition-opacity truncate bg-${colorMap[task.category]}`;
                    taskBar.style.setProperty('--start-day', startDay);
                    taskBar.style.setProperty('--duration', duration);
                    taskBar.textContent = task.name;
                    taskBar.dataset.taskId = task.id;

                    taskRow.appendChild(taskBar);
                    timelineContainer.appendChild(taskLabel);
                    timelineContainer.appendChild(taskRow);
                });
            }

            // --- DYNAMIC KANBAN BOARD GENERATION ---
            const kanbanContainer = document.getElementById('kanban-container');

            function generateKanbanBoard() {
                kanbanContainer.innerHTML = ''; // Clear previous content
                const categories = Object.keys(colorMap);
                const board = document.createElement('div');
                board.className = 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6';
                
                categories.forEach(category => {
                    const column = document.createElement('div');
                    column.className = 'bg-gray-100 rounded-lg p-4';
                    
                    const header = document.createElement('h3');
                    header.className = `text-lg font-bold mb-4 capitalize text-${colorMap[category]}`;
                    header.textContent = category;
                    column.appendChild(header);

                    const cardContainer = document.createElement('div');
                    cardContainer.className = 'space-y-4';
                    column.appendChild(cardContainer);
                    
                    board.appendChild(column);
                });

                kanbanContainer.appendChild(board);
                
                const dateOptions = { timeZone: 'UTC', day: 'numeric', month: 'short' };

                tasks.forEach(task => {
                    const column = board.querySelector(`h3.text-${colorMap[task.category]}`).parentElement.querySelector('.space-y-4');
                    const card = document.createElement('div');
                    card.className = `bg-white p-4 rounded-lg shadow border-l-4 ${borderMap[task.category]} cursor-pointer hover:shadow-md`;
                    card.dataset.taskId = task.id;
                    
                    const taskName = document.createElement('p');
                    taskName.className = 'font-semibold text-gray-800';
                    taskName.textContent = task.name;
                    
                    const taskDates = document.createElement('p');
                    taskDates.className = 'text-sm text-gray-500 mt-1';
                    const startDateStr = task.startDate.toLocaleDateString('en-GB', dateOptions);
                    const endDateStr = task.endDate.toLocaleDateString('en-GB', dateOptions);
                    taskDates.textContent = startDateStr === endDateStr ? startDateStr : `${startDateStr} - ${endDateStr}`;

                    card.appendChild(taskName);
                    card.appendChild(taskDates);
                    column.appendChild(card);
                });
            }

            // --- INITIALIZE VIEWS ---
            generateTimeline();
            generateKanbanBoard();

            // --- VIEW TOGGLE LOGIC ---
            const timelineBtn = document.getElementById('timeline-view-btn');
            const boardBtn = document.getElementById('board-view-btn');

            timelineBtn.addEventListener('click', () => {
                timelineContainer.classList.remove('hidden');
                kanbanContainer.classList.add('hidden');
                timelineBtn.classList.add('toggle-btn-active');
                boardBtn.classList.remove('toggle-btn-active');
            });

            boardBtn.addEventListener('click', () => {
                timelineContainer.classList.add('hidden');
                kanbanContainer.classList.remove('hidden');
                boardBtn.classList.add('toggle-btn-active');
                timelineBtn.classList.remove('toggle-btn-active');
            });

            // --- MODAL AND ACCORDION LOGIC ---
            const modal = document.getElementById('taskModal');
            const modalTitle = document.getElementById('modal-title');
            const modalBody = document.getElementById('modal-body');
            const closeModalButton = document.getElementById('close-modal-button');

            document.body.addEventListener('click', (event) => {
                const target = event.target.closest('.task-bar, .bg-white[data-task-id]');
                if (target) {
                    const taskId = target.dataset.taskId;
                    const task = tasks[taskId];
                    if (task) {
                        modalTitle.textContent = task.name;
                        const options = { timeZone: 'UTC', day: 'numeric', month: 'long', year: 'numeric' };
                        const startDateStr = task.startDate.toLocaleDateString('en-GB', options);
                        const endDateStr = task.endDate.toLocaleDateString('en-GB', options);
                        modalBody.innerHTML = `
                            <p class="mb-2"><strong>Category:</strong> <span class="capitalize">${task.category}</span></p>
                            <p><strong>Start Date:</strong> ${startDateStr}</p>
                            <p><strong>End Date:</strong> ${endDateStr}</p>
                        `;
                        modal.classList.remove('hidden');
                    }
                }
            });

            const closeModal = () => modal.classList.add('hidden');
            closeModalButton.addEventListener('click', closeModal);
            modal.addEventListener('click', (event) => {
                if (event.target === modal) closeModal();
            });

            document.querySelectorAll('.accordion-button').forEach(button => {
                button.addEventListener('click', () => {
                    const content = button.nextElementSibling;
                    const icon = button.querySelector('svg');
                    const isExpanded = content.style.maxHeight;

                    document.querySelectorAll('.accordion-content').forEach(c => c.style.maxHeight = null);
                    document.querySelectorAll('.accordion-button svg').forEach(i => i.style.transform = 'rotate(0deg)');

                    if (!isExpanded) {
                        content.style.maxHeight = content.scrollHeight + 'px';
                        icon.style.transform = 'rotate(180deg)';
                    }
                });
            });
        });
    </script>
</body>
</html>
