<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Managed Service - Release Orchestrator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --sn-primary: #009ed9;
            --sn-bg: #f5f7f9;
            --sn-header: #262626;
            --sn-sub-header: #e7f3fd;
            --sn-border: #e2e8f0;
            --sn-text: #1f2937;
            --sn-text-muted: #6b7280;
            --sn-card: #ffffff;

            /* Workflow Accents */
            --blue: #268bd2;
            --cyan: #2aa198;
            --green: #859900;
            --orange: #cb4b16;
            --red: #dc322f;
        }

        body {
            background-color: var(--sn-bg);
            color: var(--sn-text);
            font-family: 'Inter', sans-serif;
            overflow: hidden;
            height: 100vh;
        }

        .font-mono {
            font-family: 'Fira Code', monospace;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        .sidebar-item {
            transition: all 0.2s ease;
            border-left: 4px solid transparent;
        }

        .sidebar-item.active {
            background-color: var(--sn-sub-header);
            border-left: 4px solid var(--sn-primary);
            color: var(--sn-primary);
        }

        .btn-primary {
            background-color: var(--sn-primary);
            color: white;
            transition: all 0.2s;
        }

        .btn-primary:hover {
            filter: brightness(1.1);
            transform: translateY(-1px);
        }

        .card {
            background-color: var(--sn-card);
            border: 1px solid var(--sn-border);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            border-radius: 16px;
        }

        .terminal {
            background-color: #ffffff;
            border: 1px solid var(--sn-border);
            border-radius: 16px;
        }

        @keyframes pulse-primary {
            0% {
                box-shadow: 0 0 0 0 rgba(0, 158, 217, 0.4);
            }

            70% {
                box-shadow: 0 0 0 10px rgba(0, 158, 217, 0);
            }

            100% {
                box-shadow: 0 0 0 0 rgba(0, 158, 217, 0);
            }
        }

        .anim-pulse {
            animation: pulse-primary 2s infinite;
        }

        .step-transition {
            transition: opacity 0.4s ease, transform 0.4s ease;
        }

        .sub-header {
            background-color: var(--sn-sub-header);
            border-bottom: 1px solid #d0e7f9;
        }
    </style>
</head>

<body class="flex flex-col">

    <!-- SNOMED Global Header -->
    <header class="h-16 flex items-center justify-between px-6 bg-[#262626] text-white z-50">
        <div class="flex items-center gap-4">
            <div class="bg-[#009ed9] w-10 h-10 rounded-lg flex items-center justify-center font-bold italic text-xl">S
            </div>
            <div class="h-8 w-px bg-white/20"></div>
            <div class="text-base font-bold tracking-tight">Managed Service <span
                    class="text-[#009ed9]">Orchestrator</span></div>
        </div>

        <div class="flex items-center gap-4">
            <div class="bg-[#009ed9] w-10 h-10 rounded-full flex items-center justify-center text-sm font-black">CS
            </div>
            <button
                class="w-10 h-10 rounded-xl hover:bg-white/10 flex items-center justify-center transition-colors text-lg">
                <i class="fas fa-th"></i>
            </button>
            <button
                class="w-10 h-10 rounded-xl hover:bg-white/10 flex items-center justify-center transition-colors text-lg">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </header>

    <!-- Sub-header Breadcrumb -->
    <div class="h-12 sub-header flex items-center px-6 gap-4 text-[#009ed9] text-sm z-40">
        <div class="w-10 h-full flex items-center justify-center border-b-2 border-[#009ed9]">
            <i class="fas fa-home"></i>
        </div>
        <div class="h-5 w-px bg-[#009ed9]/20"></div>
        <div class="flex items-center gap-3 font-bold">
            <span>Home</span>
            <i class="fas fa-chevron-right text-[10px] opacity-40"></i>
            <span class="opacity-60">Release Management</span>
            <i class="fas fa-chevron-right text-[10px] opacity-40"></i>
            <span id="breadcrumb-status" class="text-gray-700">Preparation Phase</span>
        </div>
    </div>

    <div class="flex flex-1 overflow-hidden">
        <!-- Sidebar Navigation -->
        <nav class="w-80 bg-white border-r border-[#e2e8f0] flex flex-col overflow-y-auto pt-8">
            <div class="px-6 mb-8">
                <h2 class="text-xs text-[#94a3b8] font-black uppercase tracking-[0.2em] mb-6 px-2">Release Lifecycle
                </h2>

                <div class="space-y-2">
                    <div id="nav-prepare" class="sidebar-item active p-5 rounded-xl cursor-not-allowed group">
                        <div class="flex items-center gap-5">
                            <div
                                class="w-12 h-12 rounded-xl bg-[#009ed9]/10 text-[#009ed9] flex items-center justify-center">
                                <i class="fas fa-clipboard-list text-xl"></i>
                            </div>
                            <div class="flex flex-col">
                                <span class="text-sm font-black uppercase tracking-tight">1. Preparation</span>
                                <span class="text-xs font-bold text-gray-400">NRC -> SI Intake</span>
                            </div>
                        </div>
                    </div>

                    <div id="nav-process" class="sidebar-item p-5 rounded-xl opacity-40 cursor-not-allowed">
                        <div class="flex items-center gap-5">
                            <div
                                class="w-12 h-12 rounded-xl bg-gray-100 text-gray-400 flex items-center justify-center">
                                <i class="fas fa-microchip text-xl"></i>
                            </div>
                            <div class="flex flex-col">
                                <span class="text-sm font-black uppercase tracking-tight">2. Process</span>
                                <span class="text-xs font-bold text-gray-400">Checks & Builds</span>
                            </div>
                        </div>
                    </div>

                    <div id="nav-post" class="sidebar-item p-5 rounded-xl opacity-40 cursor-not-allowed">
                        <div class="flex items-center gap-5">
                            <div
                                class="w-12 h-12 rounded-xl bg-gray-100 text-gray-400 flex items-center justify-center">
                                <i class="fas fa-flag-checkered text-xl"></i>
                            </div>
                            <div class="flex flex-col">
                                <span class="text-sm font-black uppercase tracking-tight">3. Handover</span>
                                <span class="text-xs font-bold text-gray-400">Cleanup & BAU</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Terminal as Sidebar Widget -->
            <div class="px-6 mt-auto mb-8">
                <div class="terminal flex flex-col p-5 font-mono text-xs overflow-hidden shadow-sm h-72 border-dashed">
                    <div class="flex items-center justify-between mb-4 pb-3 border-b border-gray-100">
                        <div class="flex items-center gap-3">
                            <i class="fas fa-bolt text-[#009ed9] text-base"></i>
                            <span class="text-gray-400 font-black uppercase tracking-widest text-xs">Automation
                                Log</span>
                        </div>
                    </div>
                    <div id="terminal-log" class="flex-1 overflow-y-auto space-y-2 text-gray-600 pb-2">
                        <div class="text-gray-400 italic"># system.init.orchestrator.ready</div>
                        <div class="text-gray-400 italic"># wait.user_interaction</div>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Main Content Area -->
        <main class="flex-1 overflow-y-auto p-12 bg-[#f5f7f9] relative flex flex-col items-center">

            <!-- Dynamic Content Container -->
            <div id="workflow-container" class="w-full max-w-5xl space-y-12">
                <!-- Content will be injected here by JS -->
            </div>

            <!-- Floating Progress Bar -->
            <div class="fixed bottom-12 right-12 w-96 z-50 pointer-events-none opacity-0 transition-all duration-500 transform translate-y-4"
                id="global-progress-container">
                <div class="bg-white p-6 rounded-2xl border border-gray-200 shadow-[0_20px_50px_rgba(0,0,0,0.1)]">
                    <div class="flex justify-between items-end mb-4">
                        <span id="progress-text"
                            class="text-xs font-black text-gray-400 uppercase tracking-widest">Executing
                            Task...</span>
                        <span id="progress-percent" class="text-sm font-black text-[#009ed9]">0%</span>
                    </div>
                    <div class="w-full h-2 bg-gray-100 rounded-full overflow-hidden">
                        <div id="progress-bar" class="h-full bg-[#009ed9] transition-all duration-300"
                            style="width: 0%"></div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Hidden Footer (BaU Transition) -->
    <footer class="hidden"></footer>

    <script>
        const wait = (ms) => new Promise(resolve => setTimeout(resolve, ms));

        const log = (message, type = 'info') => {
            const terminal = document.getElementById('terminal-log');
            const entry = document.createElement('div');
            entry.className = type === 'cmd' ? 'text-[#009ed9] font-bold' : (type === 'err' ? 'text-[#dc322f]' : 'text-gray-600');

            const timestamp = new Date().toLocaleTimeString([], { hour12: false, hour: '2-digit', minute: '2-digit', second: '2-digit' });
            entry.innerHTML = `<span class="opacity-40 text-gray-400 mr-1">[${timestamp}]</span> ${message}`;

            terminal.appendChild(entry);
            terminal.scrollTop = terminal.scrollHeight;
        };

        const showProgress = async (percent, text = "Processing...") => {
            const container = document.getElementById('global-progress-container');
            const bar = document.getElementById('progress-bar');
            const textEl = document.getElementById('progress-text');
            const percentEl = document.getElementById('progress-percent');

            container.classList.remove('opacity-0');
            textEl.textContent = text;
            bar.style.width = `${percent}%`;
            percentEl.textContent = `${percent}%`;

            if (percent >= 100) {
                await wait(800);
                container.classList.add('opacity-0');
                await wait(500);
                bar.style.width = '0%';
            }
        };

        // Workflow Engine
        let currentStep = 0;
        let releaseConfig = {
            type: 'Standard',
            country: 'INT',
            summary: ''
        };

        const workflowContainer = document.getElementById('workflow-container');

        const steps = [
            {
                id: 'nrc-init',
                title: 'Phase 1: NRC Authoring Team',
                subtitle: 'Initial Release Request & Service Desk Ticketing',
                icon: 'fa-clipboard-check',
                accent: '#009ed9',
                render: () => `
                    <div class="step-transition">
                        <header class="mb-12">
                            <div class="flex items-center gap-6 mb-4">
                                <div class="w-20 h-20 rounded-2xl bg-[#009ed9]/10 flex items-center justify-center text-[#009ed9] text-3xl shadow-sm border border-[#009ed9]/10">
                                    <i class="fas fa-clipboard-check"></i>
                                </div>
                                <div class="flex-1">
                                    <div class="flex items-center justify-between">
                                        <h3 class="text-3xl font-black text-gray-800 tracking-tight">NRC Authoring Team</h3>
                                        <i class="fas fa-file-invoice text-4xl text-gray-100"></i>
                                    </div>
                                    <p class="text-gray-400 font-bold uppercase tracking-widest text-xs">Initial Release Request & Service Desk Ticketing</p>
                                </div>
                            </div>
                        </header>

                        <div class="grid grid-cols-2 gap-8">
                            <div class="card p-8 space-y-6">
                                <div>
                                    <label class="block text-xs uppercase font-black text-gray-400 tracking-[0.2em] mb-3">Release Origin</label>
                                    <div class="p-5 bg-gray-50 rounded-xl border border-gray-100 flex items-center justify-between">
                                        <div class="flex items-center gap-4">
                                            <i class="fas fa-building text-orange-500 text-lg"></i>
                                            <span class="text-base font-bold text-gray-700">BAU (Business As Usual)</span>
                                        </div>
                                        <span class="text-xs bg-orange-100 text-orange-600 px-3 py-1 rounded font-black">ACTIVE</span>
                                    </div>
                                </div>

                                <div>
                                    <label class="block text-xs uppercase font-black text-gray-400 tracking-[0.2em] mb-3">Target Platform</label>
                                    <div class="p-5 bg-gray-50 rounded-xl border border-gray-100 flex items-center gap-4 text-gray-700">
                                        <i class="fas fa-cloud text-blue-500 text-lg"></i>
                                        <span class="text-base font-bold">Managed Service International</span>
                                    </div>
                                </div>

                                <button onclick="executeStep(0)" class="btn-primary w-full p-6 rounded-xl font-black text-sm uppercase tracking-widest flex items-center justify-center gap-4 anim-pulse shadow-md">
                                    <i class="fas fa-paper-plane"></i>
                                    Raise Release Request
                                </button>
                            </div>

                            <div class="space-y-6 lg:pl-4">
                                <div class="bg-blue-50 p-8 rounded-2xl border border-blue-100">
                                    <h4 class="text-xs font-black text-[#009ed9] mb-4 uppercase tracking-widest flex items-center gap-2">
                                        <i class="fas fa-info-circle"></i> Context
                                    </h4>
                                    <p class="text-sm leading-relaxed text-gray-500 font-medium">The NRC Release Lead initiates the request via the Service Desk. This generates the orchestration ticket used to track the release lifecycle.</p>
                                </div>
                                <div class="px-4">
                                    <div class="flex items-center gap-3 text-xs font-black text-gray-400 mb-6 uppercase tracking-widest">
                                        <i class="fas fa-robot text-sm"></i> Automation Nodes
                                    </div>
                                    <ul class="text-sm text-gray-400 space-y-4 font-bold">
                                        <li class="flex items-center gap-4"><i class="fas fa-check-circle text-emerald-500"></i> Jira Ticket Generation</li>
                                        <li class="flex items-center gap-4"><i class="fas fa-check-circle text-emerald-500"></i> Notification Dispatch</li>
                                        <li class="flex items-center gap-4"><i class="fas fa-spinner animate-spin text-[#009ed9]"></i> Waiting for Trigger...</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                `
            },
            {
                id: 'si-intake',
                title: 'Phase 1: SI International Intake',
                subtitle: 'Request Verification & Summary Formatting',
                render: () => `
                    <div class="step-transition">
                        <header class="mb-12">
                            <div class="flex items-center gap-6 mb-4">
                                <div class="w-20 h-20 rounded-2xl bg-[#009ed9]/10 flex items-center justify-center text-[#009ed9] text-3xl shadow-sm border border-[#009ed9]/10">
                                    <i class="fas fa-id-card"></i>
                                </div>
                                <div class="flex-1">
                                    <div class="flex items-center justify-between">
                                        <h3 class="text-3xl font-black text-gray-800 tracking-tight">SI International Intake</h3>
                                        <i class="fas fa-spell-check text-4xl text-gray-100"></i>
                                    </div>
                                    <p class="text-gray-400 font-bold uppercase tracking-widest text-xs">Validating Country Meta & Automated Summary</p>
                                </div>
                            </div>
                        </header>

                        <div class="grid grid-cols-2 gap-8">
                            <div class="card p-8 space-y-10">
                                <div class="grid grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-xs uppercase font-black text-gray-400 tracking-[0.2em] mb-3">Country Code</label>
                                        <input type="text" id="input-country" value="BE" class="w-full bg-gray-50 border border-gray-200 text-gray-800 p-5 rounded-xl outline-none focus:border-[#009ed9] transition-colors font-black uppercase text-base">
                                    </div>
                                    <div>
                                        <label class="block text-xs uppercase font-black text-gray-400 tracking-[0.2em] mb-3">Release Month</label>
                                        <div class="relative">
                                            <select id="input-month" class="w-full bg-gray-50 border border-gray-200 text-gray-800 p-5 rounded-xl outline-none focus:border-[#009ed9] transition-colors appearance-none font-bold text-base">
                                                <option value="May">May</option>
                                                <option value="Nov">November</option>
                                            </select>
                                            <i class="fas fa-chevron-down absolute right-5 top-1/2 -translate-y-1/2 text-gray-300 pointer-events-none text-sm"></i>
                                        </div>
                                    </div>
                                </div>

                                <div>
                                    <label class="block text-xs uppercase font-black text-gray-400 tracking-[0.2em] mb-3">Automated Summary Preview</label>
                                    <div id="summary-preview" class="p-6 bg-blue-50/50 rounded-xl border border-dashed border-[#009ed9]/30 font-mono text-sm text-[#009ed9] font-bold">
                                        BE | May | 2025 | Release
                                    </div>
                                </div>

                                <button onclick="executeStep(1)" class="btn-primary w-full p-6 rounded-xl font-black text-sm uppercase tracking-widest flex items-center justify-center gap-4 shadow-md">
                                    <i class="fas fa-check-double"></i>
                                    Verify & Format
                                </button>
                            </div>

                            <div class="space-y-6 lg:pl-4">
                                <div class="bg-blue-50/50 p-8 rounded-2xl border border-blue-100">
                                    <h4 class="text-xs font-black text-[#009ed9] mb-4 uppercase tracking-widest flex items-center gap-2">
                                        <i class="fas fa-microchip text-sm"></i> Pattern Matcher
                                    </h4>
                                    <p class="text-sm leading-relaxed text-gray-500 font-medium">The orchestrator parses the request to ensure validity within the SNOMED International namespace and generates the canonical format.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                `
            },
            {
                id: 'template-select',
                title: 'Phase 1: Release Configuration',
                subtitle: 'Template Selection & Branching Point',
                render: () => `
                    <div class="step-transition">
                        <header class="mb-12">
                            <div class="flex items-center gap-6 mb-4">
                                <div class="w-20 h-20 rounded-2xl bg-[#009ed9]/10 flex items-center justify-center text-[#009ed9] text-3xl shadow-sm border border-[#009ed9]/10">
                                    <i class="fas fa-sitemap"></i>
                                </div>
                                <div class="flex-1">
                                    <div class="flex items-center justify-between">
                                        <h3 class="text-3xl font-black text-gray-800 tracking-tight">Configuration Branching</h3>
                                        <i class="fas fa-code-branch text-4xl text-gray-100"></i>
                                    </div>
                                    <p class="text-gray-400 font-bold uppercase tracking-widest text-xs">Select Process Template for Extension Release</p>
                                </div>
                            </div>
                        </header>

                        <div class="grid grid-cols-2 gap-8">
                            <div onclick="selectTemplate('Standard')" class="card p-8 cursor-pointer border-2 border-transparent hover:border-[#009ed9] transition-all group relative overflow-hidden">
                                <div class="flex justify-between items-start mb-6">
                                    <div class="w-14 h-14 rounded-xl bg-blue-50 flex items-center justify-center text-[#009ed9] text-2xl">
                                        <i class="fas fa-box-open"></i>
                                    </div>
                                    <div id="standard-check" class="w-8 h-8 rounded-full border-2 border-gray-100 flex items-center justify-center text-[#009ed9] bg-white shadow-sm">
                                        <i class="fas fa-check text-xs opacity-0 transition-opacity"></i>
                                    </div>
                                </div>
                                <h4 class="text-2xl font-black text-gray-800 mb-2">Standard Release</h4>
                                <p class="text-sm text-gray-400 mb-6 font-medium leading-relaxed">Comprehensive cycle including full QA and pre-production loops.</p>
                                <ul class="text-xs text-gray-500 space-y-4 mb-8 font-bold">
                                    <li class="flex items-center gap-4 text-[#009ed9]"><i class="fas fa-chevron-right text-[10px]"></i> Extended Verification</li>
                                    <li class="flex items-center gap-4 text-gray-400"><i class="fas fa-chevron-right text-[10px]"></i> Manual QA Sign-offs</li>
                                    <li class="flex items-center gap-4 text-gray-400"><i class="fas fa-chevron-right text-[10px]"></i> Multi-day Pre-prod</li>
                                </ul>
                                <button class="w-full py-4 rounded-lg border-2 border-gray-100 text-gray-400 font-black text-xs uppercase tracking-widest group-hover:bg-[#009ed9] group-hover:text-white group-hover:border-[#009ed9] transition-all">Select Standard</button>
                            </div>

                            <div onclick="selectTemplate('Frequent')" class="card p-8 cursor-pointer border-2 border-transparent hover:border-purple-500 transition-all group relative overflow-hidden">
                                <div class="flex justify-between items-start mb-6">
                                    <div class="w-14 h-14 rounded-xl bg-purple-50 flex items-center justify-center text-purple-600 text-2xl">
                                        <i class="fas fa-bolt"></i>
                                    </div>
                                    <div id="frequent-check" class="w-8 h-8 rounded-full border-2 border-gray-100 flex items-center justify-center text-purple-600 bg-white shadow-sm">
                                        <i class="fas fa-check text-xs opacity-0 transition-opacity"></i>
                                    </div>
                                </div>
                                <h4 class="text-2xl font-black text-gray-800 mb-2">Frequent Release</h4>
                                <p class="text-sm text-gray-400 mb-6 font-medium leading-relaxed">Streamlined releases with focus on delta-adders only.</p>
                                <ul class="text-xs text-gray-500 space-y-4 mb-8 font-bold">
                                    <li class="flex items-center gap-4 text-purple-600"><i class="fas fa-chevron-right text-[10px]"></i> Accelerated Validation</li>
                                    <li class="flex items-center gap-4 text-gray-400"><i class="fas fa-chevron-right text-[10px]"></i> Automated Checkpoints</li>
                                    <li class="flex items-center gap-4 text-gray-400"><i class="fas fa-chevron-right text-[10px]"></i> Focus on Deltas</li>
                                </ul>
                                <button class="w-full py-4 rounded-lg border-2 border-gray-100 text-gray-400 font-black text-xs uppercase tracking-widest group-hover:bg-purple-600 group-hover:text-white group-hover:border-purple-600 transition-all">Select Frequent</button>
                            </div>
                        </div>
                    </div>
                `
            },
            {
                id: 'config-validate',
                title: 'Phase 1: Configuration Validation',
                subtitle: 'Branching & Date Verification',
                render: () => `
                    <div class="step-transition">
                        <header class="mb-12">
                            <div class="flex items-center gap-6 mb-4">
                                <div class="w-20 h-20 rounded-2xl bg-amber-50 flex items-center justify-center text-amber-500 text-3xl shadow-sm border border-amber-100">
                                    <i class="fas fa-calendar-check"></i>
                                </div>
                                <div class="flex-1">
                                    <div class="flex items-center justify-between">
                                        <h3 class="text-3xl font-black text-gray-800 tracking-tight">Configuration Audit</h3>
                                        <i class="fas fa-shield-check text-4xl text-gray-100"></i>
                                    </div>
                                    <p class="text-gray-400 font-bold uppercase tracking-widest text-xs">Automated Branch Discovery & Dependency Check</p>
                                </div>
                            </div>
                        </header>

                        <div class="grid grid-cols-2 gap-8">
                            <div class="card p-8 space-y-8">
                                <div>
                                    <label class="block text-xs uppercase font-black text-gray-400 tracking-[0.2em] mb-4">Pre-Production Branch</label>
                                    <div class="flex gap-3">
                                        <input type="text" id="input-branch" value="MAIN/SNOMEDCT-BE/BEREL" class="flex-1 bg-gray-50 border border-gray-200 text-gray-800 p-5 rounded-xl outline-none focus:border-[#009ed9] transition-colors font-mono text-sm font-bold">
                                        <button class="w-14 bg-white border border-gray-200 text-gray-400 rounded-xl hover:text-[#009ed9] hover:border-[#009ed9] transition-colors shadow-sm text-lg">
                                            <i class="fas fa-search"></i>
                                        </button>
                                    </div>
                                </div>

                                <div class="space-y-4">
                                    <div class="flex items-center justify-between p-5 bg-gray-50 rounded-xl border border-gray-100">
                                        <div class="flex flex-col">
                                            <span class="text-xs uppercase font-black text-gray-400">Dependency Release</span>
                                            <span class="text-sm font-bold text-gray-700">2024-07-31 (International)</span>
                                        </div>
                                        <i class="fas fa-check-circle text-emerald-500 text-lg"></i>
                                    </div>
                                    <div class="flex items-center justify-between p-5 bg-gray-50 rounded-xl border border-gray-100">
                                        <div class="flex flex-col">
                                            <span class="text-xs uppercase font-black text-gray-400">Next Release Date</span>
                                            <span class="text-sm font-bold text-gray-700">2025-05-31</span>
                                        </div>
                                        <i class="fas fa-edit text-amber-500 cursor-pointer text-lg"></i>
                                    </div>
                                </div>

                                <button onclick="executeStep(3)" class="btn-primary w-full p-6 rounded-xl font-black text-sm uppercase tracking-widest flex items-center justify-center gap-4 shadow-md bg-amber-500">
                                    <i class="fas fa-shield-halved"></i>
                                    Perform Pre-Release Audit
                                </button>
                            </div>

                            <div class="space-y-6 lg:pl-4">
                                <div class="bg-gray-50 p-8 rounded-2xl border border-gray-100">
                                    <h4 class="text-xs font-black text-gray-400 mb-6 uppercase tracking-widest">Validation Checklist</h4>
                                    <div class="space-y-5">
                                        <div class="flex items-center gap-4 text-sm font-bold text-gray-500">
                                            <i class="fas fa-check-circle text-emerald-500 text-lg"></i>
                                            Refsets tab populated correctly
                                        </div>
                                        <div class="flex items-center gap-4 text-sm font-bold text-gray-500">
                                            <i class="fas fa-check-circle text-emerald-500 text-lg"></i>
                                            No outstanding critical tickets
                                        </div>
                                        <div id="check-branch" class="flex items-center gap-4 text-sm font-bold text-gray-300">
                                            <i class="fas fa-circle-notch text-gray-200 text-lg"></i>
                                            Branch existence verified in AP
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `
            },
            {
                id: 'phase2-start',
                title: 'Phase 2: Release Process',
                subtitle: 'Automated Pre-Release Infrastructure Checks',
                render: () => `
                    <div class="step-transition">
                        <header class="mb-12">
                            <div class="flex items-center gap-6 mb-4">
                                <div class="w-20 h-20 rounded-2xl bg-emerald-50 flex items-center justify-center text-emerald-500 text-3xl shadow-sm border border-emerald-100">
                                    <i class="fas fa-microchip"></i>
                                </div>
                                <div class="flex-1">
                                    <div class="flex items-center justify-between">
                                        <h3 class="text-3xl font-black text-gray-800 tracking-tight">Release Engine Primed</h3>
                                        <i class="fas fa-server text-4xl text-gray-100"></i>
                                    </div>
                                    <p class="text-gray-400 font-bold uppercase tracking-widest text-xs">Initiating automated pre-release checkpoints</p>
                                </div>
                            </div>
                        </header>

                        <div class="max-w-2xl mx-auto text-center space-y-10">
                            <div class="relative inline-block">
                                <div class="w-40 h-40 rounded-full border-8 border-emerald-50 flex items-center justify-center relative">
                                    <i class="fas fa-sync fa-spin text-5xl text-emerald-400"></i>
                                    <div class="absolute inset-0 border-8 border-[#009ed9] border-t-transparent rounded-full animate-spin"></div>
                                </div>
                                <div class="absolute -top-3 -right-3 bg-emerald-500 text-white text-xs font-black px-3 py-1.5 rounded shadow-lg uppercase">READY</div>
                            </div>
                            
                            <div class="space-y-5">
                                <h4 class="text-3xl font-black text-gray-800 tracking-tight">System Infrastructure Verified</h4>
                                <p class="text-sm font-bold text-gray-400 leading-relaxed px-12">Orchestrator has verified connectivity to Snowstorm, RVF, and S3 build buckets. Phase 2 orchestration is ready.</p>
                            </div>

                            <div class="grid grid-cols-2 gap-6">
                                <button onclick="executeStep(4)" class="btn-primary p-6 rounded-xl font-black text-sm uppercase tracking-widest flex items-center justify-center gap-4 shadow-md">
                                    <i class="fas fa-play"></i>
                                    START RELEASE ENGINE
                                </button>
                                <button class="p-6 rounded-xl font-black text-sm uppercase tracking-widest flex items-center justify-center gap-4 border-2 border-gray-100 text-gray-400 hover:border-gray-300 hover:text-gray-600 transition-all bg-white shadow-sm">
                                    <i class="fas fa-flask"></i>
                                    DRY RUN ONLY
                                </button>
                            </div>
                        </div>
                    </div>
                `
            },
            {
                id: 'build-orchestration',
                title: 'Phase 2: Build & Versioning',
                subtitle: 'Parallel Build Streams & Technical Validation',
                render: () => `
                    <div class="step-transition">
                        <header class="mb-12">
                            <div class="flex items-center gap-6 mb-4">
                                <div class="w-20 h-20 rounded-2xl bg-blue-50 flex items-center justify-center text-[#009ed9] text-3xl shadow-sm border border-blue-100">
                                    <i class="fas fa-hammer"></i>
                                </div>
                                <div class="flex-1">
                                    <div class="flex items-center justify-between">
                                        <h3 class="text-3xl font-black text-gray-800 tracking-tight">Build Orchestration</h3>
                                        <i class="fas fa-terminal text-4xl text-gray-100"></i>
                                    </div>
                                    <p class="text-gray-400 font-bold uppercase tracking-widest text-xs">Managing ${releaseConfig.type} Release Lifecycle</p>
                                </div>
                            </div>
                        </header>

                        <div class="grid grid-cols-2 gap-8">
                            <div class="space-y-6">
                                <div class="card p-8 relative overflow-hidden">
                                     <div class="flex justify-between items-center mb-8">
                                        <h4 class="text-xs font-black text-gray-500 uppercase tracking-widest">Build Pipeline</h4>
                                        <span class="px-3 py-1 rounded-full bg-blue-50 text-[#009ed9] text-[10px] font-black tracking-widest">${releaseConfig.type.toUpperCase()} MODE</span>
                                     </div>
                                     
                                     <div class="space-y-4 mb-10">
                                        <div id="build-step-1" class="flex items-center gap-5 p-5 bg-gray-50 rounded-xl border border-gray-100 opacity-40 transition-all shadow-sm">
                                            <div class="w-10 h-10 rounded-xl bg-white border border-gray-100 flex items-center justify-center text-sm font-black text-gray-300 shadow-sm font-mono">1</div>
                                            <span class="text-sm font-black text-gray-400 uppercase tracking-tight">Pre-Production Build</span>
                                            <i class="fas fa-circle-notch fa-spin ms-auto text-[#009ed9] text-lg opacity-0"></i>
                                        </div>
                                        <div id="build-step-2" class="flex items-center gap-5 p-5 bg-gray-50 rounded-xl border border-gray-100 opacity-40 transition-all shadow-sm">
                                            <div class="w-10 h-10 rounded-xl bg-white border border-gray-100 flex items-center justify-center text-sm font-black text-gray-300 shadow-sm font-mono">2</div>
                                            <span class="text-sm font-black text-gray-400 uppercase tracking-tight">SCTID Versioning</span>
                                            <i class="fas fa-circle-notch fa-spin ms-auto text-[#009ed9] text-lg opacity-0"></i>
                                        </div>
                                        <div id="build-step-3" class="flex items-center gap-5 p-5 bg-gray-50 rounded-xl border border-gray-100 opacity-40 transition-all shadow-sm">
                                            <div class="w-10 h-10 rounded-xl bg-white border border-gray-100 flex items-center justify-center text-sm font-black text-gray-300 shadow-sm font-mono">3</div>
                                            <span class="text-sm font-black text-gray-400 uppercase tracking-tight">Production Alpha Build</span>
                                            <i class="fas fa-circle-notch fa-spin ms-auto text-[#009ed9] text-lg opacity-0"></i>
                                        </div>
                                     </div>

                                     <button id="btn-start-build" onclick="executeStep(5)" class="btn-primary w-full p-6 rounded-xl font-black text-sm uppercase tracking-widest flex items-center justify-center gap-4 shadow-md">
                                        <i class="fas fa-rocket"></i>
                                        Execute Pipeline
                                     </button>
                                </div>
                            </div>

                            <div class="card p-8 bg-gray-50 border-dashed border-2">
                                <h4 class="text-xs font-black text-gray-400 mb-8 uppercase tracking-widest px-2">Metadata Injection</h4>
                                <div class="space-y-6">
                                    <div class="p-6 bg-white rounded-xl border border-gray-200 font-mono text-xs shadow-sm space-y-2">
                                        <p class="text-gray-300 mb-4 opacity-60 font-medium">// Environment Context</p>
                                        <div class="flex gap-3">
                                            <span class="text-gray-400">RELEASE:</span>
                                            <span class="text-[#009ed9] font-black underline decoration-2 underline-offset-4 decoration-[#009ed9]/20">"${releaseConfig.type}"</span>
                                        </div>
                                        <div class="flex gap-3">
                                            <span class="text-gray-400">TARGET:</span>
                                            <span class="text-[#009ed9] font-black underline decoration-2 underline-offset-4 decoration-[#009ed9]/20">"${document.getElementById('input-branch')?.value || 'MAIN/SNOMEDCT-BE'}"</span>
                                        </div>
                                        <div class="flex gap-3">
                                            <span class="text-gray-400">ALPHA:</span>
                                            <span class="text-[#009ed9] font-black underline decoration-2 underline-offset-4 decoration-[#009ed9]/20">"${releaseConfig.country}"</span>
                                        </div>
                                    </div>
                                    <div class="p-6 border-l-4 border-blue-100 bg-blue-50/20 rounded-r-xl">
                                        <p class="text-xs font-bold text-gray-400 italic leading-relaxed">Cross-referencing Service Desk metadata with automation pipelines.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `
            },
            {
                id: 'release-final',
                title: 'Phase 3: Post-Release & Handover',
                subtitle: 'Production Promotion & BAU Transition',
                render: () => `
                    <div class="step-transition">
                        <header class="mb-12">
                            <div class="flex items-center gap-6 mb-4">
                                <div class="w-20 h-20 rounded-2xl bg-emerald-50 flex items-center justify-center text-emerald-500 text-3xl shadow-sm border border-emerald-100">
                                    <i class="fas fa-flag-checkered"></i>
                                </div>
                                <div class="flex-1">
                                    <div class="flex items-center justify-between">
                                        <h3 class="text-3xl font-black text-gray-800 tracking-tight">Mission Success</h3>
                                        <i class="fas fa-trophy text-4xl text-gray-100"></i>
                                    </div>
                                    <p class="text-gray-400 font-bold uppercase tracking-widest text-xs">Release Promoted to Stable Channel</p>
                                </div>
                            </div>
                        </header>

                        <div class="grid grid-cols-3 gap-8">
                            <div class="card p-8 text-center space-y-5">
                                <div class="w-16 h-16 bg-gray-50 rounded-2xl flex items-center justify-center text-gray-400 mx-auto border border-gray-100 text-xl shadow-sm">
                                    <i class="fas fa-archive"></i>
                                </div>
                                <h5 class="text-xs font-black text-gray-800 uppercase tracking-widest">RF2 Artifacts</h5>
                                <p class="text-sm font-bold text-gray-400 leading-normal">Packages archived to S3 storage.</p>
                            </div>
                            <div class="card p-8 text-center space-y-5 border-emerald-100 bg-emerald-50/20">
                                <div class="w-16 h-16 bg-emerald-50 rounded-2xl flex items-center justify-center text-emerald-500 mx-auto border border-emerald-100 text-xl shadow-sm">
                                    <i class="fas fa-bullhorn"></i>
                                </div>
                                <h5 class="text-xs font-black text-gray-800 uppercase tracking-widest">Stakeholders</h5>
                                <p class="text-sm font-bold text-emerald-600 leading-normal">NRC Lead signaled via Webhook.</p>
                            </div>
                            <div class="card p-8 text-center space-y-5">
                                <div class="w-16 h-16 bg-gray-50 rounded-2xl flex items-center justify-center text-gray-400 mx-auto border border-gray-100 text-xl shadow-sm">
                                    <i class="fas fa-rotate-left"></i>
                                </div>
                                <h5 class="text-xs font-black text-gray-800 uppercase tracking-widest">Platform Reset</h5>
                                <p class="text-sm font-bold text-gray-400 leading-normal">Environment returned to BAU state.</p>
                            </div>
                        </div>

                        <div class="mt-12 flex justify-center">
                            <button onclick="window.location.reload()" class="btn-primary px-12 py-5 rounded-xl font-black text-xs uppercase tracking-[0.3em] shadow-xl flex items-center gap-4">
                                <i class="fas fa-power-off"></i>
                                Terminate Session
                            </button>
                        </div>
                    </div>
                `
            }
        ];

        const executeStep = async (stepIdx) => {
            if (stepIdx === 0) {
                log("Raising release request...", "cmd");
                await wait(500);

                await showProgress(30, "Connecting to Service Desk...");
                log("Connected to API: jira.ihtsdotools.org");
                await wait(800);

                await showProgress(70, "Generating ticket metadata...");
                log("Success: Ticket created on Managed Service Desk.", "info");
                await wait(800);

                await showProgress(100, "Ticket Created: ISRS-4291");
                log("Transition: Dispatched to SI International Team.", "info");

                currentStep = 1;
                renderStep(1);
            } else if (stepIdx === 1) {
                const country = document.getElementById('input-country').value;
                const month = document.getElementById('input-month').value;
                const formatted = `${country.toUpperCase()} | ${month} | 2025 | Release`;

                log(`Validating Country Code: ${country.toUpperCase()}`);
                await wait(400);

                await showProgress(50, "Formatting summary...");
                log(`Summary formatted: ${formatted}`, "cmd");
                await wait(800);

                await showProgress(100, "Intake Complete");
                log("Success: Metadata verified and summarized.", "info");

                releaseConfig.country = country;
                releaseConfig.summary = formatted;

                currentStep = 2;
                renderStep(2);
            } else if (stepIdx === 3) {
                log("Initiating Pre-Release Audit...", "cmd");
                await wait(400);

                await showProgress(20, "Scanning AP Branches...");
                log(`Found branch: ${document.getElementById('input-branch').value}`);

                const checkNode = document.getElementById('check-branch');
                checkNode.classList.remove('text-gray-300');
                checkNode.classList.add('text-emerald-500');
                checkNode.querySelector('i').className = 'fas fa-check-circle text-emerald-500';

                await wait(800);

                await showProgress(60, "Verifying dependency alignments...");
                log("Dependency: July 2024 International Release verified.");
                await wait(1000);

                await showProgress(90, "Checking Refset Delta populations...");
                log("Refsets: 14 modified, 0 orphans found.");
                await wait(1200);

                await showProgress(100, "Audit Successful");
                log("Success: All pre-conditions for Release Phase met.", "info");

                currentStep = 4;
                renderStep(4);
            } else if (stepIdx === 4) {
                log("PHASE 2 INITIALIZED", "info");
                document.getElementById('nav-prepare').classList.remove('active');
                document.getElementById('nav-prepare').classList.add('opacity-40');

                const navProc = document.getElementById('nav-process');
                navProc.classList.remove('opacity-40', 'cursor-not-allowed');
                navProc.classList.add('active');
                navProc.querySelector('.w-12').classList.replace('bg-gray-100', 'bg-[#009ed9]/10');
                navProc.querySelector('.w-12').classList.replace('text-gray-400', 'text-[#009ed9]');

                document.getElementById('breadcrumb-status').textContent = "Process Phase";

                await showProgress(40, "Verifying Build Infrastructure...");
                log("RVF API: Online");
                log("Jenkins Node: msi-release-01 Online");
                await wait(1000);

                await showProgress(80, "Polling Snowstorm health...");
                log("Snowstorm Cluster: Healthy [3/3 Nodes]");
                await wait(800);

                await showProgress(100, "Infrastructure Ready");

                currentStep = 5;
                renderStep(5);
            } else if (stepIdx === 5) {
                const btn = document.getElementById('btn-start-build');
                btn.disabled = true;
                btn.classList.add('opacity-50', 'pointer-events-none');
                btn.style.backgroundColor = '#94a3b8';
                btn.innerHTML = '<i class="fas fa-circle-notch fa-spin"></i> PIPELINE RUNNING';

                const s1 = document.getElementById('build-step-1');
                const s2 = document.getElementById('build-step-2');
                const s3 = document.getElementById('build-step-3');

                // Step 1: Pre-prod
                s1.classList.remove('opacity-40');
                s1.querySelector('i').classList.remove('opacity-0');
                log("Starting Pre-Production Build...", "cmd");
                await wait(2000);
                s1.querySelector('.w-10').classList.replace('text-gray-300', 'text-emerald-500');
                s1.querySelector('.w-10').innerHTML = '<i class="fas fa-check"></i>';
                s1.querySelector('i').className = 'fas fa-check-circle ms-auto text-emerald-500';
                log("Pre-Production Build Success. RVF Report: 0 errors.", "info");

                // Step 2: Versioning
                s2.classList.remove('opacity-40');
                s2.querySelector('i').classList.remove('opacity-0');
                log("Executing SCTID Versioning...", "cmd");
                await wait(2500);
                s2.querySelector('.w-10').classList.replace('text-gray-300', 'text-emerald-500');
                s2.querySelector('.w-10').innerHTML = '<i class="fas fa-check"></i>';
                s2.querySelector('i').className = 'fas fa-check-circle ms-auto text-emerald-500';
                log("Versioning Complete. 124,592 components versioned.", "info");

                // Step 3: Production Alpha
                s3.classList.remove('opacity-40');
                s3.querySelector('i').classList.remove('opacity-0');
                log("Generating Production Alpha Build...", "cmd");
                await wait(2000);
                s3.querySelector('.w-10').classList.replace('text-gray-300', 'text-emerald-500');
                s3.querySelector('.w-10').innerHTML = '<i class="fas fa-check"></i>';
                s3.querySelector('i').className = 'fas fa-check-circle ms-auto text-emerald-500';
                log("Alpha Build Complete. Package stored in MSI-BUILDS repository.", "info");

                await wait(1000);

                document.getElementById('nav-process').classList.remove('active');
                document.getElementById('nav-process').classList.add('opacity-40');

                const navPost = document.getElementById('nav-post');
                navPost.classList.remove('opacity-40', 'cursor-not-allowed');
                navPost.classList.add('active');
                navPost.querySelector('.w-12').classList.replace('bg-gray-100', 'bg-[#009ed9]/10');
                navPost.querySelector('.w-12').classList.replace('text-gray-400', 'text-[#009ed9]');

                document.getElementById('breadcrumb-status').textContent = "Handover Phase";

                currentStep = 6;
                renderStep(6);
                log("TRANSITION: Phase 3 Handover sequence started.", "info");
            }
        };

        const selectTemplate = async (type) => {
            log(`Selecting Release Template: ${type} Context`, "cmd");
            releaseConfig.type = type;

            const stdCheck = document.getElementById('standard-check').querySelector('i');
            const freqCheck = document.getElementById('frequent-check').querySelector('i');

            if (type === 'Standard') {
                stdCheck.classList.remove('opacity-0');
                freqCheck.classList.add('opacity-0');
            } else {
                stdCheck.classList.add('opacity-0');
                freqCheck.classList.remove('opacity-0');
            }

            await wait(600);
            await showProgress(100, `Template: ${type} Applied`);
            log(`Workflow branched to ${type} path.`, "info");

            currentStep = 3;
            renderStep(3);
        };

        // Initialize UI
        const renderStep = (idx) => {
            workflowContainer.innerHTML = steps[idx].render();
            // Trigger entry animation
            setTimeout(() => {
                workflowContainer.querySelector('.step-transition').classList.add('visible');
            }, 50);
        };

        renderStep(0);
        log("Orchestrator v1.2 initialized successfully.", "info");
        log("Workflow: Managed Service Release Process", "info");

    </script>
</body>

</html>
