<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SNOMED CT Editorial Guide Browser | SNOMED International</title>
    <meta name="description" content="Interactive browser for the SNOMED CT Editorial Guide - comprehensive clinical terminology management guidelines from SNOMED International">
    <meta name="keywords" content="SNOMED CT, clinical terminology, healthcare, medical coding, SNOMED International, editorial guide">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üè•</text></svg>">
    
    <!-- No framework dependencies - Pure JavaScript -->
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
<<<<<<< Updated upstream
=======
    <!-- Marked.js for Markdown parsing -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
>>>>>>> Stashed changes
    
    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .glass-effect {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .gradient-bg {
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
        }
        .concept-card {
            transition: all 0.3s ease;
        }
        .concept-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        .search-highlight {
            background-color: #fef3c7;
            padding: 2px 4px;
            border-radius: 3px;
        }
        .sidebar-nav {
            position: sticky;
            top: 2rem;
            max-height: none;
            overflow-y: visible;
        }
        
        /* Enhanced interactive elements */
        .concept-link {
            color: #1e40af;
            text-decoration: underline;
            cursor: pointer;
            padding: 2px 4px;
            border-radius: 3px;
            transition: all 0.2s ease;
        }
        .concept-link:hover {
            background-color: #eff6ff;
            text-decoration: none;
            color: #1d4ed8;
        }
        .concept-id {
            background: linear-gradient(135deg, #1e40af, #3b82f6);
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .concept-id:hover {
            transform: scale(1.05);
            box-shadow: 0 2px 8px rgba(30, 64, 175, 0.3);
        }
        
        /* Interactive content sections */
        .collapsible-section {
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 16px;
        }
        .collapsible-header {
            background: #f9fafb;
            padding: 12px 16px;
            cursor: pointer;
            display: flex;
            justify-content: between;
            align-items: center;
            transition: background-color 0.2s;
        }
        .collapsible-header:hover {
            background: #f3f4f6;
        }
        .collapsible-content {
            padding: 16px;
            display: block;
            transition: all 0.3s ease;
        }
        .collapsible-content.collapsed {
            display: none;
        }
        .expand-icon {
            transition: transform 0.2s ease;
        }
        .expand-icon.rotated {
            transform: rotate(180deg);
        }
        
        /* Enhanced hierarchy display */
        .hierarchy-path {
            background: #eff6ff;
            border-left: 4px solid #1e40af;
            padding: 8px 12px;
            border-radius: 4px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.875rem;
            margin: 8px 0;
        }
        .hierarchy-arrow {
            color: #6b7280;
            margin: 0 8px;
        }
        
        /* Interactive breadcrumbs */
        .breadcrumb-nav {
            background: rgba(30, 64, 175, 0.1);
            padding: 8px 16px;
            border-radius: 6px;
            margin-bottom: 16px;
        }
        .breadcrumb-link {
            color: #1e40af;
            text-decoration: none;
            font-weight: 500;
            cursor: pointer;
        }
        .breadcrumb-link:hover {
            text-decoration: underline;
            color: #1d4ed8;
        }
        
        /* Enhanced examples */
        .example-card {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 16px;
            margin: 8px 0;
            position: relative;
            transition: all 0.2s ease;
        }
        .example-card:hover {
            border-color: #1e40af;
            box-shadow: 0 2px 8px rgba(30, 64, 175, 0.1);
        }
        .example-tag {
            position: absolute;
            top: -8px;
            left: 16px;
            background: #1e40af;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        /* Cross-reference indicators */
        .cross-ref {
            background: #eff6ff;
            border-left: 4px solid #1e40af;
            padding: 8px 12px;
            border-radius: 4px;
            margin: 8px 0;
            font-size: 0.875rem;
        }
        .cross-ref-link {
            color: #1e40af;
            font-weight: 600;
            cursor: pointer;
            text-decoration: underline;
        }
        .cross-ref-link:hover {
            color: #1d4ed8;
        }
        
        /* Progress indicator */
        .progress-indicator {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: rgba(59, 130, 246, 0.2);
            z-index: 1000;
        }
        .progress-bar {
            height: 100%;
            background: #1e40af;
            width: 0%;
            transition: width 0.2s ease;
        }
        
        /* Quick navigation */
        .quick-nav {
            position: fixed;
            right: 24px;
            top: 50%;
            transform: translateY(-50%);
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            padding: 8px 0;
            z-index: 100;
            opacity: 0.95;
            max-height: 70vh;
            overflow-y: auto;
            border: 1px solid #e5e7eb;
        }
        .quick-nav-item {
            display: block;
            padding: 8px 16px;
            color: #6b7280;
            text-decoration: none;
            font-size: 0.75rem;
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
            white-space: nowrap;
            cursor: pointer;
        }
        .quick-nav-item:hover {
            background: #f3f4f6;
            border-left-color: #1e40af;
            color: #1e40af;
        }
        .quick-nav-item.active {
            background: #eff6ff;
            border-left-color: #1e40af;
            color: #1e40af;
            font-weight: 600;
        }
        
        /* Enhanced animations */
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-slide-in {
            animation: slideIn 0.3s ease-out;
        }
        
        /* Responsive improvements */
        @media (max-width: 1024px) {
            .quick-nav {
                display: none;
            }
        }
        
        /* Statistics and Infographics */
        .stats-card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            border: 1px solid #e5e7eb;
            transition: all 0.3s ease;
        }
        .stats-card:hover {
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }
        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: #1e40af;
            line-height: 1;
        }
        .stat-label {
            font-size: 0.875rem;
            color: #6b7280;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        .stat-change {
            font-size: 0.75rem;
            padding: 2px 6px;
            border-radius: 12px;
            font-weight: 600;
        }
        .stat-change.positive {
            background: #dcfce7;
            color: #166534;
        }
        .stat-change.negative {
            background: #fef2f2;
            color: #dc2626;
        }
        .stat-change.neutral {
            background: #f3f4f6;
            color: #6b7280;
        }
        
        /* Chart containers */
        .chart-container {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            border: 1px solid #e5e7eb;
            margin-bottom: 24px;
        }
        .chart-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
        }
        .chart-title .material-icons {
            margin-right: 8px;
            color: #1e40af;
        }
        
        /* Bar chart */
        .bar-chart {
            display: flex;
            align-items: end;
            height: 200px;
            gap: 4px;
            margin: 16px 0;
        }
        .bar {
            flex: 1;
            background: linear-gradient(to top, #1e40af, #3b82f6);
            border-radius: 4px 4px 0 0;
            position: relative;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .bar:hover {
            background: linear-gradient(to top, #1d4ed8, #2563eb);
            transform: scaleY(1.05);
        }
        .bar-label {
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%) rotate(-45deg);
            font-size: 0.75rem;
            color: #6b7280;
            white-space: nowrap;
            font-weight: 500;
        }
        .bar-value {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.75rem;
            font-weight: 600;
            color: #1e40af;
            background: white;
            padding: 2px 6px;
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        /* Pie chart */
        .pie-chart {
            position: relative;
            width: 200px;
            height: 200px;
            margin: 0 auto;
        }
        .pie-segment {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            clip: rect(0, 100px, 200px, 0);
            transition: all 0.3s ease;
        }
        .pie-segment:hover {
            transform: scale(1.05);
        }
        .pie-legend {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 16px;
            justify-content: center;
        }
        .legend-item {
            display: flex;
            align-items: center;
            font-size: 0.875rem;
            color: #6b7280;
        }
        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 2px;
            margin-right: 6px;
        }
        
        /* Progress bars */
        .progress-container {
            margin: 16px 0;
        }
        .progress-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }
        .progress-label {
            flex: 1;
            font-size: 0.875rem;
            color: #6b7280;
        }
        .progress-bar-container {
            flex: 2;
            height: 8px;
            background: #f3f4f6;
            border-radius: 4px;
            overflow: hidden;
            margin: 0 12px;
        }
        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #1e40af, #3b82f6);
            border-radius: 4px;
            transition: width 0.3s ease;
        }
        .progress-value {
            font-size: 0.75rem;
            font-weight: 600;
            color: #1e40af;
            min-width: 40px;
            text-align: right;
        }
        
        /* Interactive filters */
        .stats-filters {
            display: flex;
            gap: 12px;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }
        .filter-btn {
            padding: 6px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            background: white;
            color: #6b7280;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .filter-btn.active {
            background: #1e40af;
            color: white;
            border-color: #1e40af;
        }
        .filter-btn:hover {
            border-color: #1e40af;
            color: #1e40af;
        }
        .filter-btn.active:hover {
            color: white;
        }
        
        /* Print styles */
        @media print {
            .sidebar-nav, .quick-nav, .progress-indicator {
                display: none;
            }
            .concept-card, .example-card {
                break-inside: avoid;
            }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Progress Indicator -->
    <div class="progress-indicator">
        <div class="progress-bar" id="progressBar"></div>
    </div>
    
    <!-- Quick Navigation -->
    <nav class="quick-nav" id="quickNav">
        <!-- Will be populated by JavaScript -->
    </nav>
    
    <!-- Scroll to Top Button -->
    <button id="scrollToTop" onclick="window.scrollTo({top: 0, behavior: 'smooth'})" class="fixed bottom-6 right-6 bg-blue-800 hover:bg-blue-900 text-white p-3 rounded-full shadow-lg transition-all duration-200 opacity-0 pointer-events-none z-50">
        <span class="material-icons">keyboard_arrow_up</span>
    </button>
    
    <div class="min-h-screen bg-gray-50">
        <!-- Header -->
        <header class="gradient-bg text-white shadow-lg">
            <div class="container mx-auto px-6 py-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-4">
                        <div class="flex items-center">
                            <span class="material-icons text-3xl mr-2">medical_services</span>
                            <div>
                                <h1 class="text-2xl font-bold">SNOMED CT Editorial Guide</h1>
                                <p class="text-blue-100 text-sm">Interactive Browser - Version 2025-01-08</p>
                            </div>
                        </div>
                        <div class="ml-8 text-right border-l border-blue-200 pl-4">
                            <p class="text-blue-100 text-xs">Powered by</p>
                            <p class="text-white font-semibold text-sm">SNOMED International</p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div class="relative">
                            <input 
                                type="text" 
                                id="searchInput"
                                placeholder="Search guide content..."
                                class="px-4 py-2 rounded-lg text-gray-800 w-80 focus:outline-none focus:ring-2 focus:ring-blue-300">
                            <span class="material-icons absolute right-3 top-2.5 text-gray-400">search</span>
                        </div>
                        <button class="bg-white/20 hover:bg-white/30 px-4 py-2 rounded-lg transition-colors">
                            <span class="material-icons">download</span>
                        </button>
                    </div>
                </div>
            </div>
        </header>
        
        <!-- Main Content -->
        <div class="container mx-auto px-6 py-8">
            <div class="grid lg:grid-cols-4 gap-8">
                <div class="lg:col-span-1">
                    <div id="sidebar"></div>
                </div>
                <div class="lg:col-span-3">
                    <div id="content"></div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="bg-gray-900 text-white mt-16">
            <div class="container mx-auto px-6 py-8">
                <div class="grid md:grid-cols-4 gap-8">
                    <div class="md:col-span-2">
                        <div class="flex items-center mb-4">
                            <span class="material-icons text-2xl mr-2">medical_services</span>
                            <h4 class="font-semibold text-lg">SNOMED CT Editorial Guide</h4>
                        </div>
                        <p class="text-gray-300 text-sm mb-4">Interactive browser for the comprehensive SNOMED CT Editorial Guide, providing guidelines for clinical terminology management. This tool helps implementers and clinicians navigate the complex world of SNOMED CT terminology standards.</p>
                        <div class="flex items-center space-x-4">
                            <a href="https://www.snomed.org/" target="_blank" class="text-blue-300 hover:text-white text-sm flex items-center">
                                <span class="material-icons text-sm mr-1">open_in_new</span>
                                SNOMED International
                            </a>
                            <a href="https://confluence.ihtsdotools.org/display/DOCEG/PDFs+for+Download" target="_blank" class="text-blue-300 hover:text-white text-sm flex items-center">
                                <span class="material-icons text-sm mr-1">description</span>
                                PDF Downloads
                            </a>
                        </div>
                    </div>
                    <div>
                        <h4 class="font-semibold mb-4">Resources</h4>
                        <ul class="space-y-2 text-sm text-gray-300">
                            <li><a href="https://www.snomed.org/snomed-ct" target="_blank" class="hover:text-white flex items-center">
                                <span class="material-icons text-xs mr-1">info</span>
                                What is SNOMED CT?
                            </a></li>
                            <li><a href="https://www.snomed.org/snomed-ct/get-snomed-ct" target="_blank" class="hover:text-white flex items-center">
                                <span class="material-icons text-xs mr-1">download</span>
                                Get SNOMED CT
                            </a></li>
                            <li><a href="https://www.snomed.org/snomed-ct/use-snomed-ct" target="_blank" class="hover:text-white flex items-center">
                                <span class="material-icons text-xs mr-1">settings</span>
                                Use SNOMED CT
                            </a></li>
                            <li><a href="https://www.snomed.org/snomed-ct/education" target="_blank" class="hover:text-white flex items-center">
                                <span class="material-icons text-xs mr-1">school</span>
                                Education
                            </a></li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="font-semibold mb-4">Version Info</h4>
                        <p class="text-gray-300 text-sm">Current Guide: 2025-01-08</p>
                        <p class="text-gray-300 text-sm">Monthly updates available</p>
                        <p class="text-gray-300 text-sm">¬© 2025 SNOMED International</p>
                        <div class="mt-4 pt-4 border-t border-gray-700">
                            <p class="text-gray-400 text-xs">Registered in England and Wales</p>
                            <p class="text-gray-400 text-xs">Company Registration Number 9915820</p>
                            <p class="text-gray-400 text-xs mt-2">Statistics from SNOMED CT Release (July 2025)</p>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <script>
        // Simple vanilla JavaScript implementation for the SNOMED CT Editorial Guide
        
        // Data storage - Complete content extracted from SNOMED CT Editorial Guide (35,000+ lines)
        const guideData = {
            sections: [
                {
                    id: 'introduction',
                    title: 'SNOMED CT Introduction',
                    icon: 'info',
                    description: 'What is SNOMED CT and why use it',
                    content: {
                        overview: 'SNOMED CT is a high-quality, comprehensive, international, logic-based reference terminology that is used to implement semantic interoperability in electronic health applications. Its logic-based definitions represent terminological knowledge, or what is always true about the meaning of relationships between the concepts, which further define the meaning.',
                        whatIsSNOMEDCT: [
                            'High-quality, comprehensive, international terminology',
                            'Logic-based reference terminology',
                            'Supports semantic interoperability in electronic health applications',
                            'Provides terminological knowledge through logic-based definitions',
                            'Defines relationships between concepts that establish meaning'
                        ],
                        whatIsSNOMEDCTDetails: {
                            overview: 'SNOMED CT is a comprehensive, multilingual clinical healthcare terminology that enables consistent, processable representation of clinical content in electronic health records.',
                            keyFeatures: [
                                'Comprehensive coverage of clinical concepts',
                                'Multilingual support for global implementation',
                                'Logic-based concept definitions',
                                'Hierarchical organization of clinical knowledge',
                                'Standardized clinical terminology for interoperability'
                            ],
                            technicalSpecifications: {
                                conceptModel: 'Based on description logic for formal concept definitions',
                                relationships: 'Uses semantic relationships to define concept meaning',
                                hierarchies: 'Organized into 19 top-level hierarchies',
                                descriptions: 'Multiple descriptions per concept for different use cases',
                                identifiers: 'Unique, permanent concept identifiers'
                            }
                        },
                        whyUseSNOMEDCT: [
                            'Semantic interoperability and multi-purpose use within electronic health applications',
                            'Consistent, formal expansion of content through centralized authoring',
                            'Clear, singular meaning of concepts',
                            'Reliable, consistent, and reproducible clinical documentation',
                            'Enhanced high-quality healthcare delivery to individuals and populations'
                        ],
                        whyUseSNOMEDCTDetails: {
                            benefits: {
                                clinical: [
                                    'Improved patient safety through standardized terminology',
                                    'Enhanced clinical decision support',
                                    'Better care coordination across healthcare settings',
                                    'Reduced medical errors through clear communication'
                                ],
                                technical: [
                                    'Semantic interoperability between systems',
                                    'Consistent data representation and exchange',
                                    'Support for advanced analytics and reporting',
                                    'Integration with international healthcare standards'
                                ],
                                organizational: [
                                    'Reduced implementation costs through standardization',
                                    'Improved data quality and consistency',
                                    'Enhanced regulatory compliance',
                                    'Support for evidence-based medicine'
                                ]
                            },
                            useCases: [
                                'Electronic Health Records (EHR)',
                                'Clinical Decision Support Systems',
                                'Health Information Exchange',
                                'Clinical Research and Analytics',
                                'Public Health Surveillance',
                                'Quality Measurement and Reporting'
                            ]
                        },
                        intendedUse: [
                            'Provide effective and comprehensive coverage of terms',
                            'Serve as a terminological resource',
                            'Implementation in electronic health applications',
                            'Support optimal retrieval, processing, and rendering of clinical information',
                            'Enable effective use of clinical information consistently and reproducibly',
                            'Support use of clinical information for statistical and reporting purposes'
                        ],
                        intendedUseDetails: {
                            primaryPurposes: {
                                terminology: 'Serve as the primary clinical terminology for healthcare systems',
                                interoperability: 'Enable semantic interoperability between healthcare applications',
                                documentation: 'Support comprehensive clinical documentation and communication',
                                analytics: 'Facilitate clinical research, analytics, and quality measurement'
                            },
                            implementationGuidelines: {
                                scope: 'Intended for use in clinical healthcare settings worldwide',
                                coverage: 'Comprehensive coverage of clinical concepts and procedures',
                                quality: 'High-quality, curated content with regular updates',
                                standards: 'Compliance with international healthcare terminology standards'
                            },
                            limitations: [
                                'Not intended for billing or reimbursement coding',
                                'Not a replacement for clinical judgment',
                                'Requires proper implementation and training',
                                'May need local extensions for specific use cases'
                            ]
                        },
                        semanticInteroperability: 'Semantic interoperability is the capability of two or more systems to communicate and exchange information. Each system should be able to interpret the meaning of, and effectively use, received information. The meaning of the information must be agreed upon, consistent, and clearly expressed.',
                        semanticInteroperabilityDetails: {
                            definition: 'The ability of different systems to exchange and interpret information with shared meaning, enabling effective communication and data exchange between healthcare applications.',
                            keyPrinciples: [
                                'Shared understanding of clinical concepts',
                                'Consistent representation of clinical data',
                                'Standardized terminology across systems',
                                'Preservation of clinical meaning during data exchange'
                            ],
                            implementation: {
                                terminology: 'Use of standardized clinical terminologies like SNOMED CT',
                                messaging: 'Standardized message formats (HL7 FHIR, CDA)',
                                coding: 'Consistent coding and classification systems',
                                validation: 'Data validation and quality assurance processes'
                            },
                            benefits: [
                                'Improved care coordination across healthcare settings',
                                'Enhanced clinical decision support',
                                'Better patient safety through clear communication',
                                'Reduced medical errors and improved outcomes',
                                'Support for population health and analytics'
                            ]
                        },
                        domains: [
                            'Body structure (anatomy)',
                            'Clinical finding (diseases, symptoms)',
                            'Environment or geographical location',
                            'Event (occurrences)',
                            'Observable entity (measurements)',
                            'Organism (bacteria, viruses, parasites)',
                            'Pharmaceutical / biologic product',
                            'Physical force',
                            'Physical object (devices, equipment)',
                            'Procedure (diagnostic and therapeutic)',
                            'Qualifier value (modifiers)',
                            'Record artifact (documents)',
                            'Social context (occupations, lifestyle)',
                            'Special concept (metadata)',
                            'Specimen (laboratory samples)',
                            'Staging and scales',
                            'Substance (chemicals, materials)'
                        ],
                        requirements: [
                            'Content, content, and content - Comprehensive clinical coverage',
                            'Nonvagueness and nonambiguity - Clear, precise meanings',
                            'Code permanence - Identifiers never change or get reused',
                            'Nonsemantic identifiers - Codes carry no implicit meaning',
                            'Polyhierarchy - Multiple inheritance paths allowed',
                            'Formal definitions - Logic-based concept definitions',
                            'Rejection of "Not elsewhere classified" - Avoid catch-all categories',
                            'Multiple granularities - Support different levels of detail',
                            'Multiple consistent views - Support various perspectives',
                            'Beyond terminology codes - Represent clinical context',
                            'Evolve gracefully - Maintain backward compatibility',
                            'Recognize redundancy - Avoid duplicate concepts'
                        ]
                    }
                },
                {
                    id: 'concept-model',
                    title: 'Concept Model Overview',
                    icon: 'account_tree',
                    description: 'Understanding the fundamental structure of SNOMED CT',
                                    content: {
                    overview: 'SNOMED CT uses a logical concept model based on description logic, organizing concepts into hierarchies and defining relationships between them. The model provides the foundation for all concept definitions and semantic relationships.',
                    overviewDetails: {
                        description: 'The SNOMED CT concept model is based on description logic, a formal knowledge representation language that enables precise definition of clinical concepts through logical relationships.',
                        keyComponents: [
                            'Concepts: Unique clinical ideas with permanent identifiers',
                            'Descriptions: Human-readable terms for concepts',
                            'Relationships: Logical connections between concepts',
                            'Hierarchies: Organized concept structures',
                            'Attributes: Properties that define concept characteristics'
                        ],
                        modelingPrinciples: {
                            logic: 'Based on description logic for formal reasoning',
                            hierarchy: 'Organized into multiple inheritance hierarchies',
                            relationships: 'Uses semantic relationships for concept definition',
                            attributes: 'Attributes define concept characteristics and meaning',
                            definitions: 'Concepts defined through necessary and sufficient conditions'
                        }
                    },
                    rootConcept: 'The root concept (138875005 |SNOMED CT Concept|) is the ultimate supertype of all SNOMED CT concepts.',
                        topLevelConcepts: [
                            '123037004 |Body structure (body structure)|',
                            '404684003 |Clinical finding (finding)|',
                            '308916002 |Environment or geographical location (environment / location)|',
                            '272379006 |Event (event)|',
                            '363787002 |Observable entity (observable entity)|',
                            '410607006 |Organism (organism)|',
                            '373873005 |Pharmaceutical / biologic product (product)|',
                            '78621006 |Physical force (physical force)|',
                            '260787004 |Physical object (physical object)|',
                            '71388002 |Procedure (procedure)|',
                            '362981000 |Qualifier value (qualifier value)|',
                            '419891008 |Record artifact (record artifact)|',
                            '48176007 |Social context (social context)|',
                            '370115009 |Special concept (special concept)|',
                            '123038009 |Specimen (specimen)|',
                            '254291000 |Staging and scales (staging scale)|',
                            '105590001 |Substance (substance)|'
                        ],
                        attributes: [
                            'Concept attributes define the characteristics and relationships',
                            'Attributes have specific datatypes (concept reference, concrete domain)',
                            'Attribute hierarchy allows for specialization of relationship types',
                            'Domain and range constraints limit valid attribute-value combinations'
                        ],
                        definingCharacteristics: [
                            'Is a relationships define taxonomic hierarchies',
                            'Role relationships define other semantic connections',
                            'Defining relationships create the logical definition',
                            'Necessary and sufficient conditions for concept membership'
                        ],
                        qualifyingCharacteristics: [
                            'Additional information about concepts',
                            'Not part of the logical definition',
                            'Include alternative descriptions and metadata'
                        ]
                    }
                },
                {
                    id: 'authoring-philosophy',
                    title: 'Authoring Philosophy',
                    icon: 'psychology',
                    description: 'Core principles and philosophy of SNOMED CT authoring',
                    content: {
                        overview: 'SNOMED CT authoring follows a systematic philosophy based on description logic, ensuring consistency, precision, and clinical utility across all content domains.',
                        modelingPhilosophy: [
                            'Represent the meaning that is always true about a concept',
                            'Use description logic as the formal foundation',
                            'Model concepts, not instances or specific occurrences',
                            'Focus on clinical relevance and utility',
                            'Maintain consistency across similar concepts'
                        ],
                        advantages: [
                            'Enables automated classification and reasoning',
                            'Supports subsumption testing and query expansion',
                            'Facilitates maintenance and quality assurance',
                            'Provides foundation for clinical decision support',
                            'Ensures semantic consistency across the terminology'
                        ],
                        contentConformance: [
                            'All concepts must conform to established editorial policies',
                            'Non-conforming content is identified and corrected',
                            'Legacy content is gradually updated to current standards',
                            'New content must meet all current modeling requirements'
                        ],
                        scope: [
                            'Focus on healthcare and clinical medicine',
                            'Include concepts with broad international applicability',
                            'Represent classes of things, not specific instances',
                            'Avoid proprietary names unless widely accepted',
                            'Exclude purely administrative or financial concepts'
                        ]
                    }
                },
                {
                    id: 'naming-conventions',
                    title: 'General Naming Conventions',
                    icon: 'text_fields',
                    description: 'Comprehensive guidelines for concept naming',
                    content: {
                        overview: 'SNOMED CT follows strict naming conventions to ensure consistency, clarity, and international applicability across all concept descriptions.',
                        articles: [
                            'Avoid articles (a, an, the) in concept names',
                            'Exception: When the article is part of a proper name',
                            'Use specific terminology rather than generic references'
                        ],
                        abbreviations: [
                            'Spell out abbreviations unless universally recognized',
                            'Acceptable abbreviations: DNA, RNA, HIV, AIDS, etc.',
                            'Medical abbreviations must be internationally understood',
                            'Avoid organization-specific or regional abbreviations'
                        ],
                        eponyms: [
                            'Use eponyms only when widely accepted internationally',
                            'Include both eponymous and descriptive terms when possible',
                            'Prefer descriptive terms over eponyms for new concepts',
                            'Examples: Alzheimer disease, Down syndrome'
                        ],
                        prepositions: [
                            'Use "of" rather than "in" for anatomical locations',
                            'Use "with" for accompanying conditions',
                            'Use "due to" for causal relationships',
                            'Maintain consistency in prepositional usage'
                        ],
                        foundationHierarchies: [
                            'Reference anatomy using precise anatomical terms',
                            'Use substance names from authoritative sources',
                            'Organism names follow taxonomic nomenclature',
                            'Maintain consistency with foundation hierarchies'
                        ],
                        descriptionTypes: [
                            'Fully Specified Name (FSN) - Unique, unambiguous identifier',
                            'Preferred Term (PT) - Common clinical usage term',
                            'Synonym - Alternative acceptable terms',
                            'Definition - Formal textual definition'
                        ],
                        caseSignificance: [
                            'Case insensitive - Most descriptions',
                            'Case sensitive - Proper names, abbreviations',
                            'Initial character case insensitive - Mixed case terms'
                        ],
                        lengthLimitations: [
                            'Fully Specified Names: Maximum 255 characters',
                            'Preferred Terms: Maximum 255 characters',
                            'Synonyms: Maximum 255 characters',
                            'Definitions: Maximum 4096 characters'
                        ]
                    }
                },
                {
                    id: 'general-modeling',
                    title: 'General Modeling Principles',
                    icon: 'architecture',
                    description: 'Core modeling principles and techniques',
                    content: {
                        overview: 'General modeling principles apply across all SNOMED CT hierarchies, providing consistency and logical coherence throughout the terminology.',
                        annotations: [
                            'Use annotations to document modeling decisions',
                            'Provide rationale for complex modeling choices',
                            'Include references to authoritative sources',
                            'Document exceptions and special cases'
                        ],
                        conceptChanges: [
                            'Consider impact on existing concepts when creating new ones',
                            'Ensure new concepts fit appropriately in the hierarchy',
                            'Maintain logical consistency with related concepts',
                            'Document reasons for concept modifications'
                        ],
                        inactivation: [
                            'Use appropriate inactivation indicators',
                            'Provide historical associations when concepts are inactivated',
                            'Document reasons for inactivation',
                            'Ensure no orphaned relationships remain'
                        ],
                        conjunctionDisjunction: [
                            'Avoid "and" in concept names unless representing true conjunction',
                            'Avoid "or" unless representing true disjunction',
                            'Use "and/or" only in specific anatomical contexts',
                            'Model coordinate concepts separately when possible'
                        ],
                        grouperConcepts: [
                            'Create navigational concepts for organization',
                            'Intermediate primitive groupers organize large hierarchies',
                            'Avoid modeling groupers as fully defined',
                            'Use groupers sparingly and purposefully'
                        ],
                        relationshipGroups: [
                            'Group related attributes together logically',
                            'Separate independent sets of relationships',
                            'Maintain consistency within and across groups',
                            'Consider inheritance effects of grouping'
                        ],
                        sufficiencyDefinition: [
                            'Primitive concepts have necessary but not sufficient conditions',
                            'Fully defined concepts have necessary and sufficient conditions',
                            'Use sufficient definition when complete characterization is possible',
                            'Most concepts remain primitive due to incomplete knowledge'
                        ]
                    }
                },
                {
                    id: 'body-structure',
                    title: 'Body Structure Concepts',
                    icon: 'accessibility',
                    description: 'Guidelines for anatomical and body structure concepts',
                    content: {
                        overview: 'Body structure concepts represent normal and abnormal anatomical structures, including organs, tissues, cells, and body spaces. The body structure hierarchy follows the SEP (Structure/Entire/Part) model and includes morphologic abnormalities as a subhierarchy.',
                        
                        definition: {
                            bodyStructure: 'Anatomical or acquired body structure including morphologic abnormalities',
                            morphologicAbnormality: 'Always and necessarily an abnormal anatomical structure',
                            examples: [
                                {
                                    type: 'Body structure',
                                    concept: 'Entire back (body structure)',
                                    id: '450807008',
                                    description: 'Complete anatomical structure of the back'
                                },
                                {
                                    type: 'Morphologic abnormality',
                                    concept: 'Lesion (morphologic abnormality)',
                                    id: '52988006',
                                    description: 'Abnormal tissue change or damage'
                                }
                            ]
                        },
                        
                        anatomicalModel: {
                            description: 'SNOMED CT uses the SEP (Structure/Entire/Part) model to organize anatomical concepts systematically.',
                            components: [
                                'Structure concepts - Any part of an anatomic entity',
                                'Entire concepts - The complete anatomic entity', 
                                'Part concepts - Specific portions or components',
                                'Subdivision concepts - Systematic anatomical divisions'
                            ],
                            principles: [
                                'Hierarchical organization from general to specific',
                                'Multiple inheritance paths for complex structures',
                                'Consistent laterality specification',
                                'Regional and constitutional part relationships'
                            ]
                        },
                        
                        attributesSummary: [
                            'Part of - Hierarchical structural relationships',
                            'Laterality - Left, right, bilateral specifications', 
                            'Constitutional part - Essential structural components',
                            'Regional part - Topographical divisions',
                            'Tributary of - Vascular and lymphatic connections',
                            'Associated morphology - Structural abnormalities'
                        ],
                        
                        definingAttributes: [
                            'Part of: The anatomical structure that contains this structure',
                            'Laterality: Specification of left, right, or bilateral location',
                            'Constitutional part: Essential components of the structure',
                            'Regional part: Topographical or regional divisions',
                            'Tributary of: Vascular or lymphatic drainage relationships'
                        ],
                        
                        namingConventions: [
                            'Use internationally accepted anatomical terminology',
                            'Follow Terminologia Anatomica where applicable',
                            'Use "structure of" prefix for ambiguous terms',
                            'Specify laterality when anatomically relevant',
                            'Use singular forms for anatomical references',
                            'Avoid articles (a, an, the) in concept names',
                            'Use "structure" suffix for clarity when needed'
                        ],
                        
                        modeling: [
                            'Model normal anatomical structures as primitive concepts',
                            'Use part-whole relationships appropriately',
                            'Specify laterality using laterality attribute when relevant',
                            'Include regional and constitutional part relationships',
                            'Model blood vessels and lymphatics with tributary relationships',
                            'Group related attributes logically in relationship groups'
                        ],
                        
                        morphologicAbnormality: [
                            'Represent structural abnormalities and malformations',
                            'Use "Associated morphology" attribute for pathological changes',
                            'Model congenital abnormalities with appropriate timing',
                            'Include severity and extent when clinically relevant',
                            'Distinguish acquired from congenital abnormalities'
                        ],
                        
                        examples: [
                            {
                                concept: 'Structure of heart',
                                id: '80891009',
                                hierarchy: 'Body structure > Anatomical structure > Body system structure > Cardiovascular system structure',
                                attributes: 'Part of: Cardiovascular system structure'
                            },
                            {
                                concept: 'Left ventricle structure', 
                                id: '87878005',
                                hierarchy: 'Body structure > Anatomical structure > Body system structure > Cardiovascular system structure',
                                attributes: 'Part of: Heart structure, Laterality: Left'
                            },
                            {
                                concept: 'Structure of lower lobe of right lung',
                                id: '266005',
                                hierarchy: 'Body structure > Anatomical structure > Body system structure > Respiratory system structure',
                                attributes: 'Part of: Right lung structure, Laterality: Right'
                            }
                        ]
                    }
                },
                {
                    id: 'clinical-finding',
                    title: 'Clinical Finding and Disorder',
                    icon: 'medical_services',
                    description: 'Guidelines for clinical findings, diseases, and symptoms',
                    content: {
                        overview: 'Clinical finding concepts represent observable states of health and disease, including symptoms, signs, diagnoses, and clinical assessments. This is one of the largest and most complex hierarchies in SNOMED CT.',
                        
                        definition: {
                            clinicalFinding: 'Normal/abnormal observations, judgments, or assessments of patients',
                            disorder: 'Always and necessarily an abnormal clinical state',
                            examples: [
                                {
                                    type: 'Clinical finding',
                                    concept: 'Abnormal urinalysis (finding)',
                                    id: '167222005',
                                    description: 'Abnormal laboratory finding from urine analysis'
                                },
                                {
                                    type: 'Disorder',
                                    concept: 'Anaphylaxis (disorder)',
                                    id: '39579001',
                                    description: 'Severe allergic reaction disorder'
                                }
                            ]
                        },
                        
                        observations: 'Clinical findings or observations are the active acquisition of subjective or objective information from a primary source. This includes information acquired from human observers, through recording of data via the use of scientific instruments, or indirectly from samples taken from the source, and evaluated separately.',
                        
                        observableEntityNote: 'The term observations should not be confused with Observable entity. Observable entity is the name of something that can be observed and represents a question or assessment (e.g. systolic blood pressure, color of iris, gender) which can produce an answer or result.',
                        
                        context: {
                            default: 'The default context for a Clinical finding concept is:',
                            elements: [
                                'Present (vs. being absent)',
                                'Subject of the record (the patient)',
                                'Current, if not specifically stated or specified to a time in the past by an entity linked to the concept'
                            ]
                        },
                        
                        hierarchyStructure: {
                            description: 'The Clinical finding hierarchy contains the subhierarchy of Disorder. Concepts that are descendants of Disease (disorder) are always and necessarily abnormal clinical states. The Disease subtype allows diseases to be subtypes of other disorders, as well as subtypes of findings.',
                            rule: 'Concepts with a semantic tag of disorder, must have a parent of Disease (disorder) or subtype of Disease (disorder).',
                            example: {
                                concept: 'Neonatal cyanosis (disorder)',
                                id: '95617006',
                                parent: 'Disease (disorder)',
                                subtype: 'Cyanosis (finding)',
                                id2: '3415004'
                            }
                        },
                        
                        disorderVsFinding: {
                            disorder: {
                                characteristics: [
                                    'Always and necessarily abnormal',
                                    'Necessarily have an underlying pathological process',
                                    'Have temporal persistence (may be under treatment, in remission, or inactive, even though they are still present)',
                                    'May be present as a propensity for certain abnormal states to occur, even when treatment mitigates or resolves those abnormal states'
                                ]
                            },
                            finding: {
                                characteristics: [
                                    'May be normal (but not necessarily)',
                                    'May exist only at a single point in time (e.g. a serum sodium level)',
                                    'Cannot be temporally separate from the observation (one cannot observe them and say they are absent, nor can they be present when they cannot be observed)',
                                    'Cannot be defined only in terms of an underlying pathological process that is present, when the observation itself is not present'
                                ]
                            }
                        },
                        
                        examples: [
                            {
                                scenario: 'Meningococcal meningitis',
                                description: 'In some cases the disease process is irrefutable, e.g. meningococcal meningitis.'
                            },
                            {
                                scenario: 'Nystagmus',
                                description: 'In others an underlying disease process is assumed based on the temporal and causal association of the disorder and its manifestation, e.g. nystagmus (disorder) is different from nystagmus present (finding).',
                                details: [
                                    'Nystagmus present (finding) may be a normal physiological response to head rotation',
                                    'A person who spins around and has nystagmus present (finding), does not have nystagmus (disorder)',
                                    'Alternatively, a person may have nystagmus (disorder), but not nystagmus present (finding), i.e. they do not currently manifest nystagmus'
                                ]
                            },
                            {
                                scenario: 'Hearing loss',
                                description: 'Similarly, hearing loss (disorder) is different from perception of hearing loss (finding), which can be due to a number of temporary causes, such as excessive ear wax.'
                            }
                        ],
                        
                        attributesSummary: [
                            'Finding site - Anatomical location of the finding',
                            'Associated morphology - Structural changes observed',
                            'Causative agent - Infectious or toxic agents',
                            'Clinical course - Acute, chronic, progressive patterns',
                            'Severity - Mild, moderate, severe classifications',
                            'Laterality - Left, right, bilateral specifications',
                            'Pathological process - Underlying pathological mechanism'
                        ],
                        
                        definingAttributes: [
                            'Finding site: The body structure affected by the clinical finding',
                            'Associated morphology: The morphological abnormality present',
                            'Causative agent: The substance or organism causing the finding',
                            'Clinical course: The temporal pattern of the condition',
                            'Severity: The degree or intensity of the condition',
                            'Due to: The underlying cause or predisposing factor'
                        ],
                        

                        
                        namingConventions: [
                            'Use medically accurate and precise terminology',
                            'Prefer internationally recognized terms over regional variants',
                            'Avoid eponyms unless widely accepted',
                            'Include severity qualifiers when clinically significant',
                            'Use present tense for current findings',
                            'Specify acute vs chronic when temporally relevant'
                        ],
                        
                        modeling: [
                            'Focus on the finding itself, not the finding process',
                            'Group related attributes logically',
                            'Model general procedures, not specific instances',
                            'Include method when it creates a distinct procedure',
                            'Use procedure site for anatomical targets'
                        ],
                        
                        specificModeling: [
                            'Infectious diseases: Include causative organism',
                            'Neoplasms: Specify morphology and topography',
                            'Injuries: Include mechanism and anatomical site',
                            'Congenital disorders: Include developmental timing',
                            'Mental health conditions: Follow psychiatric classification'
                        ]
                    }
                },
                {
                    id: 'procedure',
                    title: 'Procedure Concepts',
                    icon: 'healing',
                    description: 'Guidelines for procedures, interventions, and actions',
                    content: {
                        overview: 'Procedure concepts represent intentional acts performed in healthcare contexts, including diagnostic procedures, therapeutic interventions, administrative procedures, and educational activities. This hierarchy also includes regimes/therapies as a subtype.',
                        
                        definition: {
                            procedure: 'Activities performed in the provision of healthcare including medical history-taking, physical examination, diagnostic and therapeutic interventions, training and education, and counseling',
                            regimeTherapy: 'A set of procedures focused on a single purpose on one patient over time (e.g. repeated administration of drug in a small dose for an indefinite period)',
                            examples: [
                                {
                                    type: 'Procedure',
                                    concept: 'Cardiac flow imaging (procedure)',
                                    id: '54321008',
                                    description: 'Diagnostic imaging procedure of cardiac blood flow'
                                },
                                {
                                    type: 'Regime/therapy',
                                    concept: 'Anesthesia management (regime/therapy)',
                                    id: '386513007',
                                    description: 'Comprehensive anesthesia care regimen'
                                }
                            ]
                        },
                        
                        procedureCategories: {
                            description: 'Procedures are organized into major categories based on their primary purpose and method.',
                            types: [
                                'Diagnostic procedures - Tests, examinations, imaging studies',
                                'Therapeutic procedures - Treatments, surgeries, interventions', 
                                'Administrative procedures - Documentation, scheduling, coordination',
                                'Educational procedures - Patient education, counseling, training',
                                'Monitoring procedures - Surveillance, observation, assessment'
                            ],
                            specialConsiderations: [
                                'Focus on the procedure itself, not its outcome',
                                'Model general procedures, not specific instances',
                                'Include method when it creates a distinct procedure',
                                'Consider regime/therapy for ongoing treatments'
                            ]
                        },
                        
                        attributesSummary: [
                            'Method - The approach or technique used',
                            'Procedure site - Anatomical location of the procedure',
                            'Using device - Equipment or instruments employed',
                            'Using substance - Medications or materials used',
                            'Direct substance - Substances directly administered',
                            'Approach - Surgical or procedural approach',
                            'Access - Route of access to the procedure site',
                            'Priority - Urgency or scheduling priority'
                        ],
                        
                        definingAttributes: [
                            'Method: The technique or approach used to perform the procedure',
                            'Procedure site: The anatomical structure that is the target',
                            'Using device: Equipment, instruments, or devices employed',
                            'Using substance: Materials or substances used during the procedure',
                            'Direct substance: Substances administered directly to the patient',
                            'Approach: The surgical or procedural approach taken',
                            'Access: The route used to reach the procedure site',
                            'Direct morphology: Structural changes made during procedure'
                        ],
                        
                        namingConventions: [
                            'Use internationally recognized procedure terminology',
                            'Include method when it distinguishes the procedure',
                            'Specify anatomical site when relevant',
                            'Use active voice and present tense',
                            'Avoid proprietary technique names',
                            'Include laterality when applicable',
                            'Use singular forms for procedure names',
                            'Avoid articles (a, an, the) in procedure names'
                        ],
                        
                        modeling: [
                            'Focus on the procedure itself, not the finding process',
                            'Group related attributes logically in relationship groups',
                            'Model general procedures, not specific instances', 
                            'Include method when it creates a distinct procedure',
                            'Use procedure site for anatomical targets',
                            'Consider direct vs indirect relationships',
                            'Model approach and access when clinically relevant'
                        ],
                        
                        specificModeling: [
                            'Surgical procedures: Include method, approach, and site',
                            'Imaging procedures: Specify imaging modality and target',
                            'Laboratory procedures: Include specimen and method',
                            'Therapeutic procedures: Include substance or device used',
                            'Administrative procedures: Focus on purpose and method'
                        ],
                        
                        examples: [
                            {
                                concept: 'Laparoscopic appendectomy',
                                id: '80146002',
                                hierarchy: 'Procedure > Surgical procedure > Excision',
                                attributes: 'Method: Laparoscopic approach, Procedure site: Appendix structure, Direct morphology: Excision'
                            },
                            {
                                concept: 'Computed tomography of head',
                                id: '303653007',
                                hierarchy: 'Procedure > Imaging procedure > Computed tomography',
                                attributes: 'Method: Computed tomography, Procedure site: Head structure'
                            },
                            {
                                concept: 'Removal of suture',
                                id: '30549001',
                                hierarchy: 'Procedure > Therapeutic procedure > Removal',
                                attributes: 'Method: Manual removal, Using device: Suture removal kit'
                            }
                        ]
                    }
                },
                {
                    id: 'pharmaceutical',
                    title: 'Pharmaceutical & Biologic Products',
                    icon: 'medication',
                    description: 'Comprehensive guidelines for drug and biologic modeling',
                    content: {
                        overview: 'Pharmaceutical content encompasses medications, biologic products, and related substances. This section reflects the consolidation of previously separate pharmaceutical and biologic product guidelines into the unified Editorial Guide. Drug products are distinguished from substances.',
                        
                        definition: {
                            pharmaceuticalProduct: 'Drug products (not Substances) including manufactured pharmaceutical items and clinical drugs',
                            biologicProduct: 'Products derived from living organisms including proteins, vaccines, and cellular therapies',
                            examples: [
                                {
                                    type: 'Pharmaceutical product',
                                    concept: 'Infliximab 100mg/vial powder for reconstitution injection (product)',
                                    id: '400687000',
                                    description: 'Specific manufactured biologic product'
                                },
                                {
                                    type: 'Clinical drug',
                                    concept: 'Product containing only cimetidine 200 mg/1 each oral tablet (clinical drug)',
                                    id: '317222006',
                                    description: 'Generic drug formulation for clinical use'
                                }
                            ]
                        },
                        
                        medicinalProduct: {
                            description: 'Pharmaceutical products are organized by their clinical and manufacturing characteristics.',
                            categories: [
                                'Clinical drug concepts - Specific branded medications',
                                'Medicinal product concepts - Generic drug formulations', 
                                'Product concepts - Manufactured pharmaceutical items',
                                'Medicinal product form concepts - Dose form specifications'
                            ],
                            relationships: [
                                'Products contain substances as active ingredients',
                                'Products have specific dose forms and strengths',
                                'Clinical drugs are realized by specific products',
                                'Medicinal products aggregate clinical drugs by ingredient'
                            ]
                        },
                        
                        attributesSummary: [
                            'Has active ingredient - Principal therapeutic component',
                            'Has dose form - Physical form of administration',
                            'Has concentration strength - Amount of active ingredient',
                            'Has presentation strength - Total amount in dosage unit',
                            'Has manufactured dose form - Specific manufactured form',
                            'Has unit of presentation - Unit of dispensing',
                            'Has basis of strength substance - Reference substance for strength',
                            'Has ingredient - General ingredient (not used in international edition)'
                        ],
                        
                        definingAttributes: [
                            'Has active ingredient: The therapeutically active substance',
                            'Has dose form: The physical form of the pharmaceutical product',
                            'Has concentration strength: The amount of active ingredient per unit',
                            'Has presentation strength: The total amount in the dosage unit',
                            'Has manufactured dose form: The specific form as manufactured',
                            'Has unit of presentation: The unit used for dispensing'
                        ],
                        
                        doseFormCategories: [
                            'Solid dose forms - Tablets, capsules, powders',
                            'Liquid dose forms - Solutions, suspensions, emulsions',
                            'Semi-solid dose forms - Creams, ointments, gels',
                            'Gaseous dose forms - Inhalations, sprays',
                            'Parenteral dose forms - Injections, infusions',
                            'Topical dose forms - Patches, drops, lotions'
                        ],
                        
                        strengthRepresentation: [
                            'Concentration strength - mg/mL, units/mL, percentage',
                            'Presentation strength - mg per tablet, mL per vial',
                            'Activity strength - Units of biological activity',
                            'Equivalent strength - Salt vs base equivalence'
                        ],
                        
                        biologicProducts: [
                            'Model proteins and antibodies with specific structure information',
                            'Include target organism for vaccines and antisera',
                            'Distinguish recombinant from natural products',
                            'Consider immunogenic properties in classification',
                            'Model complex biologics as primitive concepts',
                            'Include manufacturing source when relevant'
                        ],
                        
                        namingConventions: [
                            'Use International Nonproprietary Names (INN) when available',
                            'Include strength and dose form in product names',
                            'Specify route of administration when needed for clarity',
                            'Use systematic names over trade names',
                            'Follow established pharmaceutical naming patterns',
                            'Include concentration for liquid preparations'
                        ],
                        
                        modeling: [
                            'Model products as distinct from substances',
                            'Group related attributes in logical relationship groups',
                            'Include strength information when clinically relevant',
                            'Model dose forms according to pharmaceutical standards',
                            'Consider manufacturing specifications for complex products',
                            'Distinguish between different strengths as separate concepts'
                        ],
                        
                        examples: [
                            {
                                concept: 'Amoxicillin 500mg capsule',
                                id: '27658006',
                                hierarchy: 'Pharmaceutical/biologic product > Medicinal product > Clinical drug',
                                attributes: 'Has active ingredient: Amoxicillin, Has dose form: Capsule, Has concentration strength: 500mg'
                            },
                            {
                                concept: 'Insulin human injection',
                                id: '96367001',
                                hierarchy: 'Pharmaceutical/biologic product > Biologic product',
                                attributes: 'Has active ingredient: Human insulin, Has dose form: Injectable solution'
                            },
                            {
                                concept: 'Product containing only cimetidine 200 mg/1 each oral tablet',
                                id: '317222006',
                                hierarchy: 'Pharmaceutical/biologic product > Medicinal product > Clinical drug',
                                attributes: 'Has active ingredient: Cimetidine, Has dose form: Oral tablet, Has presentation strength: 200mg'
                            }
                        ]
                    }
                },
                {
                    id: 'observable-entity',
                    title: 'Observable Entity',
                    icon: 'analytics',
                    description: 'Guidelines for measurements and observable entities',
                    content: {
                        overview: 'Observable entity concepts represent phenomena that can be observed, measured, or assessed. They provide information about a quality/property to be observed and how it will be observed, focusing on what is being measured rather than the result of the measurement.',
                        
                        definition: {
                            observableEntity: 'Information about a quality/property to be observed and how it will be observed',
                            purpose: 'To support structured data collection and measurement in healthcare contexts',
                            examples: [
                                {
                                    type: 'Observable entity',
                                    concept: 'Age at diagnosis (observable entity)',
                                    id: '423493009',
                                    description: 'The age of a patient when a diagnosis was made'
                                },
                                {
                                    type: 'Observable entity',
                                    concept: 'Concentration of hemoglobin in erythrocyte (observable entity)',
                                    id: '416125006',
                                    description: 'Laboratory measurement of hemoglobin content in red blood cells'
                                }
                            ]
                        },
                        
                        useOfObservables: {
                            description: 'Observable entities support structured data collection and measurement across healthcare contexts.',
                            applications: [
                                'Represent what can be observed or measured',
                                'Used with evaluation procedures to create findings',
                                'Support standardized clinical assessments',
                                'Enable consistent documentation of observations',
                                'Facilitate data analysis and reporting'
                            ],
                            benefits: [
                                'Standardized representation of measurable properties',
                                'Support for structured data entry',
                                'Enable consistent documentation across systems',
                                'Facilitate integration with laboratory systems'
                            ]
                        },
                        
                        vsEvaluationProcedure: {
                            description: 'Observable entities and evaluation procedures serve different but complementary purposes.',
                            distinctions: [
                                'Observable entity: What is being observed',
                                'Evaluation procedure: How the observation is made',
                                'Clinical finding: The result of the observation',
                                'Use observables for the phenomenon, procedures for the method'
                            ],
                            examples: [
                                'Observable entity: "Blood pressure" - the property being measured',
                                'Evaluation procedure: "Taking blood pressure" - the act of measurement'
                            ]
                        },
                        
                        attributesSummary: [
                            'Component - What is being measured',
                            'Property - The property being observed',
                            'Scale type - The type of measurement scale',
                            'Time aspect - When the observation occurs',
                            'System - The system being observed',
                            'Method - The technique used for observation',
                            'Direct site - Anatomical location of observation'
                        ],
                        
                        definingAttributes: [
                            'Component: The substance, entity, or phenomenon being observed',
                            'Property: The specific property or characteristic measured',
                            'Scale type: Quantitative, ordinal, nominal, or narrative',
                            'Time aspect: Point in time, time period, or cumulative',
                            'System: The biological system or specimen type',
                            'Method: The technique used for observation when relevant'
                        ],
                        
                        namingConventions: [
                            'Use "observable" suffix when needed for clarity',
                            'Include the component being measured',
                            'Specify the property when multiple properties exist',
                            'Use LOINC terminology when available',
                            'Avoid procedure-specific terms unless inherent',
                            'Focus on the property being observed, not the method',
                            'Use "of" to connect property to subject or component'
                        ],
                        
                        modeling: [
                            'Focus on the observable property, not the measurement technique',
                            'Include scale type to provide measurement context',
                            'Specify component for complex or multi-part observations',
                            'Model time aspect when clinically relevant to the property',
                            'Consider subject relationship for derived observations',
                            'Group related attributes logically in relationship groups'
                        ],
                        
                        scaleTypes: [
                            'Quantitative - Numerical measurements with meaningful intervals',
                            'Ordinal - Ranked categories with meaningful order',
                            'Nominal - Categories without meaningful order',
                            'Narrative - Free text descriptions',
                            'Document - Reference to external documents'
                        ],
                        
                        examples: [
                            {
                                concept: 'Body temperature',
                                id: '276885007',
                                hierarchy: 'Observable entity > Clinical observation > Vital signs',
                                attributes: 'Component: Body as a whole, Property: Temperature, Scale type: Quantitative'
                            },
                            {
                                concept: 'Serum glucose level',
                                id: '33747003',
                                hierarchy: 'Observable entity > Laboratory observation > Chemistry',
                                attributes: 'Component: Glucose, Property: Concentration, System: Serum, Scale type: Quantitative'
                            },
                            {
                                concept: 'Age at diagnosis',
                                id: '423493009',
                                hierarchy: 'Observable entity > Clinical observation > Administrative property',
                                attributes: 'Property: Age, Scale type: Quantitative, Time aspect: Point in time'
                            }
                        ]
                    }
                },
                {
                    id: 'organism',
                    title: 'Organism Concepts',
                    icon: 'bug_report',
                    description: 'Guidelines for microorganisms and other biological entities',
                    content: {
                        overview: 'Organism concepts include all living organisms relevant to human health, including bacteria, viruses, fungi, parasites, and other microorganisms that may cause disease or be significant in clinical contexts. Organisms of significance to human and animal medicine are used in modeling cause of disease.',
                        
                        definition: {
                            organism: 'Organisms of significance to human and animal medicine; used in modeling cause of disease',
                            scope: 'Includes microorganisms, macroorganisms, and organisms relevant to public health',
                            examples: [
                                {
                                    type: 'Microorganism',
                                    concept: 'Genus Candida (organism)',
                                    id: '3265006',
                                    description: 'Genus of yeasts causing various infections'
                                },
                                {
                                    type: 'Drug-resistant organism',
                                    concept: 'Beta lactam resistant bacteria (organism)',
                                    id: '710877000',
                                    description: 'Bacteria resistant to beta-lactam antibiotics'
                                }
                            ]
                        },
                        
                        organismGroupings: {
                            description: 'Organisms are organized taxonomically with clinical relevance considerations.',
                            categories: [
                                'Bacteria - Follow prokaryotic nomenclature rules',
                                'Viruses - Use ICTV approved names',
                                'Fungi - Follow mycological nomenclature',
                                'Parasites - Use parasitological taxonomic standards'
                            ],
                            clinicalConsiderations: [
                                'Microorganisms generally added to core for human pathogenic potential',
                                'Macroorganisms added when used in public health or human medicine',
                                'Multidrug-resistant organisms separately categorized',
                                'Breeds restricted to veterinary domain'
                            ]
                        },
                        
                        validity: {
                            description: 'Organism concepts must represent valid and current taxonomic entities.',
                            requirements: [
                                'Follow current taxonomic nomenclature',
                                'Update names based on taxonomic revisions',
                                'Maintain historical names as synonyms when appropriate',
                                'Consult authoritative taxonomic databases'
                            ],
                            sources: [
                                'International Code of Nomenclature for algae, fungi, and plants',
                                'International Code of Zoological Nomenclature',
                                'International Code of Nomenclature of Bacteria',
                                'International Committee on Taxonomy of Viruses'
                            ]
                        },
                        
                        organismsWithQualifiers: [
                            'Drug-resistant strains require specific modeling',
                            'Virulence factors may be included when clinically relevant',
                            'Geographic strains may be distinguished when necessary',
                            'Laboratory identification methods may influence naming',
                            'Include biotype when clinically significant',
                            'Model serotypes for epidemiological tracking'
                        ],
                        
                        biotypeSerotype: [
                            'Include biotypes when clinically distinguishable',
                            'Model serotypes as subtypes when immunologically distinct',
                            'Use serogroups for broader immunological classifications',
                            'Distinguish phenotypic from genotypic characteristics',
                            'Include strain information when clinically relevant for treatment',
                            'Distinguish between provisional and confirmed serotype classifications'
                        ],
                        
                        drugResistance: [
                            'Multidrug-resistant (MDR) organisms',
                            'Extensively drug-resistant (XDR) organisms',
                            'Pan drug-resistant (PDR) organisms',
                            'Model resistance patterns when clinically significant',
                            'Include specific resistance mechanisms when relevant'
                        ],
                        
                        namingConventions: [
                            'Use binomial nomenclature for species',
                            'Include author names only when necessary for disambiguation',
                            'Use current accepted names from taxonomic authorities',
                            'Include common names as synonyms when widely used',
                            'Follow International Code of Nomenclature rules',
                            'Avoid taxonomical rank in FSN when defining other concepts',
                            'Use hyphen or parentheses to separate scientific and common names'
                        ],
                        
                        modeling: [
                            'Model according to established taxonomic hierarchies',
                            'Include clinically relevant characteristics as attributes',
                            'Consider drug resistance patterns for bacterial organisms',
                            'Model serotypes and biotypes when epidemiologically important',
                            'Include host specificity when relevant to clinical use',
                            'Group related organisms using appropriate taxonomic relationships'
                        ],
                        
                        specialCategories: [
                            'Multidrug-resistant bacteria - Include resistance patterns',
                            'Extensively drug-resistant bacteria - Specify resistance scope',
                            'Pan drug-resistant bacteria - Complete resistance profile',
                            'X-like organisms - Provisional or similar organisms',
                            'Provisional serotypes - Pending confirmation'
                        ],
                        
                        examples: [
                            {
                                concept: 'Escherichia coli',
                                id: '112283007',
                                hierarchy: 'Organism > Bacteria > Gram-negative bacteria > Enterobacteriaceae',
                                attributes: 'Genus: Escherichia, Species: coli, Gram stain: Negative'
                            },
                            {
                                concept: 'Severe acute respiratory syndrome coronavirus 2',
                                id: '840539006',
                                hierarchy: 'Organism > Virus > RNA virus > Coronaviridae',
                                attributes: 'Type: Virus, Family: Coronaviridae, Nucleic acid: RNA'
                            },
                            {
                                concept: 'Genus Candida',
                                id: '3265006',
                                hierarchy: 'Organism > Fungi > Yeast > Candida',
                                attributes: 'Genus: Candida, Type: Yeast, Clinical significance: Opportunistic pathogen'
                            }
                        ]
                    }
                },
                {
                    id: 'substance',
                    title: 'Substance Concepts',
                    icon: 'science',
                    description: 'Guidelines for chemical substances and materials',
                    content: {
                        overview: 'Substance concepts represent agents, substances, chemicals, drugs, and materials (not Pharmaceutical/Biological Products). They include active pharmaceutical ingredients, chemical entities, biological materials, and environmental substances relevant to healthcare.',
                        
                        definition: {
                            substance: 'Agents, substances, chemicals, drugs, and materials (not Pharmaceutical/Biological Products)',
                            distinction: 'Substances are the chemical entities themselves, while products are manufactured items containing substances',
                            examples: [
                                {
                                    type: 'Chemical substance',
                                    concept: 'Dietary fiber (substance)',
                                    id: '116272000',
                                    description: 'Complex carbohydrate substance with nutritional properties'
                                },
                                {
                                    type: 'Body substance',
                                    concept: 'Digestive system fluid (substance)',
                                    id: '64856004',
                                    description: 'Fluid produced by the digestive system'
                                }
                            ]
                        },
                        
                        substanceCategories: {
                            description: 'Substances are organized by their origin, chemical nature, and clinical use.',
                            categories: [
                                'Chemical substances - Pure chemical entities and compounds',
                                'Biological substances - Proteins, enzymes, hormones, body fluids',
                                'Pharmaceutical ingredients - Active and inactive drug components',
                                'Environmental substances - Allergens, toxins, pollutants',
                                'Body substances - Naturally occurring bodily fluids and materials'
                            ],
                            considerations: [
                                'Substances vs Products distinction is crucial',
                                'Model chemical structure when clinically relevant',
                                'Include biological origin for natural substances',
                                'Consider purity and preparation methods'
                            ]
                        },
                        
                        attributesSummary: [
                            'Is modification of - Base substance modifications',
                            'Has disposition - Physical or chemical properties',
                            'Component of - Larger structures containing the substance',
                            'Plays role - Functional role in biological processes',
                            'Participates in - Chemical reactions or processes',
                            'Has molecular formula - Chemical composition'
                        ],
                        
                        definingAttributes: [
                            'Is modification of: The base substance being modified',
                            'Has disposition: Physical or chemical properties of the substance',
                            'Component of: Larger chemical or biological structures',
                            'Plays role: The functional role in biological or therapeutic processes',
                            'Participates in: Chemical reactions or biological processes'
                        ],
                        
                        generalAssumptions: [
                            'Substances are modeled as primitive concepts when structure is complex',
                            'Chemical purity is assumed unless specified otherwise',
                            'Biological substances may have variable composition',
                            'Environmental substances include both natural and synthetic'
                        ],
                        
                        namingConventions: [
                            'Use International Nonproprietary Names (INN) when available',
                            'Follow IUPAC nomenclature for chemical names',
                            'Include systematic names over trade names',
                            'Use "(substance)" semantic tag for clarity',
                            'Include molecular formulas for simple compounds',
                            'Specify stereochemistry when clinically relevant',
                            'Use common names when widely accepted in medical practice'
                        ],
                        
                        modeling: [
                            'Model pure substances as primitive concepts',
                            'Use appropriate attributes for substance relationships',
                            'Include molecular structure information when relevant',
                            'Specify physical and chemical properties when important',
                            'Group related substances in appropriate hierarchies',
                            'Consider biological origin for natural substances',
                            'Model modifications and derivatives appropriately'
                        ],
                        
                        supportingHierarchy: [
                            'Disposition hierarchy provides qualifiers for substance properties',
                            'Includes physical states, chemical properties, and biological characteristics',
                            'Links to substance concepts via "Has disposition" attribute',
                            'Enables precise specification of substance characteristics'
                        ],
                        
                        examples: [
                            {
                                concept: 'Acetylsalicylic acid',
                                id: '387458008',
                                hierarchy: 'Substance > Chemical substance > Organic compound > Carboxylic acid',
                                attributes: 'Chemical formula: C9H8O4, Has disposition: Analgesic property'
                            },
                            {
                                concept: 'Human insulin',
                                id: '96367001',
                                hierarchy: 'Substance > Biological substance > Protein hormone',
                                attributes: 'Plays role: Hormone, Component of: Pancreatic islet cell'
                            },
                            {
                                concept: 'Dietary fiber',
                                id: '116272000',
                                hierarchy: 'Substance > Chemical substance > Carbohydrate',
                                attributes: 'Plays role: Nutritional supplement, Has disposition: Indigestible'
                            }
                        ]
                    }
                },
                {
                    id: 'situation-context',
                    title: 'Situation with Explicit Context',
                    icon: 'info',
                    description: 'Guidelines for contextual information and situational concepts',
                    content: {
                        overview: 'Situation with explicit context concepts allow representation of clinical information with specific contextual qualifiers. They include context information as a subtype with an attribute associating it with the relevant clinical finding or procedure. May be used to represent conditions/procedures that already occurred, haven\'t yet occurred, or refer to someone else (not patients).',
                        
                        definition: {
                            situationContext: 'Concepts that include context information; a subtype with an attribute associating it with the relevant clinical finding or procedure',
                            purpose: 'To represent conditions/procedures that already occurred, haven\'t yet occurred, or refer to someone else (not patients)',
                            examples: [
                                {
                                    type: 'Historical context',
                                    concept: 'Antenatal care: history of infertility (situation)',
                                    id: '169589005',
                                    description: 'Past history of infertility in the context of antenatal care'
                                },
                                {
                                    type: 'Tolerance context',
                                    concept: 'Angiotensin II receptor antagonist not tolerated (situation)',
                                    id: '407565004',
                                    description: 'Patient intolerance to a specific medication class'
                                }
                            ]
                        },
                        
                        variableMeanings: {
                            description: 'Context is essential for representing clinically relevant information with proper meaning.',
                            considerations: [
                                'Default context assumptions can be overridden using explicit context',
                                'Explicit context prevents misinterpretation of clinical information',
                                'Supports complex clinical scenarios requiring specific context',
                                'Enables precise documentation of clinical state and relationships'
                            ],
                            contextTypes: [
                                'Temporal context - Past, present, future events',
                                'Subject context - Patient, family member, caregiver',
                                'Certainty context - Confirmed, suspected, ruled out',
                                'Procedural context - Before, during, after procedures'
                            ]
                        },
                        
                        attributesSummary: [
                            'Associated finding - The clinical finding in context',
                            'Subject relationship context - Who the finding relates to',
                            'Temporal context - When the finding occurred or will occur',
                            'Finding context - The certainty or status of the finding',
                            'Associated procedure - Related procedural context',
                            'Procedure context - The procedural situation or timing'
                        ],
                        
                        definingAttributes: [
                            'Associated finding: The finding that is being qualified by context',
                            'Subject relationship context: Patient, family member, caregiver, etc.',
                            'Temporal context: Past, present, future timeframe specification',
                            'Finding context: Known present, absent, possible, suspected, etc.',
                            'Associated procedure: Related procedural context when relevant',
                            'Procedure context: Timing or relationship to procedures'
                        ],
                        
                        namingConventions: [
                            'Include context qualifiers clearly in the concept name',
                            'Use standard, established context terminology',
                            'Specify the subject when not referring to the patient',
                            'Include temporal qualifiers when temporally relevant',
                            'Use consistent context patterns across similar concepts',
                            'Follow established templates for common context scenarios',
                            'Use "(situation)" semantic tag for clarity'
                        ],
                        
                        modeling: [
                            'Use appropriate attributes to link to the underlying concept',
                            'Specify context attributes clearly and consistently',
                            'Group related context attributes logically',
                            'Consider inheritance from general context concepts',
                            'Model temporal relationships precisely when relevant',
                            'Ensure context concepts are properly related to base concepts'
                        ],
                        
                        contextCategories: [
                            'Family history - Findings in family members',
                            'Personal history - Past findings or procedures in the patient',
                            'Risk factors - Conditions increasing likelihood of disease',
                            'Absent findings - Explicitly absent clinical findings',
                            'Suspected conditions - Possible but unconfirmed findings',
                            'Contraindications - Situations preventing specific treatments'
                        ],
                        
                        examples: [
                            {
                                concept: 'Family history of diabetes mellitus',
                                id: '160303001',
                                hierarchy: 'Situation with explicit context > Family history',
                                attributes: 'Associated finding: Diabetes mellitus, Subject relationship context: Family member'
                            },
                            {
                                concept: 'Absence of heart murmur',
                                id: '37931006',
                                hierarchy: 'Situation with explicit context > Absent finding',
                                attributes: 'Associated finding: Heart murmur, Finding context: Known absent'
                            },
                            {
                                concept: 'Antenatal care: history of infertility',
                                id: '169589005',
                                hierarchy: 'Situation with explicit context > Medical history',
                                attributes: 'Associated finding: Infertility, Temporal context: Past, Procedure context: Antenatal care'
                            }
                        ]
                    }
                },
                {
                    id: 'specimen',
                    title: 'Specimen Concepts',
                    icon: 'biotech',
                    description: 'Guidelines for laboratory specimens and samples',
                    content: {
                        overview: 'Specimen concepts represent entities that are obtained (usually from patients) for examination or analysis. They are essential for laboratory medicine, diagnostic procedures, and pathological examination.',
                        
                        definition: {
                            specimen: 'Entities that are obtained (usually from patients) for examination or analysis',
                            purpose: 'To represent biological materials collected for laboratory testing and diagnostic procedures',
                            examples: [
                                {
                                    type: 'Complex specimen',
                                    concept: 'Lymph node from sentinel lymph node dissection (specimen)',
                                    id: '373193000',
                                    description: 'Specific lymph node specimen obtained through surgical procedure'
                                },
                                {
                                    type: 'Body fluid specimen',
                                    concept: 'Exudate sample (specimen)',
                                    id: '258441009',
                                    description: 'Fluid specimen from inflammatory process'
                                }
                            ]
                        },
                        
                        specimenNotSample: {
                            description: 'Important terminology distinction between specimen and sample concepts.',
                            guidelines: [
                                'Use "specimen" rather than "sample" in FSNs',
                                'Specimen refers to the biological material collected',
                                'Sample refers to the portion used for testing',
                                'Maintain consistency in terminology usage across all concepts'
                            ],
                            rationale: [
                                'Specimen is the material as collected from the patient',
                                'Sample may refer to aliquots or portions for testing',
                                'Standardization improves clinical communication',
                                'Follows established laboratory medicine conventions'
                            ]
                        },
                        
                        combinedSpecimens: {
                            description: 'Special considerations for specimens combining multiple sources or types.',
                            types: [
                                'Pooled specimens - Combine multiple sources of the same type',
                                'Combined specimens - Mix different specimen types',
                                'Composite specimens - Multiple components from same source'
                            ],
                            modeling: [
                                'Model appropriately based on collection method',
                                'Include source information when relevant',
                                'Specify combining process when clinically significant',
                                'Consider individual vs pooled identification needs'
                            ]
                        },
                        
                        attributesSummary: [
                            'Specimen source morphology - Anatomical origin',
                            'Specimen source topography - Specific anatomical location',
                            'Specimen procedure - Collection method or procedure',
                            'Specimen substance - The substance being collected',
                            'Collection method - Technique used for obtaining specimen',
                            'Processing - Post-collection handling or preparation'
                        ],
                        
                        definingAttributes: [
                            'Specimen source morphology: The anatomical structure from which collected',
                            'Specimen source topography: The specific anatomical site',
                            'Specimen procedure: The method or procedure used for collection',
                            'Specimen substance: The material or substance being collected'
                        ],
                        
                        namingConventions: [
                            'Use "specimen" in FSN rather than "sample"',
                            'Include anatomical source when specific and relevant',
                            'Specify collection method when it affects specimen nature',
                            'Use standardized anatomical terminology',
                            'Include processing state when clinically significant',
                            'Follow consistent patterns for similar specimen types'
                        ],
                        
                        modeling: [
                            'Include anatomical source when specific and clinically relevant',
                            'Specify collection method when it affects specimen characteristics',
                            'Model processing states when clinically significant',
                            'Include timing information for time-sensitive specimens',
                            'Group related attributes logically in relationship groups',
                            'Consider specimen preparation and handling requirements'
                        ],
                        
                        specimenTypes: [
                            'Biological specimens - Body fluids, tissues, cellular material',
                            'Tissue specimens - Biopsy, surgical, autopsy specimens',
                            'Fluid specimens - Blood, urine, CSF, synovial fluid',
                            'Cellular specimens - Cytology, cell cultures',
                            'Microbiological specimens - For culture and identification'
                        ],
                        
                        examples: [
                            {
                                concept: 'Blood specimen',
                                id: '119297000',
                                hierarchy: 'Specimen > Biological specimen > Body fluid specimen',
                                attributes: 'Specimen substance: Blood, Specimen source topography: Vascular system'
                            },
                            {
                                concept: 'Urine specimen',
                                id: '122575003',
                                hierarchy: 'Specimen > Biological specimen > Body fluid specimen',
                                attributes: 'Specimen substance: Urine, Specimen source topography: Urinary system'
                            },
                            {
                                concept: 'Lymph node from sentinel lymph node dissection',
                                id: '373193000',
                                hierarchy: 'Specimen > Biological specimen > Tissue specimen',
                                attributes: 'Specimen source morphology: Lymph node, Specimen procedure: Sentinel lymph node dissection'
                            }
                        ]
                    }
                },
                {
                    id: 'quality-assurance',
                    title: 'Quality Assurance',
                    icon: 'verified',
                    description: 'QA processes and validation rules',
                    content: {
                        overview: 'Quality assurance ensures consistency, accuracy, and completeness of SNOMED CT content through systematic validation and review processes.',
                        validationLevels: [
                            'Syntactic validation - Structural and format compliance',
                            'Semantic validation - Logical consistency checks',
                            'Pragmatic validation - Clinical utility assessment',
                            'Community validation - Expert and user review'
                        ],
                        automatedValidation: [
                            'Unique FSNs within semantic tags',
                            'Proper hierarchical relationships',
                            'Appropriate semantic tags',
                            'Valid relationship cardinalities',
                            'Cycle detection in hierarchies',
                            'Orphaned concept identification',
                            'Description length validation',
                            'Character encoding compliance'
                        ],
                        editorialReview: [
                            'Clinical expert validation',
                            'Multi-stage review processes',
                            'Cross-domain consistency checks',
                            'International harmonization review',
                            'Community feedback integration',
                            'Post-publication monitoring'
                        ],
                        qualityMetrics: [
                            'Content coverage assessments',
                            'Concept reuse and redundancy analysis',
                            'Relationship density and completeness',
                            'Description quality and consistency',
                            'User feedback integration metrics',
                            'Error detection and correction rates'
                        ]
                    }
                },
                {
                    id: 'release-management',
                    title: 'Release Management',
                    icon: 'update',
                    description: 'Version control and release processes',
                    content: {
                        overview: 'SNOMED CT follows a structured release cycle with regular updates, version management, and comprehensive change tracking to ensure stability and continuity.',
                        releaseSchedule: [
                            'Monthly international releases - Regular content updates',
                            'Biannual major releases - Significant enhancements',
                            'Emergency patches - Critical error corrections',
                            'National edition releases - Country-specific content',
                            'Extension releases - Specialized domain content'
                        ],
                        versioningPrinciples: [
                            'Permanent concept identifiers - IDs never reused',
                            'Backward compatibility - Previous versions remain valid',
                            'Incremental changes - Building on previous releases',
                            'Component versioning - Individual component tracking',
                            'Effective time stamps - Precise change timing'
                        ],
                        changeManagement: [
                            'New concept addition - Fresh clinical content',
                            'Concept inactivation - Marking outdated concepts',
                            'Relationship changes - Modified semantic connections',
                            'Description updates - Term refinements and additions',
                            'Reference set modifications - Collection updates'
                        ],
                        releasePackaging: [
                            'Snapshot files - Current active content',
                            'Delta files - Changes since previous release',
                            'Full files - Complete historical content',
                            'Documentation - Release notes and change summaries',
                            'Validation reports - Quality assurance results'
                        ],
                        versionHistory: [
                            { 
                                version: '2025-01-08', 
                                changes: 'Latest editorial guide with consolidated pharmaceutical guidelines, enhanced quality assurance processes, and expanded implementation guidance',
                                significance: 'Updated pharmaceutical modeling following guide consolidation'
                            },
                            { 
                                version: '2024-01-02', 
                                changes: 'Enhanced relationship modeling guidance, improved compositional grammar examples, and expanded organism concepts',
                                significance: 'Major enhancement to semantic modeling capabilities'
                            },
                            { 
                                version: '2023-01-31', 
                                changes: 'Merged pharmaceutical dose form and biologic product guides into unified framework',
                                significance: 'Significant structural reorganization and content consolidation'
                            }
                        ]
                    }
                }
            ],
            currentSection: 'introduction',
            searchResults: []
        };

        // Concept ID to section mapping for cross-references
        const conceptMap = {
            '138875005': 'concept-model',
            '123037004': 'body-structure',
            '404684003': 'clinical-finding',
            '71388002': 'procedure',
            '373873005': 'pharmaceutical',
            '363787002': 'observable-entity',
            '410607006': 'organism',
            '105590001': 'substance',
            '48176007': 'situation-context',
            '123038009': 'specimen',
            '57054005': 'clinical-finding',
            '80146002': 'procedure',
            '27658006': 'pharmaceutical',
            '96367001': 'pharmaceutical',
            '112283007': 'organism',
            '840539006': 'organism'
        };

        // SNOMED CT Release Statistics (July 2025)
        const snomedStats = {
            totalActive: 374846,
            totalConcepts: 524399,
            hierarchies: [
                { id: '123037004', name: 'Body structure', active: 42775, total: 47968, new: 29, changed: 0, inactivated: 6 },
                { id: '404684003', name: 'Clinical finding', active: 126809, total: 184236, new: 656, changed: 39, inactivated: 41 },
                { id: '308916002', name: 'Environment or geographical location', active: 1876, total: 2117, new: 1, changed: 0, inactivated: 0 },
                { id: '272379006', name: 'Event', active: 3315, total: 8519, new: 1, changed: 0, inactivated: 0 },
                { id: '363787002', name: 'Observable entity', active: 10950, total: 12235, new: 6, changed: 0, inactivated: 2 },
                { id: '410607006', name: 'Organism', active: 34495, total: 41880, new: 48, changed: 0, inactivated: 2 },
                { id: '373873005', name: 'Pharmaceutical / biologic product', active: 25695, total: 43316, new: 3, changed: 0, inactivated: 9 },
                { id: '78621006', name: 'Physical force', active: 172, total: 182, new: 0, changed: 0, inactivated: 0 },
                { id: '260787004', name: 'Physical object', active: 14006, total: 17810, new: 10, changed: 0, inactivated: 0 },
                { id: '71388002', name: 'Procedure', active: 59650, total: 90916, new: 94, changed: 34, inactivated: 45 },
                { id: '362981000', name: 'Qualifier value', active: 12191, total: 15018, new: 18, changed: 1, inactivated: 0 },
                { id: '419891008', name: 'Record artifact', active: 520, total: 702, new: 0, changed: 0, inactivated: 0 },
                { id: '138875005', name: 'SNOMED CT Concept', active: 1, total: 9, new: 0, changed: 0, inactivated: 0 },
                { id: '900000000000441003', name: 'SNOMED CT Model Component', active: 1900, total: 1964, new: 2, changed: 0, inactivated: 0 },
                { id: '243796009', name: 'Situation with explicit context', active: 5053, total: 11828, new: 2, changed: 0, inactivated: 1 },
                { id: '48176007', name: 'Social context', active: 4180, total: 7996, new: 2, changed: 0, inactivated: 1 },
                { id: '370115009', name: 'Special concept', active: 2, total: 1965, new: 0, changed: 0, inactivated: 616 },
                { id: '123038009', name: 'Specimen', active: 1823, total: 1972, new: 2, changed: 0, inactivated: 1 },
                { id: '254291000', name: 'Staging and scales', active: 1665, total: 1911, new: 2, changed: 0, inactivated: 0 },
                { id: '105590001', name: 'Substance', active: 27768, total: 31650, new: 21, changed: 0, inactivated: 0 }
            ],
            summary: {
                totalNew: 897,
                totalChanged: 74,
                totalInactivated: 724,
                totalReactivated: 1,
                newSD: 634,
                newP: 263
            }
        };

        // Cross-reference data
        const crossReferences = {
            'introduction': ['concept-model', 'authoring-philosophy'],
            'concept-model': ['body-structure', 'clinical-finding', 'procedure'],
            'clinical-finding': ['body-structure', 'organism', 'procedure'],
            'procedure': ['clinical-finding', 'body-structure', 'pharmaceutical'],
            'pharmaceutical': ['substance', 'clinical-finding'],
            'body-structure': ['clinical-finding', 'procedure'],
            'organism': ['clinical-finding', 'substance'],
            'substance': ['pharmaceutical', 'organism'],
            'situation-context': ['clinical-finding', 'procedure'],
            'specimen': ['observable-entity', 'substance']
        };

        // Application state and methods
        const app = {
            currentCollapsedSections: new Set(),
            
            init() {
                this.renderSidebar();
                this.renderContent();
                this.setupEventListeners();
                this.setupQuickNav();
                this.setupProgressBar();
                this.setupKeyboardShortcuts();
                
                // Ensure quick nav is working
                console.log('Quick navigation initialized with', guideData.sections.length, 'sections');
            },

            renderSidebar() {
                const sidebar = document.getElementById('sidebar');
                const sectionsHTML = guideData.sections.map(section => `
                    <li class="cursor-pointer p-3 rounded-lg transition-colors hover:bg-blue-50 section-item ${guideData.currentSection === section.id ? 'bg-blue-100' : ''}" 
                        data-section="${section.id}">
                        <div class="flex items-center space-x-3">
                            <span class="material-icons text-blue-600">${section.icon}</span>
                            <div>
                                <div class="font-medium text-gray-800">${section.title}</div>
                                <div class="text-sm text-gray-500">${section.description}</div>
                            </div>
                        </div>
                    </li>
                `).join('');

                sidebar.innerHTML = `
                    <nav class="sidebar-nav bg-white rounded-lg shadow-md p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Guide Sections</h3>
                        <ul class="space-y-2">
                            ${sectionsHTML}
                        </ul>
                        
                        <div class="mt-8 p-4 bg-gray-50 rounded-lg">
                            <h4 class="font-semibold text-gray-800 mb-2">Quick Links</h4>
                            <ul class="space-y-2 text-sm">
                                <li><a href="https://confluence.ihtsdotools.org/display/DOCEG/PDFs+for+Download" 
                                      target="_blank" 
                                      class="text-blue-600 hover:underline flex items-center">
                                    <span class="material-icons text-sm mr-1">download</span>
                                    PDF Downloads
                                </a></li>
                                <li><a href="#" class="text-blue-600 hover:underline flex items-center">
                                    <span class="material-icons text-sm mr-1">help</span>
                                    Help & Support
                                </a></li>
                            </ul>
                        </div>
                    </nav>
                `;
            },

            renderContent() {
                const content = document.getElementById('content');
                
                if (guideData.searchResults.length > 0) {
                    this.renderSearchResults();
                    return;
                }

                const section = guideData.sections.find(s => s.id === guideData.currentSection);
                if (!section) return;

<<<<<<< Updated upstream

=======
                // If the section is backed by a Markdown file, load and render it dynamically
                if (section.mdFile) {
                    fetch(section.mdFile)
                        .then(res => res.text())
                        .then(md => {
                            let html = marked.parse(md);
                            // Prefix relative image URLs so they resolve correctly from root page
                            html = html.replace(/src="images\//g, 'src="output/images/');
                            
                            // Apply consistent styling to match the rest of the application
                            const styledContent = this.applyMarkdownStyling(html, section);
                            content.innerHTML = styledContent;
                            
                            // Refresh quick navigation highlighting for the new content
                            this.setupQuickNav();
                        })
                        .catch(err => {
                            console.error('Error loading markdown file', section.mdFile, err);
                            content.innerHTML = `<p class="text-red-600">Failed to load content.</p>`;
                        });
                    return;
                }
>>>>>>> Stashed changes

                // Render various content types dynamically
                const renderContentList = (items, title, icon = 'check_circle', bgColor = 'bg-blue-50') => {
                    if (!items) return '';
                    
                    // Handle case where items is not an array
                    if (!Array.isArray(items)) {
                        // Fall back to renderContentCards for non-arrays
                        return renderContentCards(items, title, bgColor, 'border-green-400');
                    }
                    
                    return `
                        <div class="mb-8">
                            <h3 class="text-xl font-semibold text-gray-800 mb-4">${title}</h3>
                            <ul class="space-y-2">
                                ${items.map(item => `
                                    <li class="flex items-start space-x-2">
                                        <span class="material-icons text-green-600 text-sm mt-1">${icon}</span>
                                        <span class="text-gray-700">${item}</span>
                                    </li>
                                `).join('')}
                            </ul>
                        </div>
                    `;
                };

                                const renderContentCards = (items, title, bgColor = 'bg-blue-50', borderColor = 'border-blue-400') => {
                    if (!items) return '';
                    
                    // Handle case where items is not an array
                    if (!Array.isArray(items)) {
                        // If it's an object, render each property
                        if (typeof items === 'object') {
                            const renderValue = (value, key) => {
                                if (Array.isArray(value)) {
                                    // Handle arrays of objects (like examples)
                                    if (value.length > 0 && typeof value[0] === 'object') {
                                        return value.map(item => {
                                            if (item.type && item.concept) {
                                                // Enhanced section example format
                                                return `<div class="ml-4 mb-2 p-3 bg-gray-50 rounded">
                                                    <div class="font-medium text-gray-800">${item.type}: ${item.concept}</div>
                                                    ${item.id ? `<div class="text-sm text-gray-600">ID: ${item.id}</div>` : ''}
                                                    ${item.description ? `<div class="text-sm text-gray-700 mt-1">${item.description}</div>` : ''}
                                                </div>`;
                                            } else {
                                                // General object format
                                                return `<div class="ml-4 mb-2 p-2 bg-gray-50 rounded">${JSON.stringify(item, null, 2).replace(/[{}",]/g, '').trim()}</div>`;
                                            }
                                        }).join('');
                                    } else {
                                        // Array of strings
                                        return `<ul class="list-disc list-inside mt-1 ml-4">${value.map(item => `<li>${typeof item === 'string' ? item : JSON.stringify(item)}</li>`).join('')}</ul>`;
                                    }
                                } else if (typeof value === 'object' && value !== null) {
                                    // Nested object - render recursively
                                    return Object.entries(value).map(([k, v]) => {
                                        const formattedSubKey = k.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase());
                                        return `<div class="ml-4 mb-2"><span class="font-medium">${formattedSubKey}:</span> ${renderValue(v, k)}</div>`;
                                    }).join('');
                                } else {
                                    return typeof value === 'string' ? value : JSON.stringify(value);
                                }
                            };
                            
                            const objectContent = Object.entries(items).map(([key, value]) => {
                                const formattedKey = key.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase());
                                return `<div class="mb-3"><strong>${formattedKey}:</strong><div class="mt-1">${renderValue(value, key)}</div></div>`;
                            }).join('');
                            
                            return `
                                <div class="mb-8">
                                    <h3 class="text-xl font-semibold text-gray-800 mb-4">${title}</h3>
                                    <div class="concept-card ${bgColor} p-4 rounded-lg border-l-4 ${borderColor}">
                                        <div class="text-gray-700">${objectContent}</div>
                                    </div>
                                </div>
                            `;
                        }
                        // If it's a string, render as single item
                        return `
                            <div class="mb-8">
                                <h3 class="text-xl font-semibold text-gray-800 mb-4">${title}</h3>
                                <div class="concept-card ${bgColor} p-4 rounded-lg border-l-4 ${borderColor}">
                                    <p class="text-gray-700">${items}</p>
                                </div>
                            </div>
                        `;
                    }
                    
                    return `
                        <div class="mb-8">
                            <h3 class="text-xl font-semibold text-gray-800 mb-4">${title}</h3>
                            <div class="grid gap-4">
                                ${items.map(item => `
                                    <div class="concept-card ${bgColor} p-4 rounded-lg border-l-4 ${borderColor}">
                                        <p class="text-gray-700">${item}</p>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                };

                const principlesHTML = renderContentList(section.content.keyPrinciples, 'Key Principles');

                // Generate content sections dynamically
                const contentSections = [];

                // Core content sections with flexible rendering  
                const contentMappings = [
                    { key: 'whatIsSNOMEDCT', title: 'What is SNOMED CT?', type: 'list' },
                    { key: 'whyUseSNOMEDCT', title: 'Why Use SNOMED CT?', type: 'list' },
                    { key: 'intendedUse', title: 'Intended Use', type: 'list' },
                    { key: 'domains', title: 'SNOMED CT Domains', type: 'cards', bg: 'bg-blue-50', border: 'border-blue-400' },
                    { key: 'requirements', title: 'SNOMED CT Requirements', type: 'cards', bg: 'bg-purple-50', border: 'border-purple-400' },
                    { key: 'rootConcept', title: 'Root Concept', type: 'special' },
                    { key: 'topLevelConcepts', title: 'Top-level Concepts', type: 'cards', bg: 'bg-indigo-50', border: 'border-indigo-400' },
                    { key: 'attributes', title: 'Attributes', type: 'list' },
                    { key: 'definingCharacteristics', title: 'Defining Characteristics', type: 'list' },
                    { key: 'qualifyingCharacteristics', title: 'Qualifying Characteristics', type: 'list' },
                    { key: 'modelingPhilosophy', title: 'Modeling Philosophy', type: 'cards', bg: 'bg-green-50', border: 'border-green-400' },
                    { key: 'advantages', title: 'Advantages', type: 'list' },
                    { key: 'contentConformance', title: 'Content Conformance', type: 'list' },
                    { key: 'scope', title: 'Scope', type: 'list' },
                    { key: 'articles', title: 'Articles', type: 'list' },
                    { key: 'abbreviations', title: 'Abbreviations', type: 'cards', bg: 'bg-yellow-50', border: 'border-yellow-400' },
                    { key: 'eponyms', title: 'Eponyms', type: 'cards', bg: 'bg-orange-50', border: 'border-orange-400' },
                    { key: 'prepositions', title: 'Prepositions', type: 'list' },
                    { key: 'foundationHierarchies', title: 'Foundation Hierarchies', type: 'list' },
                    { key: 'descriptionTypes', title: 'Description Types', type: 'cards', bg: 'bg-rose-50', border: 'border-rose-400' },
                    { key: 'caseSignificance', title: 'Case Significance', type: 'list' },
                    { key: 'lengthLimitations', title: 'Length Limitations', type: 'cards', bg: 'bg-gray-50', border: 'border-gray-400' },
                    { key: 'annotations', title: 'Annotations', type: 'list' },
                    { key: 'conceptChanges', title: 'Concept Changes', type: 'list' },
                    { key: 'inactivation', title: 'Inactivation', type: 'cards', bg: 'bg-red-50', border: 'border-red-400' },
                    { key: 'conjunctionDisjunction', title: 'Conjunction and Disjunction', type: 'cards', bg: 'bg-amber-50', border: 'border-amber-400' },
                    { key: 'grouperConcepts', title: 'Grouper Concepts', type: 'list' },
                    { key: 'relationshipGroups', title: 'Relationship Groups', type: 'list' },
                    { key: 'sufficiencyDefinition', title: 'Sufficiency Definition', type: 'cards', bg: 'bg-lime-50', border: 'border-lime-400' },
                    { key: 'attributesSummary', title: 'Attributes Summary', type: 'cards', bg: 'bg-teal-50', border: 'border-teal-400' },
                    { key: 'anatomicalModel', title: 'Anatomical Model', type: 'cards', bg: 'bg-cyan-50', border: 'border-cyan-400' },
                    { key: 'morphologicAbnormality', title: 'Morphologic Abnormality', type: 'list' },
                    { key: 'definingAttributes', title: 'Defining Attributes', type: 'cards', bg: 'bg-emerald-50', border: 'border-emerald-400' },
                    { key: 'specificModeling', title: 'Specific Modeling', type: 'cards', bg: 'bg-violet-50', border: 'border-violet-400' },
                    { key: 'procedureCategories', title: 'Procedure Categories', type: 'list' },
                    { key: 'medicinalProduct', title: 'Medicinal Product', type: 'list' },
                    { key: 'doseFormCategories', title: 'Dose Form Categories', type: 'list' },
                    { key: 'strengthRepresentation', title: 'Strength Representation', type: 'list' },
                    { key: 'biologicProducts', title: 'Biologic Products', type: 'cards', bg: 'bg-pink-50', border: 'border-pink-400' },
                    { key: 'qualifierValues', title: 'Qualifier Values', type: 'list' },
                    { key: 'useOfObservables', title: 'Use of Observables', type: 'list' },
                    { key: 'vsEvaluationProcedure', title: 'vs Evaluation Procedure', type: 'cards', bg: 'bg-slate-50', border: 'border-slate-400' },
                    { key: 'organismsWithQualifiers', title: 'Organisms with Qualifiers', type: 'list' },
                    { key: 'validity', title: 'Validity', type: 'list' },
                    { key: 'organismGroupings', title: 'Organism Groupings', type: 'cards', bg: 'bg-green-50', border: 'border-green-400' },
                    { key: 'biotypeSerotype', title: 'Biotype and Serotype', type: 'list' },
                    { key: 'drugResistance', title: 'Drug Resistance', type: 'cards', bg: 'bg-red-50', border: 'border-red-400' },
                    { key: 'substanceCategories', title: 'Substance Categories', type: 'list' },
                    { key: 'variableMeanings', title: 'Variable Meanings', type: 'list' },
                    { key: 'specimenNotSample', title: 'Specimen vs Sample', type: 'cards', bg: 'bg-blue-50', border: 'border-blue-400' },
                    { key: 'combinedSpecimens', title: 'Combined Specimens', type: 'list' },
                    { key: 'validationLevels', title: 'Validation Levels', type: 'cards', bg: 'bg-red-50', border: 'border-red-400' },
                    { key: 'automatedValidation', title: 'Automated Validation', type: 'list' },
                    { key: 'editorialReview', title: 'Editorial Review', type: 'list' },
                    { key: 'qualityMetrics', title: 'Quality Metrics', type: 'list' },
                    { key: 'releaseSchedule', title: 'Release Schedule', type: 'list' },
                    { key: 'versioningPrinciples', title: 'Versioning Principles', type: 'cards', bg: 'bg-emerald-50', border: 'border-emerald-400' },
                    { key: 'changeManagement', title: 'Change Management', type: 'list' },
                    { key: 'releasePackaging', title: 'Release Packaging', type: 'list' },
                    { key: 'keyPrinciples', title: 'Key Principles', type: 'list' },
                    { key: 'corePrinciples', title: 'Core Principles', type: 'list' },
                    { key: 'benefits', title: 'Benefits', type: 'list' },
                    { key: 'componentTypes', title: 'Component Types', type: 'cards', bg: 'bg-indigo-50', border: 'border-indigo-400' },
                    { key: 'hierarchyStructure', title: 'Hierarchy Structure', type: 'cards', bg: 'bg-purple-50', border: 'border-purple-400' },
                    { key: 'relationshipTypes', title: 'Relationship Types', type: 'cards', bg: 'bg-green-50', border: 'border-green-400' },
                    { key: 'modelingPrinciples', title: 'Modeling Principles', type: 'cards' },
                    { key: 'guidelines', title: 'Editorial Guidelines', type: 'cards' },
                    { key: 'namingConventions', title: 'Naming Conventions', type: 'cards', bg: 'bg-yellow-50', border: 'border-yellow-400' },
                    { key: 'definingAttributes', title: 'Defining Attributes', type: 'cards', bg: 'bg-teal-50', border: 'border-teal-400' },
                    { key: 'procedureCategories', title: 'Procedure Categories', type: 'list' },
                    { key: 'structureTypes', title: 'Structure Types', type: 'list' },
                    { key: 'productTypes', title: 'Product Types', type: 'list' },
                    { key: 'doseFormCategories', title: 'Dose Form Categories', type: 'list' },
                    { key: 'doseforms', title: 'Common Dose Forms', type: 'grid' },
                    { key: 'modelingAttributes', title: 'Modeling Attributes', type: 'cards', bg: 'bg-pink-50', border: 'border-pink-400' },
                    { key: 'strengthRepresentation', title: 'Strength Representation', type: 'list' },
                    { key: 'biologicSpecifics', title: 'Biologic Specifics', type: 'cards', bg: 'bg-cyan-50', border: 'border-cyan-400' },
                    { key: 'specialCases', title: 'Special Cases', type: 'cards', bg: 'bg-orange-50', border: 'border-orange-400' },
                    { key: 'governanceStructure', title: 'Governance Structure', type: 'list' },
                    { key: 'qualityAssurance', title: 'Quality Assurance', type: 'list' },
                    { key: 'versionControl', title: 'Version Control', type: 'list' },
                    { key: 'laterality', title: 'Laterality Guidelines', type: 'cards', bg: 'bg-emerald-50', border: 'border-emerald-400' },
                    { key: 'taxonomicPrinciples', title: 'Taxonomic Principles', type: 'list' },
                    { key: 'organismCategories', title: 'Organism Categories', type: 'list' },
                    { key: 'relationshipCategories', title: 'Relationship Categories', type: 'list' },
                    { key: 'coreRelationships', title: 'Core Relationships', type: 'cards', bg: 'bg-violet-50', border: 'border-violet-400' },
                    { key: 'modelingRules', title: 'Modeling Rules', type: 'cards' },
                    { key: 'refinement', title: 'Refinement Techniques', type: 'cards', bg: 'bg-lime-50', border: 'border-lime-400' },
                    { key: 'bestPractices', title: 'Best Practices', type: 'practices' },
                    { key: 'modeling', title: 'Best Practices', type: 'practices' },
                    { key: 'descriptionTypes', title: 'Description Types', type: 'cards', bg: 'bg-rose-50', border: 'border-rose-400' },
                    { key: 'fsnGuidelines', title: 'FSN Guidelines', type: 'cards' },
                    { key: 'semanticTags', title: 'Semantic Tags', type: 'list' },
                    { key: 'languageSupport', title: 'Language Support', type: 'list' },
                    { key: 'referenceSetTypes', title: 'Reference Set Types', type: 'cards', bg: 'bg-slate-50', border: 'border-slate-400' },
                    { key: 'languageReferenceSets', title: 'Language Reference Sets', type: 'list' },
                    { key: 'mappingReferenceSets', title: 'Mapping Reference Sets', type: 'list' },
                    { key: 'validationLevels', title: 'Validation Levels', type: 'cards', bg: 'bg-red-50', border: 'border-red-400' },
                    { key: 'automatedValidation', title: 'Automated Validation', type: 'list' },
                    { key: 'editorialReview', title: 'Editorial Review', type: 'list' },
                    { key: 'qualityMetrics', title: 'Quality Metrics', type: 'list' },
                    { key: 'continuousImprovement', title: 'Continuous Improvement', type: 'list' },
                    { key: 'expressionStructure', title: 'Expression Structure', type: 'cards', bg: 'bg-amber-50', border: 'border-amber-400' },
                    { key: 'syntaxElements', title: 'Syntax Elements', type: 'cards', bg: 'bg-gray-50', border: 'border-gray-400' },
                    { key: 'commonPatterns', title: 'Common Patterns', type: 'list' },
                    { key: 'implementationPhases', title: 'Implementation Phases', type: 'cards', bg: 'bg-sky-50', border: 'border-sky-400' },
                    { key: 'technicalConsiderations', title: 'Technical Considerations', type: 'list' },
                    { key: 'clinicalConsiderations', title: 'Clinical Considerations', type: 'list' },
                    { key: 'maintenanceRequirements', title: 'Maintenance Requirements', type: 'list' },
                    { key: 'releaseSchedule', title: 'Release Schedule', type: 'list' },
                    { key: 'versioningPrinciples', title: 'Versioning Principles', type: 'cards', bg: 'bg-emerald-50', border: 'border-emerald-400' },
                    { key: 'changeManagement', title: 'Change Management', type: 'list' },
                    { key: 'releasePackaging', title: 'Release Packaging', type: 'list' },
                    { key: 'migrationSupport', title: 'Migration Support', type: 'list' }
                ];

                contentMappings.forEach(mapping => {
                    const content = section.content[mapping.key];
                    if (content) {
                        switch (mapping.type) {
                            case 'list':
                                contentSections.push(renderContentList(content, mapping.title));
                                break;
                            case 'cards':
                                contentSections.push(renderContentCards(content, mapping.title, mapping.bg, mapping.border));
                                break;
                            case 'grid':
                                if (Array.isArray(content)) {
                                    contentSections.push(`
                                        <div class="mb-8">
                                            <h3 class="text-xl font-semibold text-gray-800 mb-4">${mapping.title}</h3>
                                            <div class="grid md:grid-cols-2 gap-3">
                                                ${content.map(item => `
                                                    <div class="bg-purple-50 p-3 rounded-lg">
                                                        <span class="text-gray-700">${item}</span>
                                                    </div>
                                                `).join('')}
                                            </div>
                                        </div>
                                    `);
                                } else {
                                    // Fall back to cards rendering for non-arrays
                                    contentSections.push(renderContentCards(content, mapping.title, 'bg-purple-50', 'border-purple-400'));
                                }
                                break;
                            case 'practices':
                                if (Array.isArray(content)) {
                                    contentSections.push(`
                                        <div class="mb-8">
                                            <h3 class="text-xl font-semibold text-gray-800 mb-4">${mapping.title}</h3>
                                            <div class="space-y-3">
                                                ${content.map(practice => `
                                                    <div class="flex items-start space-x-3 p-3 bg-green-50 rounded-lg">
                                                        <span class="material-icons text-green-600 text-sm mt-0.5">lightbulb</span>
                                                        <span class="text-gray-700">${practice}</span>
                                                    </div>
                                                `).join('')}
                                            </div>
                                        </div>
                                    `);
                                } else {
                                    // Fall back to cards rendering for non-arrays
                                    contentSections.push(renderContentCards(content, mapping.title, 'bg-green-50', 'border-green-400'));
                                }
                                break;
                            case 'special':
                                if (mapping.key === 'hrcm') {
                                    // Special rendering for HRCM with dynamic data fetching
                                    const placeholderId = 'hrcm-content-' + Math.random().toString(36).substr(2, 9);
                                    
                                    contentSections.push(`
                                        <div class="mb-8" id="${placeholderId}">
                                            <h3 class="text-xl font-semibold text-gray-800 mb-4">${mapping.title}</h3>
                                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
                                                                                                 <div class="flex items-center space-x-2">
                                                     <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"></div>
                                                     <p class="text-sm text-blue-700">Loading real-time MRCM data from refset 723561005...</p>
                                                 </div>
                                                 <p class="text-xs text-blue-600 mt-2">Server: ${SNOMED_CONFIG.baseUrl}/${SNOMED_CONFIG.branch}</p>
                                            </div>
                                        </div>
                                    `);
                                    
                                    // Fetch dynamic HRCM data asynchronously
                                    setTimeout(async () => {
                                        const placeholder = document.getElementById(placeholderId);
                                        if (!placeholder) return;
                                        
                                        try {
                                            const hrcmData = await mrcmService.getHRCMData('404684003', 'Clinical finding (finding)');
                                            
                                                                                         if (hrcmData && hrcmData.attributes) {
                                                 // Render with live data
                                                 placeholder.innerHTML = `
                                                     <h3 class="text-xl font-semibold text-gray-800 mb-4">${mapping.title}</h3>
                                                     <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-4">
                                                         <div class="flex items-center space-x-2 mb-2">
                                                             <span class="material-icons text-green-600 text-sm">check_circle</span>
                                                             <p class="text-sm text-green-800 font-medium">Live Data Retrieved</p>
                                                         </div>
                                                         <p class="text-sm text-green-700 mb-2"><strong>Version:</strong> ${hrcmData.version}</p>
                                                         <p class="text-sm text-green-700 mb-2">${hrcmData.description}</p>
                                                         <p class="text-sm text-green-700 mb-2"><strong>Domain Constraint:</strong> <code class="bg-green-100 px-1 rounded">${hrcmData.domainConstraint}</code></p>
                                                         <p class="text-sm text-green-700 mb-2"><strong>Server:</strong> <a href="${hrcmData.sourceUrl}" target="_blank" class="text-green-600 hover:text-green-800 underline">${hrcmData.serverInfo.baseUrl}</a></p>
                                                         <p class="text-xs text-green-600 mb-1"><strong>MRCM Refset:</strong> ${hrcmData.serverInfo.refsetId} (${hrcmData.serverInfo.attributeCount} attributes)</p>
                                                         <p class="text-xs text-green-600"><strong>Last Updated:</strong> ${new Date(hrcmData.serverInfo.lastFetched).toLocaleString()}</p>
                                                         <div class="mt-3 pt-3 border-t border-green-200">
                                                             <button onclick="window.refreshHRCM('${placeholderId}')" class="bg-green-600 hover:bg-green-700 text-white text-xs px-3 py-1 rounded mr-2">
                                                                 <span class="material-icons text-xs mr-1">refresh</span>Refresh Data
                                                             </button>
                                                             <button onclick="window.configureHRCM()" class="bg-green-600 hover:bg-green-700 text-white text-xs px-3 py-1 rounded">
                                                                 <span class="material-icons text-xs mr-1">settings</span>Configure Server
                                                             </button>
                                                         </div>
                                                     </div>
                                                    <div class="overflow-x-auto">
                                                        <table class="w-full border-collapse border border-gray-300 bg-white text-sm">
                                                            <thead>
                                                                <tr class="bg-gray-100">
                                                                    <th class="border border-gray-300 px-3 py-2 text-left font-semibold">Attribute</th>
                                                                    <th class="border border-gray-300 px-3 py-2 text-left font-semibold">ID</th>
                                                                    <th class="border border-gray-300 px-3 py-2 text-left font-semibold">Grouped</th>
                                                                    <th class="border border-gray-300 px-3 py-2 text-left font-semibold">Cardinality</th>
                                                                    <th class="border border-gray-300 px-3 py-2 text-left font-semibold">In Group</th>
                                                                    <th class="border border-gray-300 px-3 py-2 text-left font-semibold">Range Constraint</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                ${hrcmData.attributes.map(attr => `
                                                                    <tr class="hover:bg-gray-50">
                                                                        <td class="border border-gray-300 px-3 py-2 font-medium">${attr.name}</td>
                                                                        <td class="border border-gray-300 px-3 py-2 font-mono text-xs text-gray-600">${attr.id}</td>
                                                                        <td class="border border-gray-300 px-3 py-2 text-center">${attr.grouped}</td>
                                                                        <td class="border border-gray-300 px-3 py-2 text-center font-mono text-xs">${attr.cardinality}</td>
                                                                        <td class="border border-gray-300 px-3 py-2 text-center font-mono text-xs">${attr.inGroupCardinality}</td>
                                                                        <td class="border border-gray-300 px-3 py-2 text-xs">${attr.range}</td>
                                                                    </tr>
                                                                `).join('')}
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                `;
                                            } else {
                                                throw new Error('No MRCM data received');
                                            }
                                        } catch (error) {
                                            console.error('Failed to load live MRCM data, falling back to static data:', error);
                                            
                                            // Fallback to static data
                                            if (typeof content === 'object' && content.attributes) {
                                                placeholder.innerHTML = `
                                                    <h3 class="text-xl font-semibold text-gray-800 mb-4">${mapping.title}</h3>
                                                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4">
                                                        <div class="flex items-center space-x-2 mb-2">
                                                            <span class="material-icons text-yellow-600 text-sm">warning</span>
                                                            <p class="text-sm text-yellow-800 font-medium">Using Static Data (Server Unavailable)</p>
                                                        </div>
                                                        <p class="text-sm text-yellow-700 mb-2"><strong>Version:</strong> ${content.version}</p>
                                                        <p class="text-sm text-yellow-700 mb-2">${content.description}</p>
                                                        <p class="text-sm text-yellow-700 mb-2"><strong>Domain Constraint:</strong> <code class="bg-yellow-100 px-1 rounded">${content.domainConstraint}</code></p>
                                                        <p class="text-sm text-yellow-700"><strong>Source:</strong> <a href="${content.sourceUrl}" target="_blank" class="text-yellow-600 hover:text-yellow-800 underline">SNOMED International HRCM Documentation</a></p>
                                                        <p class="text-xs text-yellow-600 mt-2">Unable to connect to terminology server: ${SNOMED_CONFIG.baseUrl}</p>
                                                    </div>
                                                    <div class="overflow-x-auto">
                                                        <table class="w-full border-collapse border border-gray-300 bg-white text-sm">
                                                            <thead>
                                                                <tr class="bg-gray-100">
                                                                    <th class="border border-gray-300 px-3 py-2 text-left font-semibold">Attribute</th>
                                                                    <th class="border border-gray-300 px-3 py-2 text-left font-semibold">ID</th>
                                                                    <th class="border border-gray-300 px-3 py-2 text-left font-semibold">Grouped</th>
                                                                    <th class="border border-gray-300 px-3 py-2 text-left font-semibold">Cardinality</th>
                                                                    <th class="border border-gray-300 px-3 py-2 text-left font-semibold">In Group</th>
                                                                    <th class="border border-gray-300 px-3 py-2 text-left font-semibold">Range Constraint</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                ${content.attributes.map(attr => `
                                                                    <tr class="hover:bg-gray-50">
                                                                        <td class="border border-gray-300 px-3 py-2 font-medium">${attr.name}</td>
                                                                        <td class="border border-gray-300 px-3 py-2 font-mono text-xs text-gray-600">${attr.id}</td>
                                                                        <td class="border border-gray-300 px-3 py-2 text-center">${attr.grouped}</td>
                                                                        <td class="border border-gray-300 px-3 py-2 text-center font-mono text-xs">${attr.cardinality}</td>
                                                                        <td class="border border-gray-300 px-3 py-2 text-center font-mono text-xs">${attr.inGroupCardinality}</td>
                                                                        <td class="border border-gray-300 px-3 py-2 text-xs">${attr.range}</td>
                                                                    </tr>
                                                                `).join('')}
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                `;
                                            } else {
                                                placeholder.innerHTML = `
                                                    <h3 class="text-xl font-semibold text-gray-800 mb-4">${mapping.title}</h3>
                                                    <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                                                        <div class="flex items-center space-x-2 mb-2">
                                                            <span class="material-icons text-red-600 text-sm">error</span>
                                                            <p class="text-sm text-red-800 font-medium">Failed to Load HRCM Data</p>
                                                        </div>
                                                        <p class="text-sm text-red-700">Unable to connect to terminology server and no static fallback data available.</p>
                                                        <p class="text-xs text-red-600 mt-2">Server: ${SNOMED_CONFIG.baseUrl}</p>
                                                    </div>
                                                `;
                                            }
                                        }
                                    }, 100);
                                } else {
                                    // Default special rendering
                                    contentSections.push(`
                                        <div class="mb-8">
                                            <h3 class="text-xl font-semibold text-gray-800 mb-4">${mapping.title}</h3>
                                            <div class="p-4 bg-indigo-50 border border-indigo-200 rounded-lg">
                                                <p class="text-gray-700 font-mono text-sm">${content}</p>
                                            </div>
                                        </div>
                                    `);
                                }
                                break;
                        }
                    }
                });

                // Add HRCM section for concept hierarchies
                if (SNOMED_CONFIG.domainIds[section.id]) {
                    const placeholderId = 'hrcm-content-' + section.id + '-' + Math.random().toString(36).substr(2, 9);
                    
                    contentSections.push(`
                        <div class="mb-8" id="${placeholderId}">
                            <h3 class="text-xl font-semibold text-gray-800 mb-4">Human Readable Concept Model (HRCM)</h3>
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
                                <div class="flex items-center space-x-2">
                                    <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"></div>
                                    <p class="text-sm text-blue-700">Loading real-time MRCM data from refset 723561005...</p>
                                </div>
                                <p class="text-xs text-blue-600 mt-2">Server: ${SNOMED_CONFIG.baseUrl}/${SNOMED_CONFIG.branch}</p>
                            </div>
                        </div>
                    `);
                    
                    // Fetch dynamic HRCM data asynchronously
                    setTimeout(async () => {
                        const placeholder = document.getElementById(placeholderId);
                        if (!placeholder) return;
                        
                        const domainId = SNOMED_CONFIG.domainIds[section.id];
                        const domainName = section.title.replace(' Concepts', '');
                        
                        try {
                            const hrcmData = await mrcmService.getHRCMData(domainId, domainName);
                            
                            if (hrcmData && hrcmData.attributes) {
                                // Render with live data
                                placeholder.innerHTML = `
                                    <h3 class="text-xl font-semibold text-gray-800 mb-4">Human Readable Concept Model (HRCM)</h3>
                                    <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-4">
                                        <div class="flex items-center space-x-2 mb-2">
                                            <span class="material-icons text-green-600 text-sm">check_circle</span>
                                            <p class="text-sm text-green-800 font-medium">Live Data Retrieved</p>
                                        </div>
                                        <p class="text-sm text-green-700 mb-2"><strong>Version:</strong> ${hrcmData.version}</p>
                                        <p class="text-sm text-green-700 mb-2">${hrcmData.description}</p>
                                        <p class="text-sm text-green-700 mb-2"><strong>Domain Constraint:</strong> <code class="bg-green-100 px-1 rounded">${hrcmData.domainConstraint}</code></p>
                                        <p class="text-sm text-green-700 mb-2"><strong>Server:</strong> <a href="${hrcmData.sourceUrl}" target="_blank" class="text-green-600 hover:text-green-800 underline">${hrcmData.serverInfo.baseUrl}</a></p>
                                        <p class="text-xs text-green-600 mb-1"><strong>MRCM Refset:</strong> ${hrcmData.serverInfo.refsetId} (${hrcmData.serverInfo.attributeCount} attributes)</p>
                                        <p class="text-xs text-green-600"><strong>Last Updated:</strong> ${new Date(hrcmData.serverInfo.lastFetched).toLocaleString()}</p>
                                        <div class="mt-3 pt-3 border-t border-green-200">
                                            <button onclick="window.refreshHRCM('${placeholderId}', '${section.id}')" class="bg-green-600 hover:bg-green-700 text-white text-xs px-3 py-1 rounded mr-2">
                                                <span class="material-icons text-xs mr-1">refresh</span>Refresh Data
                                            </button>
                                            <button onclick="window.configureHRCM()" class="bg-green-600 hover:bg-green-700 text-white text-xs px-3 py-1 rounded">
                                                <span class="material-icons text-xs mr-1">settings</span>Configure Server
                                            </button>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <h4 class="text-lg font-medium text-gray-800 mb-2">${domainName} Domain Attributes</h4>
                                        <p class="text-sm text-gray-600">MRCM constraints for domain ${domainId} |${domainName}|</p>
                                    </div>
                                    <div class="overflow-x-auto">
                                        <table class="w-full border-collapse border border-gray-300 bg-white text-sm">
                                            <thead>
                                                <tr class="bg-gray-100">
                                                    <th class="border border-gray-300 px-3 py-2 text-left font-semibold">Attribute</th>
                                                    <th class="border border-gray-300 px-3 py-2 text-left font-semibold">SNOMED CT ID</th>
                                                    <th class="border border-gray-300 px-3 py-2 text-left font-semibold">Grouped</th>
                                                    <th class="border border-gray-300 px-3 py-2 text-left font-semibold">Cardinality</th>
                                                    <th class="border border-gray-300 px-3 py-2 text-left font-semibold">In Group</th>
                                                    <th class="border border-gray-300 px-3 py-2 text-left font-semibold">Range Constraint</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                ${hrcmData.attributes.map(attr => `
                                                    <tr class="hover:bg-gray-50">
                                                        <td class="border border-gray-300 px-3 py-2 font-medium">${attr.name}</td>
                                                        <td class="border border-gray-300 px-3 py-2 font-mono text-xs text-gray-600">${attr.id}</td>
                                                        <td class="border border-gray-300 px-3 py-2 text-center">${attr.grouped}</td>
                                                        <td class="border border-gray-300 px-3 py-2 text-center font-mono text-xs">${attr.cardinality}</td>
                                                        <td class="border border-gray-300 px-3 py-2 text-center font-mono text-xs">${attr.inGroupCardinality}</td>
                                                        <td class="border border-gray-300 px-3 py-2 text-xs">${attr.range}</td>
                                                    </tr>
                                                `).join('')}
                                            </tbody>
                                        </table>
                                    </div>
                                `;
                            } else {
                                throw new Error('No MRCM data received');
                            }
                        } catch (error) {
                            console.error(`Failed to load live MRCM data for ${domainName}, falling back to error display:`, error);
                            
                            placeholder.innerHTML = `
                                <h3 class="text-xl font-semibold text-gray-800 mb-4">Human Readable Concept Model (HRCM)</h3>
                                <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                                    <div class="flex items-center space-x-2 mb-2">
                                        <span class="material-icons text-yellow-600 text-sm">warning</span>
                                        <p class="text-sm text-yellow-800 font-medium">Unable to Load MRCM Data</p>
                                    </div>
                                    <p class="text-sm text-yellow-700 mb-2">Could not fetch MRCM constraints for ${domainName} domain (${domainId})</p>
                                    <p class="text-xs text-yellow-600 mt-2">Server: ${SNOMED_CONFIG.baseUrl}</p>
                                    <div class="mt-3 pt-3 border-t border-yellow-200">
                                        <button onclick="window.refreshHRCM('${placeholderId}', '${section.id}')" class="bg-yellow-600 hover:bg-yellow-700 text-white text-xs px-3 py-1 rounded mr-2">
                                            <span class="material-icons text-xs mr-1">refresh</span>Try Again
                                        </button>
                                        <button onclick="window.configureHRCM()" class="bg-yellow-600 hover:bg-yellow-700 text-white text-xs px-3 py-1 rounded">
                                            <span class="material-icons text-xs mr-1">settings</span>Configure Server
                                        </button>
                                    </div>
                                </div>
                            `;
                        }
                    }, 100);
                }

                const updatesHTML = section.content.updates ? `
                    <div class="mt-8 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                        <div class="flex items-start space-x-2">
                            <span class="material-icons text-yellow-600">info</span>
                            <p class="text-gray-700">${section.content.updates}</p>
                        </div>
                    </div>
                ` : '';

                // Enhanced examples with interactive features (skip for clinical finding as it has specialized rendering)
                const examplesHTML = section.content.examples && section.id !== 'clinical-finding' ? `
                    <div class="collapsible-section mb-8">
                        <div class="collapsible-header" onclick="app.toggleSection('examples-${section.id}')">
                            <h3 class="text-xl font-semibold text-gray-800">Examples</h3>
                            <span class="material-icons expand-icon" id="examples-${section.id}-icon">expand_more</span>
                        </div>
                        <div class="collapsible-content" id="examples-${section.id}-content">
                            <div class="grid gap-4">
                                ${Array.isArray(section.content.examples) ? section.content.examples.map((example, index) => {
                                    if (typeof example === 'object' && example.scenario) {
                                        // Handle clinical finding examples format
                                        return `
                                            <div class="example-card">
                                                <div class="example-tag">Example ${index + 1}</div>
                                                <h4 class="font-semibold text-gray-800 text-lg mb-2">${example.scenario}</h4>
                                                <p class="text-gray-700 mb-2">${example.description}</p>
                                                ${example.details ? `
                                                    <ul class="list-disc list-inside space-y-1 text-gray-700 ml-4">
                                                        ${example.details.map(detail => `<li>${detail}</li>`).join('')}
                                                    </ul>
                                                ` : ''}
                                            </div>
                                        `;
                                    } else if (typeof example === 'object' && example.concept) {
                                        // Handle standard examples format
                                        return `
                                            <div class="example-card">
                                                <div class="example-tag">Example ${index + 1}</div>
                                                <div class="flex justify-between items-start mb-3">
                                                    <h4 class="font-semibold text-gray-800 text-lg">${this.linkifyText(example.concept)}</h4>
                                                    ${example.id ? `<span class="concept-id" onclick="app.showConceptDetails('${example.id}')">${example.id}</span>` : ''}
                                                </div>
                                                ${example.hierarchy ? `
                                                    <div class="hierarchy-path">
                                                        ${this.createHierarchyLinks(example.hierarchy)}
                                                    </div>
                                                ` : ''}
                                                ${example.attributes ? `
                                                    <div class="mt-3 p-3 bg-blue-50 rounded-lg">
                                                        <h5 class="font-medium text-blue-800 mb-2">Attributes:</h5>
                                                        <p class="text-sm text-blue-700">${this.linkifyText(example.attributes)}</p>
                                                    </div>
                                                ` : ''}
                                                ${example.expression ? `
                                                    <div class="mt-3">
                                                        <h5 class="font-medium text-gray-800 mb-2">Expression:</h5>
                                                        <div class="p-3 bg-gray-50 rounded-lg text-sm font-mono text-gray-700">
                                                            ${this.linkifyExpression(example.expression)}
                                                        </div>
                                                        <p class="text-sm text-gray-600 mt-2">${example.description}</p>
                                                    </div>
                                                ` : ''}
                                            </div>
                                        `;
                                    } else {
                                        // Handle string examples
                                        return `
                                            <div class="example-card">
                                                <div class="example-tag">Example ${index + 1}</div>
                                                <p class="text-gray-700">${typeof example === 'string' ? this.linkifyText(example) : JSON.stringify(example)}</p>
                                            </div>
                                        `;
                                    }
                                }).join('') : '<div class="p-4 bg-gray-50 rounded-lg text-gray-600">Examples are available in a different format for this section.</div>'}
                            </div>
                        </div>
                    </div>
                ` : '';

                // Special handling for version history
                const versionHistoryHTML = section.content.versionHistory ? `
                    <div class="mb-8">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">Version History</h3>
                        <div class="space-y-4">
                            ${section.content.versionHistory.map(version => `
                                <div class="border-l-4 border-blue-400 pl-4 py-3 bg-blue-50 rounded-r-lg">
                                    <div class="font-semibold text-gray-800 mb-1">${version.version}</div>
                                    <div class="text-gray-600 mb-2">${version.changes}</div>
                                    ${version.significance ? `<div class="text-sm text-blue-600 font-medium">${version.significance}</div>` : ''}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                ` : '';

                content.innerHTML = `
                    <div class="space-y-8">
                        <!-- Breadcrumb Navigation -->
                        <div class="breadcrumb-nav">
                            <span class="breadcrumb-link" onclick="app.selectSection('introduction')">
                                <span class="material-icons text-sm mr-1">home</span>Guide Home
                            </span>
                            <span class="mx-2 text-gray-400">‚Ä∫</span>
                            <span class="text-gray-700 font-medium">${section.title}</span>
                        </div>

                        <!-- Section Header -->
                        <div class="bg-white rounded-lg shadow-md p-8">
                            <div class="flex items-start space-x-4">
                                <span class="material-icons text-4xl text-blue-600">${section.icon}</span>
                                <div class="flex-1">
                                    <h2 class="text-3xl font-bold text-gray-800 mb-2">${section.title}</h2>
                                    <p class="text-gray-600 text-lg mb-4">${section.description}</p>
                                    
                                    <!-- Navigation buttons -->
                                    <div class="flex gap-3">
                                        <button onclick="app.navigateToPrevious()" class="flex items-center px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm font-medium transition-colors">
                                            <span class="material-icons text-sm mr-1">arrow_back</span>Previous
                                        </button>
                                        <button onclick="app.navigateToNext()" class="flex items-center px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm font-medium transition-colors">
                                            Next<span class="material-icons text-sm ml-1">arrow_forward</span>
                                        </button>
                                        <button onclick="window.print()" class="flex items-center px-3 py-2 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded-lg text-sm font-medium transition-colors">
                                            <span class="material-icons text-sm mr-1">print</span>Print
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Cross References -->
                        ${this.addCrossReferences(section.id)}

                        <!-- Section Content -->
                        <div class="bg-white rounded-lg shadow-md p-8">
                            <!-- Overview -->
                            <div class="mb-8">
                                <h3 class="text-xl font-semibold text-gray-800 mb-4">Overview</h3>
                                <p class="text-gray-700 leading-relaxed">${this.linkifyText(section.content.overview)}</p>
                            </div>

                            <!-- Hierarchy Statistics (for specific sections) -->
                            ${this.renderHierarchyStats(section.id)}

                            <!-- Statistics Dashboard (for introduction section) -->
                            ${section.id === 'introduction' ? this.renderStatistics() : ''}

                            <!-- Enhanced Content Sections -->
                            ${this.renderEnhancedContent(section)}

                            ${section.content.semanticInteroperability ? `
                                <div class="mb-8">
                                    <h3 class="text-xl font-semibold text-gray-800 mb-4">Semantic Interoperability</h3>
                                    <div class="p-4 bg-green-50 border border-green-200 rounded-lg">
                                        <p class="text-gray-700">${this.linkifyText(section.content.semanticInteroperability)}</p>
                                    </div>
                                </div>
                            ` : ''}

                            ${contentSections.join('')}
                            ${examplesHTML}
                            ${versionHistoryHTML}
                            ${updatesHTML}
                            ${section.content.recentChanges ? `
                                <div class="mt-8 p-4 bg-indigo-50 border border-indigo-200 rounded-lg">
                                    <div class="flex items-start space-x-2">
                                        <span class="material-icons text-indigo-600">update</span>
                                        <div>
                                            <h4 class="font-semibold text-indigo-800 mb-1">Recent Changes</h4>
                                            <p class="text-gray-700">${this.linkifyText(section.content.recentChanges)}</p>
                                        </div>
                                    </div>
                                </div>
                            ` : ''}
                        </div>

                        <!-- Quick Actions -->
                        <div class="bg-gray-50 rounded-lg p-6">
                            <h4 class="font-semibold text-gray-800 mb-3">Quick Actions</h4>
                            <div class="flex flex-wrap gap-3">
                                <button onclick="document.getElementById('searchInput').focus()" class="px-4 py-2 bg-white border border-gray-300 rounded-lg text-sm hover:bg-gray-50 transition-colors">
                                    <span class="material-icons text-sm mr-1">search</span>Search Guide (Ctrl+K)
                                </button>
                                <button onclick="app.selectSection('introduction')" class="px-4 py-2 bg-white border border-gray-300 rounded-lg text-sm hover:bg-gray-50 transition-colors">
                                    <span class="material-icons text-sm mr-1">home</span>Back to Start
                                </button>
                                <button onclick="window.scrollTo({top: 0, behavior: 'smooth'})" class="px-4 py-2 bg-white border border-gray-300 rounded-lg text-sm hover:bg-gray-50 transition-colors">
                                    <span class="material-icons text-sm mr-1">keyboard_arrow_up</span>Back to Top
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            },

<<<<<<< Updated upstream
=======
            applyMarkdownStyling(html, section) {
                // Wrap in the same container structure as other sections
                const wrapper = document.createElement('div');
                wrapper.innerHTML = html;
                
                // Apply consistent heading styles
                const headings = wrapper.querySelectorAll('h1, h2, h3, h4, h5, h6');
                headings.forEach(heading => {
                    const level = parseInt(heading.tagName.charAt(1));
                    heading.className = level === 1 ? 
                        'text-3xl font-bold text-gray-900 mb-6' :
                        level === 2 ? 
                        'text-2xl font-semibold text-gray-800 mb-4 mt-8' :
                        level === 3 ?
                        'text-xl font-semibold text-gray-800 mb-4 mt-6' :
                        'text-lg font-medium text-gray-800 mb-3 mt-4';
                });
                
                // Style paragraphs
                const paragraphs = wrapper.querySelectorAll('p');
                paragraphs.forEach(p => {
                    p.className = 'text-gray-700 mb-4 leading-relaxed';
                });
                
                // Style lists
                const lists = wrapper.querySelectorAll('ul, ol');
                lists.forEach(list => {
                    if (list.tagName === 'UL') {
                        list.className = 'list-disc list-inside space-y-2 mb-4 text-gray-700 ml-4';
                    } else {
                        list.className = 'list-decimal list-inside space-y-2 mb-4 text-gray-700 ml-4';
                    }
                });
                
                // Style list items
                const listItems = wrapper.querySelectorAll('li');
                listItems.forEach(li => {
                    li.className = 'text-gray-700';
                });
                
                // Style code blocks and inline code
                const codeBlocks = wrapper.querySelectorAll('pre code');
                codeBlocks.forEach(code => {
                    code.parentElement.className = 'bg-gray-100 rounded-lg p-4 mb-4 overflow-x-auto';
                    code.className = 'text-sm font-mono text-gray-800';
                });
                
                const inlineCode = wrapper.querySelectorAll('code:not(pre code)');
                inlineCode.forEach(code => {
                    code.className = 'bg-blue-100 text-blue-800 px-2 py-1 rounded text-sm font-mono';
                });
                
                // Style blockquotes
                const blockquotes = wrapper.querySelectorAll('blockquote');
                blockquotes.forEach(quote => {
                    quote.className = 'border-l-4 border-blue-400 bg-blue-50 p-4 mb-4 italic text-gray-700';
                });
                
                // Style tables
                const tables = wrapper.querySelectorAll('table');
                tables.forEach(table => {
                    table.className = 'min-w-full divide-y divide-gray-200 mb-6';
                    
                    const thead = table.querySelector('thead');
                    if (thead) {
                        thead.className = 'bg-gray-50';
                        thead.querySelectorAll('th').forEach(th => {
                            th.className = 'px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider';
                        });
                    }
                    
                    const tbody = table.querySelector('tbody');
                    if (tbody) {
                        tbody.className = 'bg-white divide-y divide-gray-200';
                        tbody.querySelectorAll('td').forEach(td => {
                            td.className = 'px-6 py-4 whitespace-nowrap text-sm text-gray-900';
                        });
                    }
                });
                
                // Style images and figures with the concept-card treatment
                const figures = wrapper.querySelectorAll('figure');
                figures.forEach(figure => {
                    figure.className = 'concept-card bg-white p-6 rounded-lg shadow-md border mb-6';
                    
                    const img = figure.querySelector('img');
                    if (img) {
                        img.className = 'max-w-full h-auto rounded-lg mx-auto';
                    }
                    
                    const figcaption = figure.querySelector('figcaption');
                    if (figcaption) {
                        figcaption.className = 'text-sm text-gray-600 mt-3 text-center italic';
                    }
                });
                
                // Style standalone images
                const images = wrapper.querySelectorAll('img:not(figure img)');
                images.forEach(img => {
                    img.className = 'max-w-full h-auto rounded-lg shadow-md mb-4';
                    // Wrap standalone images in a figure-like container
                    const wrapper_div = document.createElement('div');
                    wrapper_div.className = 'concept-card bg-white p-6 rounded-lg shadow-md border mb-6 text-center';
                    img.parentNode.insertBefore(wrapper_div, img);
                    wrapper_div.appendChild(img);
                });
                
                // Style links
                const links = wrapper.querySelectorAll('a');
                links.forEach(link => {
                    link.className = 'concept-link text-blue-600 hover:text-blue-800 underline';
                });
                
                // Style strong/bold text
                const strongElements = wrapper.querySelectorAll('strong, b');
                strongElements.forEach(strong => {
                    strong.className = 'font-semibold text-gray-900';
                });
                
                // Style emphasis/italic text
                const emElements = wrapper.querySelectorAll('em, i');
                emElements.forEach(em => {
                    em.className = 'italic text-gray-700';
                });
                
                // Create the final styled content with section header
                return `
                    <div class="animate-slide-in">
                        <!-- Section Header -->
                        <div class="mb-8">
                            <div class="flex items-center space-x-3 mb-4">
                                <span class="material-icons text-blue-600 text-3xl">${section.icon}</span>
                                <h1 class="text-3xl font-bold text-gray-900">${section.title}</h1>
                            </div>
                            <div class="w-16 h-1 bg-gradient-to-r from-blue-600 to-blue-400 rounded"></div>
                        </div>
                        
                        <!-- Markdown Content -->
                        <div class="space-y-4">
                            ${wrapper.innerHTML}
                        </div>
                        
                        <!-- Cross References -->
                        ${this.renderCrossReferences(section.id)}
                    </div>
                `;
            },

            renderCrossReferences(sectionId) {
                const refs = crossReferences[sectionId];
                if (!refs || refs.length === 0) return '';
                
                const refCards = refs.map(refId => {
                    const refSection = guideData.sections.find(s => s.id === refId);
                    if (!refSection) return '';
                    
                    return `
                        <div class="cross-ref-link cursor-pointer p-3 bg-blue-50 rounded-lg border border-blue-200 hover:bg-blue-100 transition-colors"
                             onclick="app.navigateToSection('${refId}')">
                            <div class="flex items-center space-x-2">
                                <span class="material-icons text-blue-600 text-sm">${refSection.icon}</span>
                                <span class="text-blue-800 font-medium">${refSection.title}</span>
                            </div>
                        </div>
                    `;
                }).join('');
                
                return `
                    <div class="mt-12 pt-8 border-t border-gray-200">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                            <span class="material-icons text-blue-600 mr-2">link</span>
                            Related Sections
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                            ${refCards}
                        </div>
                    </div>
                `;
            },

>>>>>>> Stashed changes
            renderSearchResults() {
                const content = document.getElementById('content');
                const resultsHTML = guideData.searchResults.map(result => `
                    <div class="concept-card bg-white rounded-lg shadow-md p-6 cursor-pointer" 
                         onclick="app.selectSection('${result.id}')">
                        <div class="flex items-start space-x-4">
                            <span class="material-icons text-2xl text-blue-600">${result.icon}</span>
                            <div class="flex-1">
                                <h3 class="text-xl font-semibold text-gray-800 mb-2">${result.title}</h3>
                                <p class="text-gray-600 mb-3">${result.description}</p>
                                <div class="flex items-center text-sm text-blue-600">
                                    <span class="material-icons text-sm mr-1">arrow_forward</span>
                                    View Section
                                </div>
                            </div>
                        </div>
                    </div>
                `).join('');

                content.innerHTML = `
                    <div class="space-y-6">
                        <div class="bg-white rounded-lg shadow-md p-6">
                            <h2 class="text-2xl font-bold text-gray-800 mb-2">Search Results</h2>
                            <p class="text-gray-600">Found ${guideData.searchResults.length} matching sections</p>
                        </div>
                        ${resultsHTML}
                    </div>
                `;
            },

            selectSection(sectionId) {
                guideData.currentSection = sectionId;
                guideData.searchResults = [];
                document.getElementById('searchInput').value = '';
                this.renderSidebar();
                this.renderContent();
                this.updateActiveNavItem();
                
                // Smooth scroll to top with animation
                window.scrollTo({ top: 0, behavior: 'smooth' });
                
                // Add entrance animation
                setTimeout(() => {
                    const content = document.getElementById('content');
                    content.classList.add('animate-slide-in');
                    setTimeout(() => content.classList.remove('animate-slide-in'), 300);
                }, 100);
            },

            search(query) {
                if (!query.trim()) {
                    guideData.searchResults = [];
                    this.renderContent();
                    return;
                }

                const results = [];
                guideData.sections.forEach(section => {
                    const content = JSON.stringify(section.content).toLowerCase();
                    if (content.includes(query.toLowerCase()) || 
                        section.title.toLowerCase().includes(query.toLowerCase()) ||
                        section.description.toLowerCase().includes(query.toLowerCase())) {
                        results.push({
                            ...section,
                            relevance: this.calculateRelevance(section, query)
                        });
                    }
                });

                guideData.searchResults = results.sort((a, b) => b.relevance - a.relevance);
                this.renderContent();
            },

            calculateRelevance(section, query) {
                let score = 0;
                const queryLower = query.toLowerCase();
                
                if (section.title.toLowerCase().includes(queryLower)) score += 10;
                if (section.description.toLowerCase().includes(queryLower)) score += 5;
                
                const contentStr = JSON.stringify(section.content).toLowerCase();
                const matches = (contentStr.match(new RegExp(queryLower, 'g')) || []).length;
                score += matches;
                
                return score;
            },

            setupEventListeners() {
                // Search functionality
                document.getElementById('searchInput').addEventListener('input', (e) => {
                    this.search(e.target.value);
                });

                // Section selection
                document.addEventListener('click', (e) => {
                    if (e.target.closest('.section-item')) {
                        const sectionId = e.target.closest('.section-item').dataset.section;
                        this.selectSection(sectionId);
                    }
                });

                // Scroll progress tracking
                window.addEventListener('scroll', () => {
                    this.updateProgressBar();
                    this.updateScrollToTopButton();
                });

                // Concept link clicks
                document.addEventListener('click', (e) => {
                    if (e.target.classList.contains('concept-link')) {
                        const conceptId = e.target.dataset.conceptId;
                        if (conceptId && conceptMap[conceptId]) {
                            this.selectSection(conceptMap[conceptId]);
                        }
                    }
                });

                // Cross-reference clicks
                document.addEventListener('click', (e) => {
                    if (e.target.classList.contains('cross-ref-link')) {
                        const sectionId = e.target.dataset.section;
                        this.selectSection(sectionId);
                    }
                });
            },

            setupQuickNav() {
                const quickNav = document.getElementById('quickNav');
                const sections = guideData.sections;
                
                quickNav.innerHTML = `
                    <div class="px-4 py-2 bg-gray-50 border-b border-gray-200 text-xs font-semibold text-gray-600 uppercase tracking-wide">
                        Quick Navigation
                    </div>
                    ${sections.map(section => `
                        <a href="#" class="quick-nav-item" data-section="${section.id}" onclick="app.selectSection('${section.id}'); return false;">
                            ${section.title}
                        </a>
                    `).join('')}
                `;

                // Update active state
                this.updateActiveNavItem();
            },

            setupProgressBar() {
                this.updateProgressBar();
            },

            updateProgressBar() {
                const scrollTop = window.pageYOffset;
                const docHeight = document.documentElement.scrollHeight - window.innerHeight;
                const scrollPercent = (scrollTop / docHeight) * 100;
                document.getElementById('progressBar').style.width = `${Math.min(scrollPercent, 100)}%`;
            },

            updateScrollToTopButton() {
                const scrollToTopBtn = document.getElementById('scrollToTop');
                if (window.pageYOffset > 300) {
                    scrollToTopBtn.classList.remove('opacity-0', 'pointer-events-none');
                    scrollToTopBtn.classList.add('opacity-100');
                } else {
                    scrollToTopBtn.classList.add('opacity-0', 'pointer-events-none');
                    scrollToTopBtn.classList.remove('opacity-100');
                }
            },

            updateActiveNavItem() {
                const navItems = document.querySelectorAll('.quick-nav-item');
                navItems.forEach(item => {
                    if (item.dataset.section === guideData.currentSection) {
                        item.classList.add('active');
                    } else {
                        item.classList.remove('active');
                    }
                });
            },

            setupKeyboardShortcuts() {
                document.addEventListener('keydown', (e) => {
                    if (e.ctrlKey || e.metaKey) {
                        switch(e.key) {
                            case 'k':
                                e.preventDefault();
                                document.getElementById('searchInput').focus();
                                break;
                            case 'ArrowLeft':
                                e.preventDefault();
                                this.navigateToPrevious();
                                break;
                            case 'ArrowRight':
                                e.preventDefault();
                                this.navigateToNext();
                                break;
                        }
                    }
                });
            },

            navigateToPrevious() {
                const sections = guideData.sections;
                const currentIndex = sections.findIndex(s => s.id === guideData.currentSection);
                if (currentIndex > 0) {
                    this.selectSection(sections[currentIndex - 1].id);
                }
            },

            navigateToNext() {
                const sections = guideData.sections;
                const currentIndex = sections.findIndex(s => s.id === guideData.currentSection);
                if (currentIndex < sections.length - 1) {
                    this.selectSection(sections[currentIndex + 1].id);
                }
            },

            toggleSection(sectionId) {
                const content = document.getElementById(`${sectionId}-content`);
                const icon = document.getElementById(`${sectionId}-icon`);
                
                if (this.currentCollapsedSections.has(sectionId)) {
                    content.classList.remove('collapsed');
                    icon.classList.remove('rotated');
                    this.currentCollapsedSections.delete(sectionId);
                } else {
                    content.classList.add('collapsed');
                    icon.classList.add('rotated');
                    this.currentCollapsedSections.add(sectionId);
                }
            },

            linkifyText(text) {
                // Ensure text is a string
                if (typeof text !== 'string') {
                    return text || '';
                }
                
                // Convert concept references to clickable links
                return text.replace(/(\d{5,})/g, (match) => {
                    if (conceptMap[match]) {
                        return `<span class="concept-link" data-concept-id="${match}">${match}</span>`;
                    }
                    return match;
                }).replace(/(Body structure|Clinical finding|Procedure|Pharmaceutical|Observable entity|Organism|Substance|Specimen)/gi, (match) => {
                    const sectionMap = {
                        'Body structure': 'body-structure',
                        'Clinical finding': 'clinical-finding',
                        'Procedure': 'procedure',
                        'Pharmaceutical': 'pharmaceutical',
                        'Observable entity': 'observable-entity',
                        'Organism': 'organism',
                        'Substance': 'substance',
                        'Specimen': 'specimen'
                    };
                    const sectionId = sectionMap[match];
                    if (sectionId) {
                        return `<span class="cross-ref-link" data-section="${sectionId}">${match}</span>`;
                    }
                    return match;
                });
            },

            linkifyExpression(expression) {
                // Convert SNOMED CT expressions to clickable concept links
                return expression.replace(/(\d{5,})\|([^|]+)\|/g, (match, id, name) => {
                    if (conceptMap[id]) {
                        return `<span class="concept-link" data-concept-id="${id}">${id}|${name}|</span>`;
                    }
                    return match;
                });
            },

            createHierarchyLinks(hierarchy) {
                return hierarchy.split(' > ').map(part => {
                    const trimmed = part.trim();
                    const sectionMap = {
                        'Body structure': 'body-structure',
                        'Clinical finding': 'clinical-finding',
                        'Procedure': 'procedure',
                        'Disease': 'clinical-finding',
                        'Anatomical structure': 'body-structure'
                    };
                    const sectionId = sectionMap[trimmed];
                    if (sectionId) {
                        return `<span class="cross-ref-link" data-section="${sectionId}">${trimmed}</span>`;
                    }
                    return trimmed;
                }).join('<span class="hierarchy-arrow">‚ñ∂</span>');
            },

            showConceptDetails(conceptId) {
                // Show concept details in a modal or expand section
                const section = conceptMap[conceptId];
                if (section) {
                    this.selectSection(section);
                    // Scroll to highlight the concept
                    setTimeout(() => {
                        const elements = document.querySelectorAll(`[data-concept-id="${conceptId}"]`);
                        if (elements.length > 0) {
                            elements[0].scrollIntoView({ behavior: 'smooth', block: 'center' });
                            elements[0].style.background = '#fef3c7';
                            setTimeout(() => {
                                elements[0].style.background = '';
                            }, 2000);
                        }
                    }, 500);
                }
            },

            addCrossReferences(sectionId) {
                const refs = crossReferences[sectionId];
                if (!refs || refs.length === 0) return '';
                
                return `
                    <div class="cross-ref">
                        <h4 class="font-semibold text-blue-800 mb-2">
                            <span class="material-icons text-sm mr-1">link</span>
                            Related Sections:
                        </h4>
                        <div class="flex flex-wrap gap-2">
                            ${refs.map(refId => {
                                const refSection = guideData.sections.find(s => s.id === refId);
                                return refSection ? `
                                    <span class="cross-ref-link" data-section="${refId}">
                                        ${refSection.title}
                                    </span>
                                ` : '';
                            }).join('')}
                        </div>
                    </div>
                `;
            },

            renderStatistics() {
                return `
                    <div class="mb-8">
                        <h3 class="text-xl font-semibold text-gray-800 mb-6 flex items-center">
                            <span class="material-icons mr-2">analytics</span>
                            SNOMED CT Release Statistics (July 2025)
                        </h3>
                        
                        <!-- Summary Stats Cards -->
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                            <div class="stats-card">
                                <div class="stat-number">${snomedStats.totalActive.toLocaleString()}</div>
                                <div class="stat-label">Active Concepts</div>
                                <div class="stat-change positive mt-2">+${snomedStats.summary.totalNew}</div>
                            </div>
                            <div class="stats-card">
                                <div class="stat-number">${snomedStats.totalConcepts.toLocaleString()}</div>
                                <div class="stat-label">Total Concepts</div>
                                <div class="stat-change neutral mt-2">All Time</div>
                            </div>
                            <div class="stats-card">
                                <div class="stat-number">${snomedStats.summary.totalNew}</div>
                                <div class="stat-label">New This Release</div>
                                <div class="stat-change positive mt-2">+${snomedStats.summary.totalNew}</div>
                            </div>
                            <div class="stats-card">
                                <div class="stat-number">${snomedStats.summary.totalChanged}</div>
                                <div class="stat-label">Modified</div>
                                <div class="stat-change neutral mt-2">Updated</div>
                            </div>
                        </div>

                        <!-- Hierarchy Distribution Chart -->
                        <div class="chart-container">
                            <div class="chart-title">
                                <span class="material-icons">bar_chart</span>
                                Concept Distribution by Hierarchy
                            </div>
                            <div class="stats-filters">
                                <button class="filter-btn active" onclick="app.filterChart('active')">Active Concepts</button>
                                <button class="filter-btn" onclick="app.filterChart('total')">Total Concepts</button>
                                <button class="filter-btn" onclick="app.filterChart('new')">New Concepts</button>
                            </div>
                            <div class="bar-chart" id="hierarchyChart">
                                ${this.renderHierarchyChart('active')}
                            </div>
                        </div>

                        <!-- Top Hierarchies by Activity -->
                        <div class="chart-container">
                            <div class="chart-title">
                                <span class="material-icons">trending_up</span>
                                Most Active Hierarchies
                            </div>
                            <div class="progress-container">
                                ${this.renderTopHierarchies()}
                            </div>
                        </div>

                        <!-- Release Activity Summary -->
                        <div class="chart-container">
                            <div class="chart-title">
                                <span class="material-icons">pie_chart</span>
                                Release Activity Breakdown
                            </div>
                            <div class="grid md:grid-cols-2 gap-8">
                                <div>
                                    <div class="pie-chart" id="activityPieChart">
                                        ${this.renderActivityPieChart()}
                                    </div>
                                    <div class="pie-legend">
                                        <div class="legend-item">
                                            <div class="legend-color" style="background: #10b981;"></div>
                                            <span>New Concepts (${snomedStats.summary.totalNew})</span>
                                        </div>
                                        <div class="legend-item">
                                            <div class="legend-color" style="background: #3b82f6;"></div>
                                            <span>Modified (${snomedStats.summary.totalChanged})</span>
                                        </div>
                                        <div class="legend-item">
                                            <div class="legend-color" style="background: #ef4444;"></div>
                                            <span>Inactivated (${snomedStats.summary.totalInactivated})</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="space-y-4">
                                    <div class="p-4 bg-blue-50 rounded-lg">
                                        <h4 class="font-semibold text-blue-800 mb-2">Release Highlights</h4>
                                        <ul class="text-sm text-blue-700 space-y-1">
                                            <li>‚Ä¢ ${snomedStats.summary.totalNew} new concepts added</li>
                                            <li>‚Ä¢ ${snomedStats.summary.totalChanged} concepts modified</li>
                                            <li>‚Ä¢ ${snomedStats.summary.totalInactivated} concepts inactivated</li>
                                            <li>‚Ä¢ ${snomedStats.summary.totalReactivated} concepts reactivated</li>
                                        </ul>
                                    </div>
                                    <div class="p-4 bg-green-50 rounded-lg">
                                        <h4 class="font-semibold text-green-800 mb-2">Growth Metrics</h4>
                                        <ul class="text-sm text-green-700 space-y-1">
                                            <li>‚Ä¢ ${((snomedStats.summary.totalNew / snomedStats.totalActive) * 100).toFixed(2)}% growth rate</li>
                                            <li>‚Ä¢ ${snomedStats.summary.newSD} new fully defined concepts</li>
                                            <li>‚Ä¢ ${snomedStats.summary.newP} new primitive concepts</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            },

            renderHierarchyChart(filterType = 'active') {
                const sortedHierarchies = [...snomedStats.hierarchies].sort((a, b) => b[filterType] - a[filterType]);
                const maxValue = Math.max(...sortedHierarchies.map(h => h[filterType]));
                
                return sortedHierarchies.slice(0, 10).map(hierarchy => {
                    const percentage = (hierarchy[filterType] / maxValue) * 100;
                    const height = Math.max(percentage, 5); // Minimum 5% height for visibility
                    
                    return `
                        <div class="bar" style="height: ${height}%;" 
                             onclick="app.showHierarchyDetails('${hierarchy.id}')"
                             title="${hierarchy.name}: ${hierarchy[filterType].toLocaleString()}">
                            <div class="bar-value">${hierarchy[filterType].toLocaleString()}</div>
                            <div class="bar-label">${hierarchy.name.split(' ')[0]}</div>
                        </div>
                    `;
                }).join('');
            },

            renderTopHierarchies() {
                const sortedHierarchies = [...snomedStats.hierarchies]
                    .sort((a, b) => b.active - a.active)
                    .slice(0, 8);
                
                return sortedHierarchies.map(hierarchy => {
                    const percentage = (hierarchy.active / snomedStats.totalActive) * 100;
                    
                    return `
                        <div class="progress-item">
                            <div class="progress-label">${hierarchy.name}</div>
                            <div class="progress-bar-container">
                                <div class="progress-bar-fill" style="width: ${percentage}%"></div>
                            </div>
                            <div class="progress-value">${hierarchy.active.toLocaleString()}</div>
                        </div>
                    `;
                }).join('');
            },

            renderActivityPieChart() {
                const total = snomedStats.summary.totalNew + snomedStats.summary.totalChanged + snomedStats.summary.totalInactivated;
                const newAngle = (snomedStats.summary.totalNew / total) * 360;
                const changedAngle = (snomedStats.summary.totalChanged / total) * 360;
                
                return `
                    <div class="pie-segment" style="background: conic-gradient(#10b981 0deg ${newAngle}deg, #3b82f6 ${newAngle}deg ${newAngle + changedAngle}deg, #ef4444 ${newAngle + changedAngle}deg 360deg);"></div>
                `;
            },

            filterChart(filterType) {
                // Update filter buttons
                document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
                event.target.classList.add('active');
                
                // Update chart
                document.getElementById('hierarchyChart').innerHTML = this.renderHierarchyChart(filterType);
            },

            showHierarchyDetails(hierarchyId) {
                const hierarchy = snomedStats.hierarchies.find(h => h.id === hierarchyId);
                if (!hierarchy) return;
                
                // Find corresponding section
                const sectionMap = {
                    '123037004': 'body-structure',
                    '404684003': 'clinical-finding',
                    '71388002': 'procedure',
                    '373873005': 'pharmaceutical',
                    '410607006': 'organism',
                    '105590001': 'substance',
                    '363787002': 'observable-entity',
                    '123038009': 'specimen'
                };
                
                const sectionId = sectionMap[hierarchyId];
                if (sectionId) {
                    this.selectSection(sectionId);
                }
                
                // Show details in a tooltip or modal
                alert(`${hierarchy.name}\n\nActive: ${hierarchy.active.toLocaleString()}\nTotal: ${hierarchy.total.toLocaleString()}\nNew: ${hierarchy.new}\nChanged: ${hierarchy.changed}\nInactivated: ${hierarchy.inactivated}`);
            },

            renderEnhancedContent(section) {
                let enhancedContent = '';
                
                // Special rendering for Clinical Finding section
                if (section.id === 'clinical-finding') {
                    enhancedContent += this.renderClinicalFindingContent(section.content);
                } else {
                    // Render detailed subsections based on section type
                    if (section.content.whatIsSNOMEDCTDetails) {
                        enhancedContent += this.renderDetailedSubsection('What is SNOMED CT?', section.content.whatIsSNOMEDCTDetails);
                    }
                    
                    if (section.content.whyUseSNOMEDCTDetails) {
                        enhancedContent += this.renderDetailedSubsection('Why Use SNOMED CT?', section.content.whyUseSNOMEDCTDetails);
                    }
                    
                    if (section.content.intendedUseDetails) {
                        enhancedContent += this.renderDetailedSubsection('Intended Use Details', section.content.intendedUseDetails);
                    }
                    
                    if (section.content.semanticInteroperabilityDetails) {
                        enhancedContent += this.renderDetailedSubsection('Semantic Interoperability', section.content.semanticInteroperabilityDetails);
                    }
                    
                    if (section.content.overviewDetails) {
                        enhancedContent += this.renderDetailedSubsection('Concept Model Details', section.content.overviewDetails);
                    }
                    
                    if (section.content.topLevelConceptsDetails) {
                        enhancedContent += this.renderDetailedSubsection('Top-Level Concepts', section.content.topLevelConceptsDetails);
                    }
                }
                
                return enhancedContent;
            },

            renderDetailedSubsection(title, content) {
                return `
                    <div class="collapsible-section mb-6">
                        <div class="collapsible-header" onclick="app.toggleSection('${title.replace(/\s+/g, '-').toLowerCase()}')">
                            <h4 class="text-lg font-semibold text-gray-800">${title}</h4>
                            <span class="material-icons expand-icon" id="${title.replace(/\s+/g, '-').toLowerCase()}-icon">expand_more</span>
                        </div>
                        <div class="collapsible-content" id="${title.replace(/\s+/g, '-').toLowerCase()}-content">
                            ${this.renderContentByType(content)}
                        </div>
                    </div>
                `;
            },

            renderContentByType(content) {
                if (typeof content === 'string') {
                    return `<p class="text-gray-700">${this.linkifyText(content)}</p>`;
                }
                
                if (Array.isArray(content)) {
                    return `
                        <ul class="list-disc list-inside space-y-2 text-gray-700">
                            ${content.map(item => `<li>${typeof item === 'string' ? this.linkifyText(item) : JSON.stringify(item)}</li>`).join('')}
                        </ul>
                    `;
                }
                
                if (typeof content === 'object') {
                    let html = '';
                    
                    for (const [key, value] of Object.entries(content)) {
                        const formattedKey = key.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase());
                        
                        if (Array.isArray(value)) {
                            html += `
                                <div class="mb-4">
                                    <h5 class="font-medium text-gray-800 mb-2">${formattedKey}:</h5>
                                    <ul class="list-disc list-inside space-y-1 text-gray-700 ml-4">
                                        ${value.map(item => `<li>${typeof item === 'string' ? this.linkifyText(item) : JSON.stringify(item)}</li>`).join('')}
                                    </ul>
                                </div>
                            `;
                        } else if (typeof value === 'object') {
                            html += `
                                <div class="mb-4">
                                    <h5 class="font-medium text-gray-800 mb-2">${formattedKey}:</h5>
                                    <div class="ml-4">
                                        ${this.renderContentByType(value)}
                                    </div>
                                </div>
                            `;
                        } else {
                            html += `
                                <div class="mb-4">
                                    <h5 class="font-medium text-gray-800 mb-2">${formattedKey}:</h5>
                                    <p class="text-gray-700 ml-4">${typeof value === 'string' ? this.linkifyText(value) : value}</p>
                                </div>
                            `;
                        }
                    }
                    
                    return html;
                }
                
                return '';
            },

            renderClinicalFindingContent(content) {
                return `
                    <!-- Definition Table -->
                    <div class="mb-8">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">Definition</h3>
                        <div class="overflow-x-auto">
                            <table class="min-w-full border border-gray-300 bg-white">
                                <thead>
                                    <tr class="bg-gray-50">
                                        <th class="border border-gray-300 px-4 py-2 text-left font-semibold text-gray-800">Definition</th>
                                        <th class="border border-gray-300 px-4 py-2 text-left font-semibold text-gray-800">Examples</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="border border-gray-300 px-4 py-2 text-gray-700">
                                            <strong>Clinical finding:</strong> ${content.definition.clinicalFinding}
                                        </td>
                                        <td class="border border-gray-300 px-4 py-2 text-gray-700">
                                            <div class="mb-2">
                                                <strong>${content.definition.examples[0].type}:</strong><br>
                                                <span class="concept-id" onclick="app.showConceptDetails('${content.definition.examples[0].id}')">${content.definition.examples[0].id}</span> | ${content.definition.examples[0].concept} |
                                            </div>
                                            <div>
                                                <strong>${content.definition.examples[1].type}:</strong><br>
                                                <span class="concept-id" onclick="app.showConceptDetails('${content.definition.examples[1].id}')">${content.definition.examples[1].id}</span> | ${content.definition.examples[1].concept} |
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Observations -->
                    <div class="mb-8">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">Observations</h3>
                        <p class="text-gray-700 mb-4">${content.observations}</p>
                        <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-4">
                            <p class="text-gray-700"><strong>Note:</strong> ${content.observableEntityNote}</p>
                        </div>
                    </div>

                    <!-- Context -->
                    <div class="mb-8">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">Context</h3>
                        <p class="text-gray-700 mb-2">${content.context.default}</p>
                        <ul class="list-disc list-inside space-y-1 text-gray-700 ml-4">
                            ${content.context.elements.map(element => `<li>${element}</li>`).join('')}
                        </ul>
                    </div>

                    <!-- Hierarchy Structure -->
                    <div class="mb-8">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">Hierarchy Structure</h3>
                        <p class="text-gray-700 mb-4">${content.hierarchyStructure.description}</p>
                        <p class="text-gray-700 mb-4"><strong>Rule:</strong> ${content.hierarchyStructure.rule}</p>
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                            <p class="text-gray-700"><strong>Example:</strong></p>
                            <p class="text-gray-700">
                                <span class="concept-id" onclick="app.showConceptDetails('${content.hierarchyStructure.example.id}')">${content.hierarchyStructure.example.id}</span> | ${content.hierarchyStructure.example.concept} | has the parent, ${content.hierarchyStructure.example.parent}; it is also a subtype of <span class="concept-id" onclick="app.showConceptDetails('${content.hierarchyStructure.example.id2}')">${content.hierarchyStructure.example.id2}</span> | ${content.hierarchyStructure.example.subtype} | .
                            </p>
                        </div>
                    </div>

                    <!-- Disorder vs Finding Table -->
                    <div class="mb-8">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">Disorder vs Finding</h3>
                        <div class="overflow-x-auto">
                            <table class="min-w-full border border-gray-300 bg-white">
                                <thead>
                                    <tr class="bg-gray-50">
                                        <th class="border border-gray-300 px-4 py-2 text-left font-semibold text-gray-800">Characteristics</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="border border-gray-300 px-4 py-2">
                                            <div class="mb-4">
                                                <h4 class="font-semibold text-gray-800 mb-2">Disorder</h4>
                                                <ul class="list-disc list-inside space-y-1 text-gray-700 ml-4">
                                                    ${content.disorderVsFinding.disorder.characteristics.map(char => `<li>${char}</li>`).join('')}
                                                </ul>
                                            </div>
                                            <div>
                                                <h4 class="font-semibold text-gray-800 mb-2">Finding</h4>
                                                <ul class="list-disc list-inside space-y-1 text-gray-700 ml-4">
                                                    ${content.disorderVsFinding.finding.characteristics.map(char => `<li>${char}</li>`).join('')}
                                                </ul>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Examples -->
                    <div class="mb-8">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">Examples</h3>
                        ${content.examples.map(example => `
                            <div class="mb-4">
                                <h4 class="font-semibold text-gray-800 mb-2">${example.scenario}</h4>
                                <p class="text-gray-700 mb-2">${example.description}</p>
                                ${example.details ? `
                                    <ul class="list-disc list-inside space-y-1 text-gray-700 ml-4">
                                        ${example.details.map(detail => `<li>${detail}</li>`).join('')}
                                    </ul>
                                ` : ''}
                            </div>
                        `).join('')}
                    </div>

                    <!-- Technical Guidelines -->
                    <div class="mb-8">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">Technical Guidelines</h3>
                        
                        <div class="grid md:grid-cols-2 gap-6">
                            <div>
                                <h4 class="font-semibold text-gray-800 mb-3">Attributes Summary</h4>
                                <ul class="list-disc list-inside space-y-1 text-gray-700">
                                    ${content.attributesSummary.map(attr => `<li>${attr}</li>`).join('')}
                                </ul>
                            </div>
                            
                            <div>
                                <h4 class="font-semibold text-gray-800 mb-3">Defining Attributes</h4>
                                <ul class="list-disc list-inside space-y-1 text-gray-700">
                                    ${content.definingAttributes.map(attr => `<li>${attr}</li>`).join('')}
                                </ul>
                            </div>
                        </div>
                        
                        <div class="mt-6">
                            <h4 class="font-semibold text-gray-800 mb-3">Naming Conventions</h4>
                            <ul class="list-disc list-inside space-y-1 text-gray-700">
                                ${content.namingConventions.map(conv => `<li>${conv}</li>`).join('')}
                            </ul>
                        </div>
                        
                        <div class="mt-6">
                            <h4 class="font-semibold text-gray-800 mb-3">Modeling Guidelines</h4>
                            <ul class="list-disc list-inside space-y-1 text-gray-700">
                                ${content.modeling.map(guideline => `<li>${guideline}</li>`).join('')}
                            </ul>
                        </div>
                        
                        <div class="mt-6">
                            <h4 class="font-semibold text-gray-800 mb-3">Specific Modeling</h4>
                            <ul class="list-disc list-inside space-y-1 text-gray-700">
                                ${content.specificModeling.map(specific => `<li>${specific}</li>`).join('')}
                            </ul>
                        </div>
                    </div>
                `;
            },

            renderHierarchyStats(sectionId) {
                const hierarchyMap = {
                    'body-structure': '123037004',
                    'clinical-finding': '404684003',
                    'procedure': '71388002',
                    'pharmaceutical': '373873005',
                    'organism': '410607006',
                    'substance': '105590001',
                    'observable-entity': '363787002',
                    'specimen': '123038009'
                };
                
                const hierarchyId = hierarchyMap[sectionId];
                if (!hierarchyId) return '';
                
                const hierarchy = snomedStats.hierarchies.find(h => h.id === hierarchyId);
                if (!hierarchy) return '';
                
                const percentageOfTotal = ((hierarchy.active / snomedStats.totalActive) * 100).toFixed(1);
                const growthRate = hierarchy.new > 0 ? `+${hierarchy.new}` : '0';
                
                return `
                    <div class="mb-8">
                        <div class="chart-container">
                            <div class="chart-title">
                                <span class="material-icons">insights</span>
                                ${hierarchy.name} Hierarchy Statistics
                            </div>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                                <div class="stats-card">
                                    <div class="stat-number">${hierarchy.active.toLocaleString()}</div>
                                    <div class="stat-label">Active Concepts</div>
                                    <div class="stat-change positive mt-2">${percentageOfTotal}% of total</div>
                                </div>
                                <div class="stats-card">
                                    <div class="stat-number">${hierarchy.total.toLocaleString()}</div>
                                    <div class="stat-label">Total Concepts</div>
                                    <div class="stat-change neutral mt-2">All time</div>
                                </div>
                                <div class="stats-card">
                                    <div class="stat-number">${hierarchy.new}</div>
                                    <div class="stat-label">New This Release</div>
                                    <div class="stat-change positive mt-2">${growthRate}</div>
                                </div>
                                <div class="stats-card">
                                    <div class="stat-number">${hierarchy.changed}</div>
                                    <div class="stat-label">Modified</div>
                                    <div class="stat-change neutral mt-2">Updated</div>
                                </div>
                            </div>
                            
                            <!-- Hierarchy Activity Timeline -->
                            <div class="mt-6 p-4 bg-gray-50 rounded-lg">
                                <h4 class="font-semibold text-gray-800 mb-3">Recent Activity</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between items-center">
                                        <span class="text-gray-600">New concepts added:</span>
                                        <span class="font-semibold text-green-600">${hierarchy.new}</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-gray-600">Concepts modified:</span>
                                        <span class="font-semibold text-blue-600">${hierarchy.changed}</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-gray-600">Concepts inactivated:</span>
                                        <span class="font-semibold text-red-600">${hierarchy.inactivated}</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-gray-600">Market share:</span>
                                        <span class="font-semibold text-gray-800">${percentageOfTotal}% of all active concepts</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            },
        };

        // SNOMED CT Terminology Server Configuration
        const SNOMED_CONFIG = {
            // Default to SNOMED Browser instance - users can change this
            baseUrl: 'https://browser.ihtsdotools.org/snowstorm/snomed-ct',
            branch: 'MAIN',
            // SNOMED CT Top-level hierarchy concept IDs
            domainIds: {
                'clinical-finding': '404684003',
                'body-structure': '442083009', 
                'procedure': '71388002',
                'pharmaceutical': '373873005',
                'observable-entity': '363787002',
                'organism': '410607006',
                'substance': '105590001',
                'situation-context': '243796009',
                'specimen': '123038009'
            }
        };

        // Note: This implementation uses the MRCM refset endpoint (723561005) to fetch
        // real-time MRCM constraints. The default server (browser.ihtsdotools.org) 
        // should work without CORS issues. If you encounter problems with other servers:
        // 1. Try the SNOMED Browser endpoint (option 1 in configuration)
        // 2. Use a local Snowstorm instance with CORS enabled
        // 3. Configure CORS headers on your terminology server
        // 4. Use a proxy server to handle CORS requests

        // MRCM API Functions
        class MRCMService {
            constructor(config) {
                this.config = config;
            }

            async fetchMRCMRefsetData() {
                try {
                    // Use the MRCM refset endpoint - 723561005 is the MRCM attribute domain international refset
                    const url = `${this.config.baseUrl}/${this.config.branch}/members?referenceSet=723561005&active=true&limit=1000`;
                    const response = await fetch(url, {
                        headers: {
                            'Accept': 'application/json'
                        }
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                    
                    return await response.json();
                } catch (error) {
                    console.warn('Failed to fetch MRCM refset data:', error);
                    return null;
                }
            }

            async fetchAttributeRanges() {
                try {
                    // Fetch the MRCM attribute range refset - 723562000 is the MRCM attribute range international refset
                    const url = `${this.config.baseUrl}/${this.config.branch}/members?referenceSet=723562000&active=true&limit=1000`;
                    const response = await fetch(url, {
                        headers: {
                            'Accept': 'application/json'
                        }
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                    
                    return await response.json();
                } catch (error) {
                    console.warn('Failed to fetch MRCM attribute range data:', error);
                    return null;
                }
            }

            async getHRCMData(domainId, domainName) {
                console.log(`Fetching HRCM data for ${domainName} domain from terminology server...`);
                
                try {
                    // Fetch MRCM refset data
                    const mrcmData = await this.fetchMRCMRefsetData();
                    
                    if (!mrcmData || !mrcmData.items) {
                        throw new Error('No MRCM refset data received');
                    }

                    // Filter by specified domain ID
                    const domainAttributes = mrcmData.items.filter(item => 
                        item.additionalFields && 
                        item.additionalFields.domainId === domainId
                    );

                    if (domainAttributes.length === 0) {
                        throw new Error(`No MRCM attributes found for ${domainName} domain`);
                    }

                    // Fetch attribute ranges for additional context
                    const rangeData = await this.fetchAttributeRanges();
                    const rangeMap = {};
                    if (rangeData && rangeData.items) {
                        rangeData.items.forEach(rangeItem => {
                            if (rangeItem.additionalFields && rangeItem.additionalFields.domainId === domainId) {
                                rangeMap[rangeItem.referencedComponentId] = rangeItem.additionalFields.rangeConstraint || 'Not specified';
                            }
                        });
                    }

                    // Process and format the attributes
                    const attributes = domainAttributes.map(item => {
                        const attributeId = item.referencedComponentId;
                        const additionalFields = item.additionalFields;
                        const referencedComponent = item.referencedComponent;
                        
                        // Get attribute name from referenced component
                        const attributeName = referencedComponent?.pt?.term || 
                                            referencedComponent?.fsn?.term || 
                                            `Attribute ${attributeId}`;

                        // Format cardinality values
                        const cardinality = additionalFields.attributeCardinality || 'Not specified';
                        const inGroupCardinality = additionalFields.attributeInGroupCardinality || 'Not specified';
                        
                        // Get range constraint
                        const range = rangeMap[attributeId] || 'Not specified';

                        return {
                            name: attributeName,
                            id: attributeId,
                            grouped: additionalFields.grouped || '0',
                            cardinality: cardinality,
                            inGroupCardinality: inGroupCardinality,
                            range: range,
                            effectiveTime: item.effectiveTime,
                            moduleId: item.moduleId
                        };
                    });

                    // Sort attributes by name for consistent display
                    attributes.sort((a, b) => a.name.localeCompare(b.name));

                    return {
                        title: 'Human Readable Concept Model (HRCM)',
                        version: 'Live from MRCM Refsets',
                        description: `Real-time MRCM data from SNOMED CT MRCM refsets (723561005). This represents the current authoritative constraints for the ${domainName} domain.`,
                        domainConstraint: `< ${domainId} |${domainName}|`,
                        sourceUrl: `${this.config.baseUrl}/${this.config.branch}/members?referenceSet=723561005&active=true&limit=1000`,
                        serverInfo: {
                            baseUrl: this.config.baseUrl,
                            branch: this.config.branch,
                            lastFetched: new Date().toISOString(),
                            refsetId: '723561005',
                            attributeCount: attributes.length,
                            domainId: domainId,
                            domainName: domainName
                        },
                        attributes: attributes
                    };
                    
                } catch (error) {
                    console.error(`Failed to fetch live MRCM data for ${domainName}:`, error);
                    return null;
                }
            }
        }

        // Initialize MRCM service
        const mrcmService = new MRCMService(SNOMED_CONFIG);

                // Global functions for HRCM management
        window.refreshHRCM = async function(placeholderId, sectionId) {
            const placeholder = document.getElementById(placeholderId);
            if (!placeholder) return;
            
            const domainId = SNOMED_CONFIG.domainIds[sectionId];
            const domainName = sectionId === 'clinical-finding' ? 'Clinical finding (finding)' : 
                              guideData.sections.find(s => s.id === sectionId)?.title.replace(' Concepts', '') || 'Unknown';
            
            placeholder.innerHTML = `
                <h3 class="text-xl font-semibold text-gray-800 mb-4">Human Readable Concept Model (HRCM)</h3>
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
                    <div class="flex items-center space-x-2">
                        <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"></div>
                        <p class="text-sm text-blue-700">Refreshing MRCM data from refset 723561005...</p>
                    </div>
                    <p class="text-xs text-blue-600 mt-2">Server: ${SNOMED_CONFIG.baseUrl}/${SNOMED_CONFIG.branch}</p>
                </div>
            `;
            
            try {
                const hrcmData = await mrcmService.getHRCMData(domainId, domainName);
                
                if (hrcmData && hrcmData.attributes) {
                    placeholder.innerHTML = `
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">Human Readable Concept Model (HRCM)</h3>
                        <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-4">
                            <div class="flex items-center space-x-2 mb-2">
                                <span class="material-icons text-green-600 text-sm">check_circle</span>
                                <p class="text-sm text-green-800 font-medium">Live Data Retrieved</p>
                            </div>
                            <p class="text-sm text-green-700 mb-2"><strong>Version:</strong> ${hrcmData.version}</p>
                            <p class="text-sm text-green-700 mb-2">${hrcmData.description}</p>
                            <p class="text-sm text-green-700 mb-2"><strong>Domain Constraint:</strong> <code class="bg-green-100 px-1 rounded">${hrcmData.domainConstraint}</code></p>
                            <p class="text-sm text-green-700 mb-2"><strong>Server:</strong> <a href="${hrcmData.sourceUrl}" target="_blank" class="text-green-600 hover:text-green-800 underline">${hrcmData.serverInfo.baseUrl}</a></p>
                            <p class="text-xs text-green-600 mb-1"><strong>MRCM Refset:</strong> ${hrcmData.serverInfo.refsetId} (${hrcmData.serverInfo.attributeCount} attributes)</p>
                            <p class="text-xs text-green-600"><strong>Last Updated:</strong> ${new Date(hrcmData.serverInfo.lastFetched).toLocaleString()}</p>
                            <div class="mt-3 pt-3 border-t border-green-200">
                                <button onclick="window.refreshHRCM('${placeholderId}', '${sectionId}')" class="bg-green-600 hover:bg-green-700 text-white text-xs px-3 py-1 rounded mr-2">
                                    <span class="material-icons text-xs mr-1">refresh</span>Refresh Data
                                </button>
                                <button onclick="window.configureHRCM()" class="bg-green-600 hover:bg-green-700 text-white text-xs px-3 py-1 rounded">
                                    <span class="material-icons text-xs mr-1">settings</span>Configure Server
                                </button>
                            </div>
                        </div>
                        <div class="mb-3">
                            <h4 class="text-lg font-medium text-gray-800 mb-2">${domainName} Domain Attributes</h4>
                            <p class="text-sm text-gray-600">MRCM constraints for domain ${domainId} |${domainName}|</p>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full border-collapse border border-gray-300 bg-white text-sm">
                                <thead>
                                    <tr class="bg-gray-100">
                                        <th class="border border-gray-300 px-3 py-2 text-left font-semibold">Attribute</th>
                                        <th class="border border-gray-300 px-3 py-2 text-left font-semibold">SNOMED CT ID</th>
                                        <th class="border border-gray-300 px-3 py-2 text-left font-semibold">Grouped</th>
                                        <th class="border border-gray-300 px-3 py-2 text-left font-semibold">Cardinality</th>
                                        <th class="border border-gray-300 px-3 py-2 text-left font-semibold">In Group</th>
                                        <th class="border border-gray-300 px-3 py-2 text-left font-semibold">Range Constraint</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${hrcmData.attributes.map(attr => `
                                        <tr class="hover:bg-gray-50">
                                            <td class="border border-gray-300 px-3 py-2 font-medium">${attr.name}</td>
                                            <td class="border border-gray-300 px-3 py-2 font-mono text-xs text-gray-600">${attr.id}</td>
                                            <td class="border border-gray-300 px-3 py-2 text-center">${attr.grouped}</td>
                                            <td class="border border-gray-300 px-3 py-2 text-center font-mono text-xs">${attr.cardinality}</td>
                                            <td class="border border-gray-300 px-3 py-2 text-center font-mono text-xs">${attr.inGroupCardinality}</td>
                                            <td class="border border-gray-300 px-3 py-2 text-xs">${attr.range}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    `;
                } else {
                    throw new Error('No MRCM data received');
                }
            } catch (error) {
                placeholder.innerHTML = `
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">Human Readable Concept Model (HRCM)</h3>
                    <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                        <div class="flex items-center space-x-2 mb-2">
                            <span class="material-icons text-red-600 text-sm">error</span>
                            <p class="text-sm text-red-800 font-medium">Failed to Refresh HRCM Data</p>
                        </div>
                        <p class="text-sm text-red-700 mb-2">Error: ${error.message}</p>
                        <p class="text-xs text-red-600">Server: ${SNOMED_CONFIG.baseUrl}</p>
                        <div class="mt-3 pt-3 border-t border-red-200">
                            <button onclick="window.refreshHRCM('${placeholderId}', '${sectionId}')" class="bg-red-600 hover:bg-red-700 text-white text-xs px-3 py-1 rounded mr-2">
                                <span class="material-icons text-xs mr-1">refresh</span>Try Again
                            </button>
                            <button onclick="window.configureHRCM()" class="bg-red-600 hover:bg-red-700 text-white text-xs px-3 py-1 rounded">
                                <span class="material-icons text-xs mr-1">settings</span>Configure Server
                            </button>
                        </div>
                    </div>
                `;
            }
        };

        window.configureHRCM = function() {
            const currentUrl = SNOMED_CONFIG.baseUrl;
            const currentBranch = SNOMED_CONFIG.branch;
            
            const serverOptions = `
Common SNOMED CT Terminology Servers:

1. SNOMED Browser (SNOMED International):
   https://browser.ihtsdotools.org/snowstorm/snomed-ct

2. International Snowstorm (SNOMED International):
   https://snowstorm.ihtsdotools.org

3. US Snowstorm (SNOMED US):
   https://tx.fhir.org/r4

4. Local Snowstorm:
   http://localhost:8080

5. Custom server...

Current: ${currentUrl}
`;
            
            const choice = prompt(
                `${serverOptions}\n\nEnter:\n- Number (1-5) for preset\n- Full URL for custom server\n- Or press Cancel to keep current:`,
                currentUrl
            );
            
            let newUrl = currentUrl;
            
            if (choice) {
                switch (choice.trim()) {
                    case '1':
                        newUrl = 'https://browser.ihtsdotools.org/snowstorm/snomed-ct';
                        break;
                    case '2':
                        newUrl = 'https://snowstorm.ihtsdotools.org';
                        break;
                    case '3':
                        newUrl = 'https://tx.fhir.org/r4';
                        break;
                    case '4':
                        newUrl = 'http://localhost:8080';
                        break;
                    case '5':
                        newUrl = prompt('Enter custom server URL:', currentUrl) || currentUrl;
                        break;
                    default:
                        if (choice.startsWith('http')) {
                            newUrl = choice;
                        }
                        break;
                }
                
                if (newUrl && newUrl !== currentUrl) {
                    SNOMED_CONFIG.baseUrl = newUrl.replace(/\/$/, ''); // Remove trailing slash
                    
                    const newBranch = prompt(
                        `Configure SNOMED CT Branch:\n\nCurrent: ${currentBranch}\n\nCommon branches:\n- MAIN (International)\n- MAIN/SNOMEDCT-US (US Edition)\n- MAIN/SNOMEDCT-UK (UK Edition)\n\nEnter branch name (or press Cancel to keep current):`,
                        currentBranch
                    );
                    
                    if (newBranch && newBranch !== currentBranch) {
                        SNOMED_CONFIG.branch = newBranch;
                    }
                    
                    // Update the MRCM service with new config
                    mrcmService.config = SNOMED_CONFIG;
                    
                    alert(`Configuration updated!\n\nServer: ${SNOMED_CONFIG.baseUrl}\nBranch: ${SNOMED_CONFIG.branch}\n\nThe HRCM data will be refreshed from the new server.`);
                    
                                    // Find and refresh any visible HRCM sections
                const hrcmElements = document.querySelectorAll('[id^="hrcm-content-"]');
                hrcmElements.forEach(element => {
                    // Extract section ID from element ID pattern "hrcm-content-{sectionId}-{random}"
                    const idParts = element.id.split('-');
                    if (idParts.length >= 3) {
                        const sectionId = idParts[2];
                        window.refreshHRCM(element.id, sectionId);
                    }
                });
                }
            }
        };

        // Initialize the application when the page loads
        document.addEventListener('DOMContentLoaded', () => {
<<<<<<< Updated upstream
            app.init();
        });
=======
            (async () => {
                await loadMarkdownSections();
                app.init();
                // Ensure sidebar reflects new sections
                app.renderSidebar();
            })();
        });

        /* --------------------------------------
           Dynamic Markdown Sections Loader
           --------------------------------------*/
        async function loadMarkdownSections() {
            try {
                const response = await fetch('output/file-list.json');
                if (!response.ok) {
                    console.warn('No additional markdown sections found');
                    return;
                }
                const mdList = await response.json();
                
                // Process each markdown file to add with better metadata
                for (const item of mdList) {
                    // Skip if section id already exists
                    if (guideData.sections.some(s => s.id === item.id)) continue;

                    // Determine appropriate icon based on content type
                    let icon = 'article';
                    const id = item.id.toLowerCase();
                    if (id.includes('procedure') || id.includes('surgical')) icon = 'medical_services';
                    else if (id.includes('clinical') || id.includes('finding') || id.includes('disorder')) icon = 'health_and_safety';
                    else if (id.includes('substance') || id.includes('pharmaceutical') || id.includes('medicinal')) icon = 'medication';
                    else if (id.includes('body') || id.includes('anatomical') || id.includes('structure')) icon = 'accessibility';
                    else if (id.includes('organism') || id.includes('bacterial') || id.includes('viral')) icon = 'biotech';
                    else if (id.includes('observable') || id.includes('measurement')) icon = 'analytics';
                    else if (id.includes('specimen') || id.includes('sample')) icon = 'science';
                    else if (id.includes('imaging') || id.includes('diagnostic')) icon = 'monitor_heart';
                    else if (id.includes('dose') || id.includes('form')) icon = 'pill';
                    else if (id.includes('concept') || id.includes('model') || id.includes('authoring')) icon = 'schema';
                    else if (id.includes('guideline') || id.includes('convention') || id.includes('naming')) icon = 'rule';
                    
                    // Try to fetch a brief description from the first paragraph
                    let description = '';
                    try {
                        const mdResponse = await fetch(`output/${item.id}.md`);
                        if (mdResponse.ok) {
                            const mdContent = await mdResponse.text();
                            // Extract first paragraph as description
                            const firstParagraph = mdContent.split('\n\n').find(line => 
                                line.trim() && !line.startsWith('#') && !line.startsWith('|') && 
                                line.length > 20 && line.length < 200
                            );
                            if (firstParagraph) {
                                description = firstParagraph.trim().replace(/\n/g, ' ').substring(0, 150) + 
                                            (firstParagraph.length > 150 ? '...' : '');
                            }
                        }
                    } catch (e) {
                        // Continue without description if fetch fails
                    }

                    guideData.sections.push({
                        id: item.id,
                        title: item.title,
                        icon: icon,
                        description: description || 'Editorial guidance and modeling conventions',
                        mdFile: `output/${item.id}.md`
                    });
                }
            } catch (e) {
                console.error('Error loading markdown sections', e);
            }
        }
>>>>>>> Stashed changes
    </script>
</body>
</html>
